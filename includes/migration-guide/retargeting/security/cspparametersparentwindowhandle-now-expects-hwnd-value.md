### <a name="cspparametersparentwindowhandle-now-expects-hwnd-value"></a><span data-ttu-id="a8068-101">CspParameters.ParentWindowHandle теперь ожидает значение HWND</span><span class="sxs-lookup"><span data-stu-id="a8068-101">CspParameters.ParentWindowHandle now expects HWND value</span></span>

|   |   |
|---|---|
|<span data-ttu-id="a8068-102">Подробные сведения</span><span class="sxs-lookup"><span data-stu-id="a8068-102">Details</span></span>|<span data-ttu-id="a8068-103"><xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> Значения, представленные в .NET Framework 2.0 позволяет приложению регистрировать значение дескриптор родительского окна, таким образом, что пользовательского интерфейса, необходимые для доступа к ключу (например ПИН-кода запроса или диалоговом окне согласия) открывается модальное дочерним для указанного окна. Начиная с приложений, предназначенных для .NET Framework 4.7, приложения Windows Forms можно задать <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> свойство с код, аналогичный следующему:</span><span class="sxs-lookup"><span data-stu-id="a8068-103">The <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> value, introduced in .NET Framework 2.0, allows an application to register a parent window handle value such that any UI required to access the key (such as a PIN prompt or consent dialog) opens as a modal child to the specified window.Starting with apps that target the .NET Framework 4.7, a Windows Forms application can set the <xref:System.Security.Cryptography.CspParameters.ParentWindowHandle> property with code like the following:</span></span><pre><code class="language-C#">cspParameters.ParentWindowHandle = form.Handle;&#13;&#10;</code></pre><span data-ttu-id="a8068-104">В предыдущих версиях платформы .NET Framework, должно быть значение <xref:System.IntPtr?displayProperty=name> представляющая расположение в памяти где [HWND](https://msdn.microsoft.com/library/windows/desktop/aa383751.aspx#HWND) находился значение.</span><span class="sxs-lookup"><span data-stu-id="a8068-104">In previous versions of the .NET Framework, the value was expected to be an <xref:System.IntPtr?displayProperty=name> representing a location in memory where the [HWND](https://msdn.microsoft.com/library/windows/desktop/aa383751.aspx#HWND) value resided.</span></span> <span data-ttu-id="a8068-105">Задание свойства форму. Дескриптор Windows 7 и более ранних версий не оказывает никакого влияния, но в Windows 8 и более поздних версиях, это приводит к &quot; <xref:System.Security.Cryptography.CryptographicException?displayProperty=name>: неправильный параметр.&quot;</span><span class="sxs-lookup"><span data-stu-id="a8068-105">Setting the property to form.Handle on Windows 7 and earlier versions had no effect, but on Windows 8 and later versions, it results in a &quot;<xref:System.Security.Cryptography.CryptographicException?displayProperty=name>: The parameter is incorrect.&quot;</span></span>|
|<span data-ttu-id="a8068-106">Предложение</span><span class="sxs-lookup"><span data-stu-id="a8068-106">Suggestion</span></span>|<span data-ttu-id="a8068-107">Рекомендуется использовать упрощенный вариант приложений, предназначенных для .NET 4.7 или более поздней версии, которым необходимо зарегистрировать связь родительского окна:</span><span class="sxs-lookup"><span data-stu-id="a8068-107">Applications targeting .NET 4.7 or higher wishing to register a parent window relationship are encouraged to use the simplified form:</span></span><pre><code class="language-C#">cspParameters.ParentWindowHandle = form.Handle;&#13;&#10;</code></pre><span data-ttu-id="a8068-108">Пользователей, которые определены, правильное значение для передачи не адрес ячейки памяти, в которой содержится значение <code>form.Handle</code> можно отключить изменение поведения, установка параметра параметров AppContext <code>Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle</code> для <code>true</code>.</span><span class="sxs-lookup"><span data-stu-id="a8068-108">Users who had identified that the correct value to pass was the address of a memory location which held the value <code>form.Handle</code> can opt out of the behavior change by setting the AppContext switch <code>Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle</code> to <code>true</code>.</span></span><ol><li><span data-ttu-id="a8068-109">Программным путем совместимости переключается на параметров AppContext, как описано [здесь](http://blogs.msdn.com/b/dotnet/archive/2015/04/29/net-announcements-at-build-2015.aspx#dotnet46)</span><span class="sxs-lookup"><span data-stu-id="a8068-109">By programmatically setting compat switches on the AppContext, as explained [here](http://blogs.msdn.com/b/dotnet/archive/2015/04/29/net-announcements-at-build-2015.aspx#dotnet46)</span></span></li><li><span data-ttu-id="a8068-110">путем добавления следующей строки в раздел <code>&lt;runtime&gt;</code> файла app.config:</span><span class="sxs-lookup"><span data-stu-id="a8068-110">By adding the following line to the <code>&lt;runtime&gt;</code> section of the app.config file:</span></span></li></ol><pre><code class="language-xml">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.Security.Cryptography.DoNotAddrOfCspParentWindowHandle=true&quot;/&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre><span data-ttu-id="a8068-111">И наоборот, пользователи, желающие согласие на новое поведение на среду выполнения .NET Framework 4.7 при приложение загружается в более ранних версий .NET Framework можно задать параметров AppContext переключитесь в <code>false</code>.</span><span class="sxs-lookup"><span data-stu-id="a8068-111">Conversely, users who wish to opt in to the new behavior on the .NET Framework 4.7 runtime when the application loads under older .NET Framework versions can set the AppContext switch to <code>false</code>.</span></span>|
|<span data-ttu-id="a8068-112">Область</span><span class="sxs-lookup"><span data-stu-id="a8068-112">Scope</span></span>|<span data-ttu-id="a8068-113">Дополнительный номер</span><span class="sxs-lookup"><span data-stu-id="a8068-113">Minor</span></span>|
|<span data-ttu-id="a8068-114">Версия</span><span class="sxs-lookup"><span data-stu-id="a8068-114">Version</span></span>|<span data-ttu-id="a8068-115">4.7</span><span class="sxs-lookup"><span data-stu-id="a8068-115">4.7</span></span>|
|<span data-ttu-id="a8068-116">Тип</span><span class="sxs-lookup"><span data-stu-id="a8068-116">Type</span></span>|<span data-ttu-id="a8068-117">Изменение целевой платформы</span><span class="sxs-lookup"><span data-stu-id="a8068-117">Retargeting</span></span>|
|<span data-ttu-id="a8068-118">Затронутые API</span><span class="sxs-lookup"><span data-stu-id="a8068-118">Affected APIs</span></span>|<ul><li><xref:System.Security.Cryptography.CspParameters.ParentWindowHandle?displayProperty=nameWithType></li></ul>|

