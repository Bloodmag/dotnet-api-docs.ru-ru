### <a name="accessibility-improvements-in-windows-forms-controls"></a>Более удобным в элементах управления Windows Forms

|   |   |
|---|---|
|Подробные сведения|Windows Forms улучшается, как она работает с технологиями специальных возможностей для улучшения поддержки клиентов Windows Forms. К ним относятся следующие изменения:<ul><li>Изменения для улучшения отображения в режиме высокой контрастности.</li><li>Изменения для улучшения работы браузера в свойство. Свойства браузера усовершенствования включают следующие:</li><li>Улучшенная навигация с помощью клавиатуры посредством различных окон выбора с раскрывающимися списками.</li><li>Сокращение ненужных позицию табуляции.</li><li>Улучшенные отчеты о типах элементов управления.</li><li>Улучшенная работа экранного диктора.</li><li>Изменения в реализации отсутствующие шаблоны специальных возможностей пользовательского интерфейса элементов управления.</li></ul>|
|Предложение|<strong>Как принять или отклонить изменения</strong>чтобы приложения для использования преимуществ эти изменения, оно должно выполняться на платформе .NET Framework 4.7.1 или более поздней версии. Приложения могут использовать преимущества этих изменений в одном из следующих способов:<ul><li>Повторная компиляция для использования в .NET Framework 4.7.1. Эти специальные возможности изменения включено по умолчанию в приложениях Windows Forms, предназначенных для .NET Framework 4.7.1 или более поздней версии.</li><li>Его отказ поведения предыдущих версий специальных возможностей, добавив следующий код [коммутатора параметров AppContext](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) для <code>&lt;runtime&gt;</code> раздел в файл app.config и установке флажка <code>false</code>, как показано в следующем примере.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Приложения, предназначенные для .NET Framework 4.7.1 или более поздней версии и хотите сохранить прежних поведение специальных возможностей можно выбрать с использованием предыдущих версий специальные возможности, явно установите значение этого параметра параметров AppContext <code>true</code>. Обзор модели автоматизации пользовательского интерфейса см. в разделе [Обзор модели автоматизации пользовательского интерфейса](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Добавлена поддержка модели автоматизации пользовательского интерфейса шаблоны и свойства</strong>клиентами специальных возможностей можно воспользоваться преимуществами новых функциональных возможностей WinForms специальных возможностей с помощью шаблонов общий, общедоступные вызова. Эти шаблоны не зависят от WinForms. Например клиентами специальных возможностей можно вызвать метод QueryInterface в интерфейсе IAccessible (MAAS), чтобы получить интерфейс IServiceProvider. Если этот интерфейс доступен, клиенты могут использовать его метод QueryService запросить интерфейс IAccessibleEx. Дополнительные сведения см. в разделе [IAccessibleEx использование из клиента](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). Начиная с .NET Framework 4.7.1 IServiceProvider и [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (где применимо), доступны для объектов WinForms специальных возможностей. .NET Framework 4.7.1 добавлена поддержка следующих шаблоны модели автоматизации пользовательского интерфейса и свойства.<ul><li><code>T:System.Windows.Forms.ToolStripSplitButton</code> И <code>T:System.Windows.Forms.ComboBox</code> элементы управления поддерживают [развернуть или свернуть шаблон](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> Управления имеет [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) значение свойства <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li><code>T:System.Windows.Forms.ToolStripItem</code> Управления поддерживает [имя](xref:System.Windows.Automation.AutomationElement.NameProperty) свойство и [развернуть или свернуть шаблон](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li><code>T:System.Windows.Forms.ToolStripDropDownItem</code> Управления поддерживает <xref:System.Windows.Forms.AccessibleEvents> , указывающее, StateChange и NameChange при развернут или свернут раскрывающегося списка.</li><li><code>T:System.Windows.Forms.ToolStripDropDownButton</code> Управления имеет [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) значение свойства <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> Управления поддерживает [шаблон Toggle](xref:System.Windows.Automation.TogglePattern).</li><li><code>T:System.Windows.Forms.NumericUpDown</code> И <code>T:System.Windows.Forms.DomainUpDown</code> элементы управления поддерживают [имя](xref:System.Windows.Automation.AutomationElement.NameProperty) и [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) из <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Усовершенствования для управления PropertyGrid</strong>PropertyBrowser управления .NET Framework 4.7.1 добавляется следующие усовершенствования:<ul><li><strong>Сведения</strong> кнопку в диалоговом окне ошибки, который отображается, когда пользователь вводит неверное значение в <code>T:System.Windows.Forms.PropertyGrid</code> управления поддерживает [развернуть или свернуть шаблон](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), состояние и изменение имени уведомления и [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) свойство со значением <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>Области сообщений отображается, когда <strong>сведения</strong> кнопки из диалогового окна об ошибке доступен теперь клавиатуры и позволяет Экранный диктор для сообщения о содержимом сообщения об ошибке.</li><li><xref:System.Windows.Forms.AccessibleRole> Строк в <code>T:System.Windows.Forms.PropertyGrid</code> управления изменились со &quot;строки&quot; для &quot;ячейки&quot;. Ячейки сопоставляется UIA ControlType &quot;DataItem&quot;, которая позволяет поддерживать соответствующие сочетания клавиш и объявления Экранный диктор.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> Управлять строками, заголовок, который представляют элементов при <code>T:System.Windows.Forms.PropertyGrid</code> управления имеет <code>P:System.Windows.Forms.PropertySort</code> свойство <code>F:System.Windows.Forms.PropertySory.Categorized</code> имеют [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) значение свойства <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li><code>T:System.Windows.Forms.PropertyGrid</code> Управлять строками, заголовок, который представляют элементов при <code>T:System.Windows.Forms.PropertyGrid</code> управления имеет <code>P:System.Windows.Forms.PropertySort</code> свойство <code>F:System.Windows.Forms.PropertySory.Categorized</code> поддерживает [развернуть или свернуть шаблон](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Улучшенная клавиатуры между сеткой и панели инструментов над ним. Нажав клавишу &quot;Shift Tab&quot; теперь выбирает первый кнопки панели инструментов, а не всей панели инструментов</li><li><code>T:System.Windows.Forms.PropertyGrid</code> элементы управления, отображаемые в режиме высокой контрастности теперь Прорисовывает прямоугольник фокуса вокруг кнопки панели инструментов, который соответствует текущему <code>P:System.Windows.Forms.PropertySort</code> значение свойства.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> элементы управления, отображаемые в режиме высокой контрастности и с <code>P:System.Windows.Forms.PropertySort</code> свойство <code>F:System.Windows.Forms.PropertySory.Categorized</code> будет отображаются заголовки категорий в высокой контрастный цвет фона.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> элементы управления лучше различает элементы панели инструментов с фокусом и элементы панели инструментов, которые указывают текущее значение <code>P:System.Windows.Forms.PropertySort</code> свойства. Это исправление состоит из изменение режима высокой контрастности и изменения для сценариев без высокой контрастности.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> элементы панели инструментов, которые указывают текущее значение элемента управления <code>P:System.Windows.Forms.PropertySort</code> поддержки свойств [шаблон Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Улучшенная поддержка Экранный диктор для различения выбранного выравнивания в палитре выравнивания.</li><li>Когда пустой <code>T:System.Windows.Forms.PropertyGrid</code> элемент управления отображается в форме, теперь он получит фокус, где ранее он не произойдет.</li></ul><strong>Использование определенных ОС цветов в темах, высокая контрастность</strong><ul><li><code>T:System.Windows.Forms.Button</code> и <code>T:System.Windows.Forms.CheckBox</code> управляет с <code>P:System.Windows.Forms.Control.FlatStyle</code> значение <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, которая стиль по умолчанию, теперь использовать цвета, определенные операционной системы в "высококонтрастной" теме при выборе. Ранее не были контрастное цветов текста и фона и было трудно читать.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> и <code>T:System.Windows.Forms.GroupBox</code> с<code>P:System.Windows.Forms.Control.Enabled</code> значение <em>false</em>, использовать затененные цвет для отображения текста в высокой контрастности тем, что приводит к низкой контрастности для фон. Теперь использовать эти элементы управления &quot;отключенного текста&quot; цветом, определенным Операционной системой. Это исправление применяется к элементам управления с <code>P:System.Windows.Forms.Control.FlatStyle</code> свойству присвоено значение, отличное от <code>F:System.Windows.Forms.FlatStyle.System</code>. Последние элементы управления отображаются Операционной системой.</li><li><code>T:System.Windows.Forms.DataGridView</code> Теперь отображает Видимый прямоугольник вокруг содержимого ячейки, которая находится в фокусе. Ранее это не отображалась в определенных Контрастная темы.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> элементы управления с <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> свойство <em>false</em> теперь использовать &quot;отключенного текста&quot; цветом, определенным Операционной системой.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> элементы управления с <code>P:System.Windows.Forms.ToolStripItem.Checked</code> свойство <em>true</em> теперь отображаются связанные флажок в контрастных системный цвет.  Ранее установленный флажок цвет был не контрастное недостаточно и не видны в темах высокой контрастности.</li></ul>Примечание: Windows 10 был изменен значения для некоторых системы вступили в силу. Windows Forms Framework основана на платформе Win32. Для получения наилучших результатов выполните самую последнюю версию Windows и согласие с последними изменениями ОС, добавив в файл app.manifest в тестовом приложении и раскомментировать следующий код:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Улучшенная с помощью клавиатуры</strong><ul><li>Когда <code>T:System.Windows.Forms.ComboBox</code> элемент управления имеет <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> значение <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> и является первый элемент управления на вкладке заказа в форме, выводит на экран прямоугольник фокуса при открытии родительской формы с помощью клавиатуры. До этого изменения был фокус на этот элемент управления, но не к просмотру индикатор фокус.</li></ul><strong>Улучшенная поддержка экранного диктора</strong><ul><li><code>T:System.Windows.Forms.MonthCalendar</code> Управления добавлена поддержка вспомогательные технологии для доступа к элементу управления, включая возможность Экранный диктор прочитать значение элемента управления, если ранее не удалось.</li><li><code>T:System.Windows.Forms.CheckedListBox</code> Управления теперь уведомляет Экранный диктор при <code>P:System.Windows.Forms.CheckState</code> изменении свойства. Ранее, Экранный диктор не получил уведомления и в результате пользователи будет в курсе, <code>P:System.Windows.Forms.CheckState</code> была обновлена.</li><li><code>T:System.Windows.Forms.LinkLabel</code> Элемент управления был изменен способом, оно уведомит Экранный диктор текста в элементе управления. Ранее, Экранный диктор дважды было объявлено этот текст и прочитать &quot; &amp; &quot; символы как текст, даже если они не являются видимыми для пользователя. Повторяющийся текст был удален из объявления Экранный диктор, а также ненужных &quot; &amp; &quot; символов.</li><li><code>T:System.Windows.Forms.DataGridViewCell</code> Типы элементов управления теперь правильно отчета только для чтения до состояния Экранный диктор и других специальных возможностей.</li><li>Экранный диктор теперь может считывать системное меню дочерние окна в [многодокументного интерфейса](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) приложений.</li><li>Экранный диктор теперь может считывать <code>T:System.Windows.Forms.ToolStripMenuItem</code> управляет с <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> свойство <em>false</em>. Ранее Экранный диктор смогла сосредоточиться на пункты меню отключено для считывания содержимого.</li></ul>|
|Область|Значительно|
|Версия|4.7.1|
|Тип|Изменение целевой платформы|
|Затронутые API|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

