### <a name="currentculture-is-not-preserved-across-wpf-dispatcher-operations"></a>CurrentCulture не сохранено в рамках операции диспетчера WPF

|   |   |
|---|---|
|Подробные сведения|Начиная с .NET Framework 4.6, примет <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> или <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> из <xref:System.Windows.Threading.Dispatcher?displayProperty=name> будут потеряны в конце операции dispatcher. Аналогичным образом, изменения <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> или <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> внесенные вне диспетчер операции могут не отражаться при том, что операция выполняется. Практически озвучивания, это означает, что <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> и <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> изменений не может быть расширен между обратными вызовами пользовательского интерфейса WPF и другого кода в приложении WPF. Это происходит из-за изменений в <xref:System.Threading.ExecutionContext?displayProperty=name> , вызывающий <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> и <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> должен храниться в контекст выполнения, начиная с приложений, предназначенных для .NET Framework 4.6. Операции диспетчеризации WPF сохраняют контекст выполнения, который используется для запуска операции и восстановления предыдущего контекста при завершении операции. Поскольку <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> и <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> теперь являются частью этого контекста, внесенные в рамках операции диспетчеризации изменения не сохраняются вне этой операции.|
|Предложение|Это изменение затрагивает приложения может обойти его путем сохранения нужного <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> или <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> в поле и возврат всех тел операции Dispatcher (включая обработчики обратного вызова события пользовательского интерфейса), соответствующих <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> и <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name> заданы. Кроме того поскольку ExecutionContext изменить базовый это WPF изменение затрагивает только приложения, предназначенные для .NET Framework 4.6 или более поздней версии, этот разрыв можно избежать, предназначенных для .NET Framework 4.5.2.Apps, который платформы .NET Framework 4.6 или более поздней версии можно также работать добиться, задав следующие совместимости коммутатора:<pre><code>AppContext.SetSwitch(&quot;Switch.System.Globalization.NoAsyncCurrentCulture&quot;, true);&#13;&#10;</code></pre>Эта проблема была устранена в WPF в .NET Framework 4.6.2. Она также была устранена в .NET Frameworks 4.6 4.6.1 через [3139549 КБ](https://support.microsoft.com/kb/3139549). Приложения, предназначенные для .NET 4.6 или более поздней версии автоматически получают правой поведение в приложениях WPF - <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=name> / <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=name>) будет сохранено в рамках операциях диспетчера.|
|Область|Дополнительный номер|
|Версия|4.6|
|Тип|Изменение целевой платформы|

