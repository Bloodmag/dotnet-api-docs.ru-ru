### <a name="horizontal-scrolling-and-virtualization"></a>Горизонтальная прокрутка и виртуализация

|   |   |
|---|---|
|Подробные сведения|Это изменение относится к элементу управления <xref:System.Windows.Controls.ItemsControl?displayProperty=name>, который выполняет собственную виртуализацию в направлении, перпендикулярном основному направлению прокрутки (главным примером является элемент <xref:System.Windows.Controls.DataGrid?displayProperty=name>, для которого EnableColumnVirtualization=&quot;True&quot;).  Некоторые операции горизонтальной прокрутки были изменены таким образом, чтобы возвращать более интуитивно понятные и эквивалентные результаты в сравнении с операциями вертикальной прокрутки. Такие операции включают &quot;прокрутку до этого места&quot; и &quot;к правому краю&quot;, чтобы использовать имена из меню, вызываемого при щелчке правой кнопкой мыши на горизонтальной полосе прокрутки.  В обоих случаях вычисляется возможное смещение и вызывается метод <xref:System.Windows.Controls.Primitives.IScrollInfo.SetHorizontalOffset(System.Double)>. После прокрутки с использованием нового смещения понятия &quot;этого места&quot; или &quot;правого края&quot; могут измениться, поскольку новое девиртуализированное содержимое изменило значение <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name>. В версиях .NET, предшествующих 4.6.2, операция прокрутки просто использовала вариант смещения, даже если оно больше не было привязано к &quot;этому месту&quot; или &quot;правому краю&quot;.  Его результаты проявляются в виде &quot;подпрыгивания&quot; бегунка прокрутки. Лучше всего это проиллюстрировать на примере. Допустим, для <xref:System.Windows.Controls.DataGrid?displayProperty=name> заданы значения ExtentWidth=1000 и Width=200.  При прокрутке &quot;к правому краю&quot; используется вариант смещения 1000 – 200 = 800.  В процессе прокрутки к этому смещению девиртуализируются новые столбцы. Предположим, что они очень широкие, и теперь свойство <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name> получает значение 2000.  Прокрутка заканчивается при значении HorizontalOffset=800, а бегунок &quot;подпрыгивает&quot; в район середины полосы прокрутки (если точнее, то в позицию 800/2000 = 40 %). В результате этого изменения в такой ситуации новый вариант смещения пересчитывается и предпринимается повторная попытка. (На данный момент таким образом работает вертикальная прокрутка.) Это поведение стало более прогнозируемым и интуитивно понятным для конечного пользователя, но изменение может повлиять на те приложения, которые ожидают конкретных значений свойства <xref:System.Windows.Controls.Primitives.IScrollInfo.HorizontalOffset?displayProperty=name> после горизонтальной прокрутки, вызванной действиями пользователя или прямым вызовом <xref:System.Windows.Controls.Primitives.IScrollInfo.SetHorizontalOffset(System.Double)>.|
|Предложение|Нужно изменить приложения, использующие прогнозируемое значение для <xref:System.Windows.Controls.Primitives.IScrollInfo.HorizontalOffset?displayProperty=name>, чтобы они извлекали фактическое значение (а также значение <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name>) после любой горизонтальной прокрутки, при которой <xref:System.Windows.Controls.Primitives.IScrollInfo.ExtentWidth?displayProperty=name> может измениться из-за девиртуализации.|
|Область|Дополнительный номер|
|Версия|4.6.2|
|Тип|Среда выполнения|
|Затронутые API|<ul><li><xref:System.Windows.Controls.Primitives.IScrollInfo?displayProperty=nameWithType></li></ul>|

