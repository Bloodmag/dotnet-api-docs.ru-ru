### <a name="wpf-treeviewitem-must-be-used-within-a-treeview"></a>WPF TreeViewItem должны использоваться внутри элемента управления TreeView

|   |   |
|---|---|
|Подробные сведения|Изменение появилась в версии 4.5, который ограничивает использование <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> элементы за пределами <xref:System.Windows.Controls.TreeView?displayProperty=name>. Это происходит в следующих случаях.<ul><li><xref:System.Windows.Controls.TreeViewItem?displayProperty=name>элемента визуального родительского объекта не является элементом panel. (A <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> для <xref:System.Windows.Controls.TreeView?displayProperty=name> будет иметь панель с родительским)</li><li><xref:System.Windows.Controls.TreeViewItem?displayProperty=name> Является потомком <xref:System.Windows.Controls.VirtualizingStackPanel?displayProperty=name> выступает в роли &quot;узла элементов&quot; для элемента управления "список" (ListBox, DataGrid, ListView, и т. д.). Виртуализацию включать необязательно.</li><li><xref:System.Windows.Controls.VirtualizingStackPanel?displayProperty=name> — Прокрутки элемента (<code>ScrollUnit=&quot;Item&quot;</code>).</li><li>Кто-то вызывает <code>VirtualizingStackPanel.MakeVisible(v)</code> для прокрутки элемента <code>v</code> в представлении. Это можно сделать явно или неявно несколькими способами. Возможно, самым распространенным способом является простой щелчок <code>v</code> для перевода в его фокуса.</li><li>Цепочка родительских visual от <code>v</code> для <xref:System.Windows.Controls.VirtualizingStackPanel?displayProperty=name> проходит через <xref:System.Windows.Controls.TreeViewItem?displayProperty=name>.</li></ul>Другими словами, это происходит при <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> используется за пределами <xref:System.Windows.Controls.TreeView?displayProperty=name>, и пользователь щелкает потомком <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> требуется сделать его видимым. Если <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> не имеет элементов потомков, никогда не вы увидите эту проблему. Является примером ситуации, когда будет достигнута, если <xref:System.Windows.Controls.TreeViewItem?displayProperty=name> является корнем DataTemplate. При возникновении этой проблемы создается исключение InvalidCastException в рамках платформы WPF.|
|Предложение|Будет создано исправление для этой ошибки.|
|Область|Дополнительный номер|
|Версия|4.5|
|Тип|Среда выполнения|

