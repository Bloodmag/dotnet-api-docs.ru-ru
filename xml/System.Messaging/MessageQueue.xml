<Type Name="MessageQueue" FullName="System.Messaging.MessageQueue">
  <TypeSignature Language="C#" Value="public class MessageQueue : System.ComponentModel.Component, System.Collections.IEnumerable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit MessageQueue extends System.ComponentModel.Component implements class System.Collections.IEnumerable" />
  <TypeSignature Language="DocId" Value="T:System.Messaging.MessageQueue" />
  <TypeSignature Language="VB.NET" Value="Public Class MessageQueue&#xA;Inherits Component&#xA;Implements IEnumerable" />
  <TypeSignature Language="C++ CLI" Value="public ref class MessageQueue : System::ComponentModel::Component, System::Collections::IEnumerable" />
  <AssemblyInfo>
    <AssemblyName>System.Messaging</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.Collections.IEnumerable</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("ReceiveCompleted")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Messaging.MessageQueueInstaller))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageQueueConverter))</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="51fc7-101">Предоставляет доступ к очереди на сервере MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-101">Provides access to a queue on a Message Queuing server.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-102">Технология очереди сообщений позволяет приложениям, запускаются в разное время, для обмена данными через разнородных сетей и систем, которые могут быть временно отключены.</span><span class="sxs-lookup"><span data-stu-id="51fc7-102">The Message Queuing technology allows applications running at different times to communicate across heterogeneous networks and systems that might be temporarily offline.</span></span> <span data-ttu-id="51fc7-103">Приложения отправки, получения или просматривать (считывать без удаления) сообщения из очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-103">Applications send, receive, or peek (read without removing) messages from queues.</span></span> <span data-ttu-id="51fc7-104">Служба Message Queuing является необязательным компонентом [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] и Windows NT и должно устанавливаться отдельно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-104">Message Queuing is an optional component of [!INCLUDE[Win2kFamily](~/includes/win2kfamily-md.md)] and Windows NT, and must be installed separately.</span></span>  
  
 <span data-ttu-id="51fc7-105"><xref:System.Messaging.MessageQueue> Класс является оболочкой вокруг очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-105">The <xref:System.Messaging.MessageQueue> class is a wrapper around Message Queuing.</span></span> <span data-ttu-id="51fc7-106">Существует несколько версий очереди сообщений и использования <xref:System.Messaging.MessageQueue> класса может привести к немного по-разному, в зависимости от операционной системы с помощью.</span><span class="sxs-lookup"><span data-stu-id="51fc7-106">There are multiple versions of Message Queuing, and using the <xref:System.Messaging.MessageQueue> class can result in slightly different behavior, depending on the operating system you are using.</span></span> <span data-ttu-id="51fc7-107">Дополнительные сведения о конкретных функциях каждой версии службы очереди сообщений см. в разделе, «Новые возможности в очередь сообщений» в Platform SDK в MSDN.</span><span class="sxs-lookup"><span data-stu-id="51fc7-107">For information about specific features of each version of Message Queuing, see the topic "What's New in Message Queuing" in the Platform SDK in MSDN.</span></span>  
  
 <span data-ttu-id="51fc7-108"><xref:System.Messaging.MessageQueue> Класс предоставляет ссылку на очередь MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-108">The <xref:System.Messaging.MessageQueue> class provides a reference to a Message Queuing queue.</span></span> <span data-ttu-id="51fc7-109">Можно указать путь в <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор для подключения существующий ресурс, или можно создать новую очередь на сервере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-109">You can specify a path in the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor to connect to an existing resource, or you can create a new queue on the server.</span></span> <span data-ttu-id="51fc7-110">Перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, или <xref:System.Messaging.MessageQueue.Receive%2A>, необходимо связать новый экземпляр <xref:System.Messaging.MessageQueue> класса существующую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-110">Before you can call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, you must associate the new instance of the <xref:System.Messaging.MessageQueue> class with an existing queue.</span></span> <span data-ttu-id="51fc7-111">На этом этапе можно изменить свойства очереди, такие как <xref:System.Messaging.MessageQueue.Category%2A> и <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-111">At that point, you can manipulate the queue properties such as <xref:System.Messaging.MessageQueue.Category%2A> and <xref:System.Messaging.MessageQueue.Label%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-112"><xref:System.Messaging.MessageQueue> поддерживает два типа методов извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="51fc7-112"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="51fc7-113">Синхронные методы <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, поток процесса указанный интервал времени для нового сообщения прибывают в очередь ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-113">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-114">Асинхронные методы, <xref:System.Messaging.MessageQueue.BeginPeek%2A> и <xref:System.Messaging.MessageQueue.BeginReceive%2A>, задачи основного приложения продолжают выполняться в отдельном потоке, до прибытия сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-114">The asynchronous methods, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A>, allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-115">Эти методы работают с помощью объекты обратного вызова и состояние объектов для передачи данных между потоками.</span><span class="sxs-lookup"><span data-stu-id="51fc7-115">These methods work by using callback objects and state objects to communicate information between threads.</span></span>  
  
 <span data-ttu-id="51fc7-116">При создании нового экземпляра <xref:System.Messaging.MessageQueue> класса, не создается новая очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-116">When you create a new instance of the <xref:System.Messaging.MessageQueue> class, you are not creating a new Message Queuing queue.</span></span> <span data-ttu-id="51fc7-117">Вместо этого можно использовать <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, и <xref:System.Messaging.MessageQueue.Purge%2A> методы управления очередей на сервере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-117">Instead, you can use the <xref:System.Messaging.MessageQueue.Create%28System.String%29>, <xref:System.Messaging.MessageQueue.Delete%28System.String%29>, and <xref:System.Messaging.MessageQueue.Purge%2A> methods to manage queues on the server.</span></span>  
  
 <span data-ttu-id="51fc7-118">В отличие от <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> и <xref:System.Messaging.MessageQueue.Delete%28System.String%29> , `static` членами, поэтому их можно вызывать без создания нового экземпляра <xref:System.Messaging.MessageQueue> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-118">Unlike <xref:System.Messaging.MessageQueue.Purge%2A>, <xref:System.Messaging.MessageQueue.Create%28System.String%29> and <xref:System.Messaging.MessageQueue.Delete%28System.String%29> are `static` members, so you can call them without creating a new instance of the <xref:System.Messaging.MessageQueue> class.</span></span>  
  
 <span data-ttu-id="51fc7-119">Можно задать <xref:System.Messaging.MessageQueue> объекта <xref:System.Messaging.MessageQueue.Path%2A> с одним из трех имен: понятное имя <xref:System.Messaging.MessageQueue.FormatName%2A>, или <xref:System.Messaging.MessageQueue.Label%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-119">You can set the <xref:System.Messaging.MessageQueue> object's <xref:System.Messaging.MessageQueue.Path%2A> property with one of three names: the friendly name, the <xref:System.Messaging.MessageQueue.FormatName%2A>, or the <xref:System.Messaging.MessageQueue.Label%2A>.</span></span> <span data-ttu-id="51fc7-120">Понятное имя, которое определено в очереди <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства, является <xref:System.Messaging.MessageQueue.MachineName%2A> \\ <xref:System.Messaging.MessageQueue.QueueName%2A> для общей очереди, и <xref:System.Messaging.MessageQueue.MachineName%2A> \\ `Private$` \\ <xref:System.Messaging.MessageQueue.QueueName%2A> для частной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-120">The friendly name, which is defined by the queue's <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties, is <xref:System.Messaging.MessageQueue.MachineName%2A>\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a public queue, and <xref:System.Messaging.MessageQueue.MachineName%2A>\\`Private$`\\<xref:System.Messaging.MessageQueue.QueueName%2A> for a private queue.</span></span> <span data-ttu-id="51fc7-121"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство предоставляет доступ к очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-121">The <xref:System.Messaging.MessageQueue.FormatName%2A> property allows offline access to message queues.</span></span> <span data-ttu-id="51fc7-122">Наконец, можно использовать очереди <xref:System.Messaging.MessageQueue.Label%2A> свойство для задания в очередь <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-122">Lastly, you can use the queue's <xref:System.Messaging.MessageQueue.Label%2A> property to set the queue's <xref:System.Messaging.MessageQueue.Path%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-123">Список начальных значений свойств для экземпляра <xref:System.Messaging.MessageQueue>, в разделе <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-123">For a list of initial property values for an instance of <xref:System.Messaging.MessageQueue>, see the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-124">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-124">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="51fc7-125">В каждом случае он отправляет сообщение в очередь, путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-125">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 <span data-ttu-id="51fc7-126">В следующем примере кода отправляет сообщение в очередь и получает сообщение из очереди, с помощью конкретного приложения класс с именем `Order`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-126">The following code example sends a message to a queue, and receives a message from a queue, using an application-specific class called `Order`.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
    </remarks>
    <threadsafe><span data-ttu-id="51fc7-127">Только <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> метод является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-127">Only the <see cref="M:System.Messaging.MessageQueue.GetAllMessages" /> method is thread safe.</span></span></threadsafe>
    <altmember cref="T:System.Messaging.Message" />
    <altmember cref="T:System.Messaging.DefaultPropertiesToSend" />
    <altmember cref="T:System.Messaging.MessageQueueException" />
    <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
    <altmember cref="M:System.Messaging.MessageQueue.Peek" />
    <altmember cref="M:System.Messaging.MessageQueue.Receive" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
    <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
    <altmember cref="P:System.Messaging.MessageQueue.Path" />
    <altmember cref="P:System.Messaging.MessageQueue.Label" />
    <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
    <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
    <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-128">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-128">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-129">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-129">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span> <span data-ttu-id="51fc7-130">После того как используемый по умолчанию конструктор инициализирует новый экземпляр, необходимо задать свойство <see cref="P:System.Messaging.MessageQueue.Path" /> экземпляра, прежде чем можно будет использовать этот экземпляр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-130">After the default constructor initializes the new instance, you must set the instance's <see cref="P:System.Messaging.MessageQueue.Path" /> property before you can use the instance.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-131">Используйте этот перегруженный метод для создания нового экземпляра <xref:System.Messaging.MessageQueue> класс, который не привязан непосредственно в очередь на сервер очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-131">Use this overload to create a new instance of the <xref:System.Messaging.MessageQueue> class that is not immediately tied to a queue on the Message Queuing server.</span></span> <span data-ttu-id="51fc7-132">Перед использованием этого экземпляра его необходимо подключить к существующей очереди Message Queuing, задав <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-132">Before using this instance, you must connect it to an existing Message Queuing queue by setting the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="51fc7-133">Кроме того, можно задать <xref:System.Messaging.MessageQueue> ссылка на <xref:System.Messaging.MessageQueue.Create%28System.String%29> возвращаемого значения метода, тем самым создавая новая очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-133">Alternatively, you can set the <xref:System.Messaging.MessageQueue> reference to the <xref:System.Messaging.MessageQueue.Create%28System.String%29> method's return value, thereby creating a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="51fc7-134"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр <xref:System.Messaging.MessageQueue> класса; не создается новая очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-134">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span>  
  
 <span data-ttu-id="51fc7-135">Следующей таблице представлены исходные значения свойств для экземпляра класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-135">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span>  
  
|<span data-ttu-id="51fc7-136">Свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-136">Property</span></span>|<span data-ttu-id="51fc7-137">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="51fc7-137">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="51fc7-138">Значения, заданные по умолчанию <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-138">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="51fc7-139">Значения, заданные по умолчанию <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-139">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span> <span data-ttu-id="51fc7-140">Все значения фильтра устанавливаются в значение `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-140">All the filter values are set to `true`.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-141">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-141">The following code example creates a new <xref:System.Messaging.MessageQueue>.</span></span>  
  
 [!code-csharp[MessageQueue#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-142">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-142">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></param>
        <summary><span data-ttu-id="51fc7-143">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-143">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-144">Используйте этот перегруженный метод, если требуется привязать новый <xref:System.Messaging.MessageQueue> экземпляр для определенной очереди Message Queuing, для которой известно, что путь, имя формата или метка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-144">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> instance to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="51fc7-145">Если вы хотите предоставить монопольный доступ первому приложению, которое ссылается на очередь, необходимо задать <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> свойства `true` или используйте конструктор, который передает параметр ограничения доступа для чтения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-145">If you want to grant exclusive access to the first application that references the queue, you must set the <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property to `true` or use the constructor that passes a read-access restriction parameter.</span></span>  
  
 <span data-ttu-id="51fc7-146"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр <xref:System.Messaging.MessageQueue> класса; не создается новая очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-146">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor instantiates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="51fc7-147">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-147">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="51fc7-148">Синтаксис `path` параметра зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-148">The syntax of the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-149">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-149">Queue type</span></span>|<span data-ttu-id="51fc7-150">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-150">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-151">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-151">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-152">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-152">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="51fc7-153">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-153">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="51fc7-154">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-154">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="51fc7-155">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-155">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="51fc7-156">Машины транзакционную очередь недоставленных сообщений</span><span class="sxs-lookup"><span data-stu-id="51fc7-156">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="51fc7-157">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-157">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-158">Ссылка</span><span class="sxs-lookup"><span data-stu-id="51fc7-158">Reference</span></span>|<span data-ttu-id="51fc7-159">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-159">Syntax</span></span>|<span data-ttu-id="51fc7-160">Пример</span><span class="sxs-lookup"><span data-stu-id="51fc7-160">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="51fc7-161">Название формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-161">Format name</span></span>|<span data-ttu-id="51fc7-162">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-162">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="51fc7-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="51fc7-163">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="51fc7-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-164">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="51fc7-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-165">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="51fc7-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-166">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="51fc7-167">Метка</span><span class="sxs-lookup"><span data-stu-id="51fc7-167">Label</span></span>|<span data-ttu-id="51fc7-168">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-168">`Label:` [ *label* ]</span></span>|<span data-ttu-id="51fc7-169">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="51fc7-169">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="51fc7-170">Для работы в автономном режиме необходимо использовать синтаксис имени формата не синтаксис имени пути для конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-170">To work offline, you must use the format name syntax, not the path name syntax for the constructor.</span></span> <span data-ttu-id="51fc7-171">В противном случае — исключение, так как основной контроллер домена недоступен для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-171">Otherwise, an exception is thrown because the primary domain controller is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="51fc7-172">Следующей таблице представлены исходные значения свойств для экземпляра класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-172">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-173">Эти значения определяются свойства очереди сообщений с путем, указанным в `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-173">These values are based on the properties of the Message Queuing queue with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="51fc7-174">Свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-174">Property</span></span>|<span data-ttu-id="51fc7-175">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="51fc7-175">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="51fc7-176">0</span><span class="sxs-lookup"><span data-stu-id="51fc7-176">0</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<xref:System.Guid.Empty>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="51fc7-177">Значения, заданные по умолчанию <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-177">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="51fc7-178">`true`, если уровень конфиденциальности очереди MSMQ «Текст»; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-178">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<xref:System.Messaging.XmlMessageFormatter>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<xref:System.String.Empty>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="51fc7-179">Значение свойства имени компьютера очереди MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-179">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<xref:System.Messaging.MessageQueue.InfiniteQueueSize>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="51fc7-180">Значения, заданные по умолчанию <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-180">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="51fc7-181"><xref:System.String.Empty>, если не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-181"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="51fc7-182"><xref:System.String.Empty>, если не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-182"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|`false`|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="51fc7-183">`true`, если включен параметр журнала объект очереди сообщений; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-183">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-184">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-184">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="51fc7-185">В каждом случае он отправляет сообщение в очередь, путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-185">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-186">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-186">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-187">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="51fc7-187">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="51fc7-188">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-188"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="51fc7-189">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />, который ссылается на очередь MSMQ по указанному пути и с указанным ограничением доступа на чтение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-189">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class that references the Message Queuing queue at the specified path and with the specified read-access restriction.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-190">Используйте этот перегруженный метод, если требуется привязать новый <xref:System.Messaging.MessageQueue> для определенной очереди Message Queuing, для которой известно, что путь, имя формата или метка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-190">Use this overload when you want to tie the new <xref:System.Messaging.MessageQueue> to a particular Message Queuing queue, for which you know the path, format name, or label.</span></span> <span data-ttu-id="51fc7-191">Если вы хотите предоставить монопольный доступ первому приложению, которое ссылается на очередь, установите `sharedModeDenyReceive` параметр `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-191">If you want to grant exclusive access to the first application that references the queue, set the `sharedModeDenyReceive` parameter to `true`.</span></span> <span data-ttu-id="51fc7-192">В противном случае `sharedModeDenyReceive` для `false` или используйте конструктор, который содержит только `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-192">Otherwise, set `sharedModeDenyReceive` to `false` or use the constructor that has only a `path` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-193">Установка `sharedModeDenyReceive` для `true` влияет на все объекты, которые обращаются к очереди сообщений, включая другие приложения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-193">Setting `sharedModeDenyReceive` to `true` affects all objects that access the Message Queuing queue, including other applications.</span></span> <span data-ttu-id="51fc7-194">Влияние параметра не только на это приложение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-194">The effects of the parameter are not restricted to this application.</span></span>  
  
 <span data-ttu-id="51fc7-195"><xref:System.Messaging.MessageQueue.%23ctor%2A> Конструктор создает новый экземпляр <xref:System.Messaging.MessageQueue> класса; не создается новая очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-195">The <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor creates a new instance of the <xref:System.Messaging.MessageQueue> class; it does not create a new Message Queuing queue.</span></span> <span data-ttu-id="51fc7-196">Чтобы создать новую очередь в очереди сообщений, используйте <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-196">To create a new queue in Message Queuing, use <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="51fc7-197">Синтаксис `path` параметр зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-197">The syntax of the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="51fc7-198">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-198">Queue type</span></span>|<span data-ttu-id="51fc7-199">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-199">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-200">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-200">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-201">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-201">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="51fc7-202">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-202">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="51fc7-203">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-203">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="51fc7-204">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-204">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="51fc7-205">Машины транзакционную очередь недоставленных сообщений</span><span class="sxs-lookup"><span data-stu-id="51fc7-205">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="51fc7-206">Кроме того можно использовать имя формата или метку очереди, очереди сообщений для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-206">Alternatively, you can use the format name or label of a Message Queuing queue to describe the queue path.</span></span>  
  
|<span data-ttu-id="51fc7-207">Ссылка</span><span class="sxs-lookup"><span data-stu-id="51fc7-207">Reference</span></span>|<span data-ttu-id="51fc7-208">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-208">Syntax</span></span>|<span data-ttu-id="51fc7-209">Пример</span><span class="sxs-lookup"><span data-stu-id="51fc7-209">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="51fc7-210">Название формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-210">Format name</span></span>|<span data-ttu-id="51fc7-211">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-211">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="51fc7-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="51fc7-212">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span><br /><br /> <span data-ttu-id="51fc7-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-213">`FormatName:DIRECT=SPX:` `NetworkNumber`; `HostNumber`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="51fc7-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-214">`FormatName:DIRECT=TCP:` `IPAddress`\\`QueueName`</span></span><br /><br /> <span data-ttu-id="51fc7-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span><span class="sxs-lookup"><span data-stu-id="51fc7-215">`FormatName:DIRECT=OS:` `MachineName`\\`QueueName`</span></span>|  
|<span data-ttu-id="51fc7-216">Метка</span><span class="sxs-lookup"><span data-stu-id="51fc7-216">Label</span></span>|<span data-ttu-id="51fc7-217">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-217">`Label:` [ *label* ]</span></span>|<span data-ttu-id="51fc7-218">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="51fc7-218">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="51fc7-219">Для работы в автономном режиме необходимо использовать синтаксис имени формата, а не синтаксис понятного имени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-219">To work offline, you must use the format name syntax, rather than the friendly name syntax.</span></span> <span data-ttu-id="51fc7-220">В противном случае исключение недоступности основного контроллера домена (на котором установлена Active Directory) для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-220">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="51fc7-221">Если <xref:System.Messaging.MessageQueue> открывает очередь `sharedModeDenyReceive` равным `true`, любые <xref:System.Messaging.MessageQueue> , в последующем попытается прочитать данные из очереди, создаст <xref:System.Messaging.MessageQueueException> из-за нарушения совместного доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-221">If a <xref:System.Messaging.MessageQueue> opens a queue with the `sharedModeDenyReceive` parameter set to `true`, any <xref:System.Messaging.MessageQueue> that subsequently tries to read from the queue generates a <xref:System.Messaging.MessageQueueException> because of a sharing violation.</span></span> <span data-ttu-id="51fc7-222">Объект <xref:System.Messaging.MessageQueueException> также вызывается, если <xref:System.Messaging.MessageQueue> пытается получить доступ к очереди в монопольном режиме, то время как другой <xref:System.Messaging.MessageQueue> уже имеет монопольного доступа к очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-222">A <xref:System.Messaging.MessageQueueException> is also thrown if a <xref:System.Messaging.MessageQueue> tries to access the queue in exclusive mode while another <xref:System.Messaging.MessageQueue> already has non-exclusive access to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-223">Следующей таблице представлены исходные значения свойств для экземпляра класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-223">The following table shows initial property values for an instance of <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-224">Эти значения определяются свойства очереди MSMQ с путем, указанным в `path` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-224">These values are based on the properties of the Message Queuing queue, with the path specified by the `path` parameter.</span></span>  
  
|<span data-ttu-id="51fc7-225">Свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-225">Property</span></span>|<span data-ttu-id="51fc7-226">Исходное значение</span><span class="sxs-lookup"><span data-stu-id="51fc7-226">Initial value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessageQueue.Authenticate%2A>|<span data-ttu-id="51fc7-227">`false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-227">`false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.BasePriority%2A>|<span data-ttu-id="51fc7-228">0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-228">0.</span></span>|  
|<xref:System.Messaging.MessageQueue.Category%2A>|<span data-ttu-id="51fc7-229"><xref:System.Guid.Empty>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-229"><xref:System.Guid.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>|<span data-ttu-id="51fc7-230">Значения, заданные по умолчанию <xref:System.Messaging.DefaultPropertiesToSend> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-230">The values set by the default constructor of the <xref:System.Messaging.DefaultPropertiesToSend> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.EncryptionRequired%2A>|<span data-ttu-id="51fc7-231">`true`, если уровень конфиденциальности очереди MSMQ «Текст»; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-231">`true`, if the Message Queuing queue's privacy level setting is "Body"; otherwise, `false`.</span></span>|  
|<xref:System.Messaging.MessageQueue.Formatter%2A>|<span data-ttu-id="51fc7-232"><xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-232"><xref:System.Messaging.XmlMessageFormatter>.</span></span>|  
|<xref:System.Messaging.MessageQueue.Label%2A>|<span data-ttu-id="51fc7-233"><xref:System.String.Empty>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-233"><xref:System.String.Empty>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MachineName%2A>|<span data-ttu-id="51fc7-234">Значение свойства имени компьютера очереди MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-234">The value of the Message Queuing queue's computer name property.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>|<span data-ttu-id="51fc7-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-235"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>|<span data-ttu-id="51fc7-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-236"><xref:System.Messaging.MessageQueue.InfiniteQueueSize>.</span></span>|  
|<xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A>|<span data-ttu-id="51fc7-237">Значения, заданные по умолчанию <xref:System.Messaging.MessagePropertyFilter> класса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-237">The values set by the default constructor of the <xref:System.Messaging.MessagePropertyFilter> class.</span></span>|  
|<xref:System.Messaging.MessageQueue.Path%2A>|<span data-ttu-id="51fc7-238"><xref:System.String.Empty>, если не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-238"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.QueueName%2A>|<span data-ttu-id="51fc7-239"><xref:System.String.Empty>, если не задано с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-239"><xref:System.String.Empty>, if not set by the constructor.</span></span>|  
|<xref:System.Messaging.MessageQueue.DenySharedReceive%2A>|<span data-ttu-id="51fc7-240">Значение параметра `sharedModeDenyReceive`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-240">The value of the `sharedModeDenyReceive` parameter.</span></span>|  
|<xref:System.Messaging.MessageQueue.UseJournalQueue%2A>|<span data-ttu-id="51fc7-241">`true`, если включен параметр журнала объект очереди сообщений; в противном случае `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-241">`true`, if the Message Queuing object's journal setting is enabled; otherwise, `false`.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-242">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом задает путь к нему и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-242">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive access, sets its path, and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CPP/mqctor_denysharedreceive.cpp#1)]
 [!code-csharp[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/CS/mqctor_denysharedreceive.cs#1)]
 [!code-vb[MessageQueue.ctor_PathSharedModeDenyReceive#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ctor_PathSharedModeDenyReceive/VB/mqctor_denysharedreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-243">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> имеет неверное значение. Возможно, оно просто не задано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-243">The <see cref="P:System.Messaging.MessageQueue.Path" /> property is not valid, possibly because it has not been set.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, System::Messaging::QueueAccessMode accessMode);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-244">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="51fc7-244">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="accessMode"><span data-ttu-id="51fc7-245">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-245">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="51fc7-246">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-246">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-247">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="51fc7-247">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="51fc7-248">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-248"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache">
          <span data-ttu-id="51fc7-249">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-249"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <summary><span data-ttu-id="51fc7-250">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-250">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="51fc7-251">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> с монопольным доступом для чтения и с включенным кэшированием подключений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-251">The following code example creates a new <xref:System.Messaging.MessageQueue> with exclusive read access and with connection caching enabled.</span></span>  
  
 [!code-cpp[MessageQueue4#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue4/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue4#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue4/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public MessageQueue (string path, bool sharedModeDenyReceive, bool enableCache, System.Messaging.QueueAccessMode accessMode);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string path, bool sharedModeDenyReceive, bool enableCache, valuetype System.Messaging.QueueAccessMode accessMode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.#ctor(System.String,System.Boolean,System.Boolean,System.Messaging.QueueAccessMode)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (path As String, sharedModeDenyReceive As Boolean, enableCache As Boolean, accessMode As QueueAccessMode)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; MessageQueue(System::String ^ path, bool sharedModeDenyReceive, bool enableCache, System::Messaging::QueueAccessMode accessMode);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="sharedModeDenyReceive" Type="System.Boolean" />
        <Parameter Name="enableCache" Type="System.Boolean" />
        <Parameter Name="accessMode" Type="System.Messaging.QueueAccessMode" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-252">Расположение очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, для локального компьютера может иметь значение ".".</span><span class="sxs-lookup"><span data-stu-id="51fc7-252">The location of the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />, which can be "." for the local computer.</span></span></param>
        <param name="sharedModeDenyReceive">
          <span data-ttu-id="51fc7-253">Значение <see langword="true" />, если необходимо предоставить монопольный доступ на чтение первому приложению, которое обратится к очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-253"><see langword="true" /> to grant exclusive read access to the first application that accesses the queue; otherwise, <see langword="false" />.</span></span></param>
        <param name="enableCache">
          <span data-ttu-id="51fc7-254">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-254"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></param>
        <param name="accessMode"><span data-ttu-id="51fc7-255">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-255">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></param>
        <summary><span data-ttu-id="51fc7-256">Инициализирует новый экземпляр класса <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-256">Initializes a new instance of the <see cref="T:System.Messaging.MessageQueue" /> class.</span></span></summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="AccessMode">
      <MemberSignature Language="C#" Value="public System.Messaging.QueueAccessMode AccessMode { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.QueueAccessMode AccessMode" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.AccessMode" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property AccessMode As QueueAccessMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::QueueAccessMode AccessMode { System::Messaging::QueueAccessMode get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.QueueAccessMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-257">Получает значение, указывающее режим доступа для очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-257">Gets a value that indicates the access mode for the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-258">Одно из значений перечисления <see cref="T:System.Messaging.QueueAccessMode" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-258">One of the <see cref="T:System.Messaging.QueueAccessMode" /> values.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-259">По умолчанию режим доступа для очереди не `QueueAccessMode.SendAndReceive`, если не указано иное при вызове конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-259">The default access mode for a queue is `QueueAccessMode.SendAndReceive`, unless you specify otherwise when calling the constructor.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Authenticate">
      <MemberSignature Language="C#" Value="public bool Authenticate { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Authenticate" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Authenticate" />
      <MemberSignature Language="VB.NET" Value="Public Property Authenticate As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Authenticate { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Authenticate")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-260">Получает или задает значение, показывающее, принимает ли очередь только сообщения, прошедшие проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="51fc7-260">Gets or sets a value that indicates whether the queue accepts only authenticated messages.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-261">Значение <see langword="true" />, если очередь принимает только сообщения, прошедшие проверку подлинности; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-261"><see langword="true" /> if the queue accepts only authenticated messages; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="51fc7-262">Значение по умолчанию: <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-262">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-263">Проверка подлинности сообщений предоставляет способ для проверки целостности сообщений и проверки отправителя сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-263">Message authentication provides a way to ensure message integrity and to verify who sent the message.</span></span> <span data-ttu-id="51fc7-264">Чтобы запросить проверку подлинности, передающее приложение задает уровень проверки подлинности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-264">To request authentication, the sending application sets the message's authentication level.</span></span>  
  
 <span data-ttu-id="51fc7-265">При задании <xref:System.Messaging.MessageQueue.Authenticate%2A> для `true`, ограничен доступ к очереди на сервере, а не только к этому <xref:System.Messaging.MessageQueue> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-265">When you set <xref:System.Messaging.MessageQueue.Authenticate%2A> to `true`, you are restricting access to the queue on the server, not only to this <xref:System.Messaging.MessageQueue> instance.</span></span> <span data-ttu-id="51fc7-266">Затрагивает все клиентам, работающим с той же очереди, очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-266">All clients working against the same Message Queuing queue will be affected.</span></span>  
  
 <span data-ttu-id="51fc7-267">В очередь, принимающую только сообщения, прошедшие проверку подлинности будут отклонять сообщения без проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="51fc7-267">A queue that accepts only authenticated messages will reject a non-authenticated message.</span></span> <span data-ttu-id="51fc7-268">Чтобы запросить уведомление об отклонении сообщения, приложение может задать <xref:System.Messaging.Message.AcknowledgeType%2A> свойства сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-268">To request notification of message rejection, a sending application can set the <xref:System.Messaging.Message.AcknowledgeType%2A> property of the message.</span></span> <span data-ttu-id="51fc7-269">Поскольку существует других признаков отклонения сообщения, передающее приложение может потерять сообщение, если запросить его отправки в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-269">Because no other indication of message rejection exists, the sending application can lose the message unless you request that it be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="51fc7-270">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-270">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-271">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-271">Workgroup mode</span></span>|<span data-ttu-id="51fc7-272">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-272">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-273">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-273">Local computer</span></span>|<span data-ttu-id="51fc7-274">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-274">Yes</span></span>|  
|<span data-ttu-id="51fc7-275">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-275">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-276">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-276">Yes</span></span>|  
|<span data-ttu-id="51fc7-277">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-277">Remote computer</span></span>|<span data-ttu-id="51fc7-278">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-278">No</span></span>|  
|<span data-ttu-id="51fc7-279">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-279">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-280">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-280">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-281">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.Authenticate%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-281">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Authenticate%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-282">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-282">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.UseDeadLetterQueue" />
        <altmember cref="P:System.Messaging.Message.AcknowledgeType" />
      </Docs>
    </Member>
    <Member MemberName="BasePriority">
      <MemberSignature Language="C#" Value="public short BasePriority { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int16 BasePriority" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.BasePriority" />
      <MemberSignature Language="VB.NET" Value="Public Property BasePriority As Short" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property short BasePriority { short get(); void set(short value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_BasePriority")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int16</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-283">Получает или задает базовый приоритет, используемый службой очереди сообщений для маршрутизации сообщений общей очереди по сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-283">Gets or sets the base priority Message Queuing uses to route a public queue's messages over the network.</span></span></summary>
        <value><span data-ttu-id="51fc7-284">Элементарный базовый приоритет для всех сообщений, переданных в общую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-284">The single base priority for all messages sent to the (public) queue.</span></span> <span data-ttu-id="51fc7-285">Значение по умолчанию равно нулю (0).</span><span class="sxs-lookup"><span data-stu-id="51fc7-285">The default is zero (0).</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-286">Базовый приоритет очереди сообщений указывает порядок обработки прохождения сообщения, обрабатывается очереди, передаваемого по сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-286">A message queue's base priority specifies how a message en route to that queue is treated as it travels through the network.</span></span> <span data-ttu-id="51fc7-287">Можно задать <xref:System.Messaging.MessageQueue.BasePriority%2A> свойства на основании приоритет выше или ниже на все сообщения, отправленные в указанную очередь, отправленными в другие очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-287">You can set the <xref:System.Messaging.MessageQueue.BasePriority%2A> property to confer a higher or lower priority to all messages sent to the specified queue than those sent to other queues.</span></span> <span data-ttu-id="51fc7-288">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-288">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-289">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляры являются повлияло изменение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-289">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="51fc7-290">Очередь сообщений <xref:System.Messaging.MessageQueue.BasePriority%2A> не относится к <xref:System.Messaging.Message.Priority%2A> свойства сообщения, которое указывает порядок, в котором входящее сообщение помещается в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-290">A message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> is not related to the <xref:System.Messaging.Message.Priority%2A> property of a message, which specifies the order in which an incoming message is placed in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> применяется только к общим очередям, пути которых задаются с помощью имени формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-291"><xref:System.Messaging.MessageQueue.BasePriority%2A> applies only to public queues whose paths are specified using the format name.</span></span> <span data-ttu-id="51fc7-292">Базовый приоритет частной очереди всегда равно нулю (0).</span><span class="sxs-lookup"><span data-stu-id="51fc7-292">The base priority of a private queue is always zero (0).</span></span>  
  
 <span data-ttu-id="51fc7-293">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-293">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-294">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-294">Workgroup mode</span></span>|<span data-ttu-id="51fc7-295">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-295">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-296">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-296">Local computer</span></span>|<span data-ttu-id="51fc7-297">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-297">Yes</span></span>|  
|<span data-ttu-id="51fc7-298">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-298">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-299">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-299">Yes</span></span>|  
|<span data-ttu-id="51fc7-300">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-300">Remote computer</span></span>|<span data-ttu-id="51fc7-301">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-301">No</span></span>|  
|<span data-ttu-id="51fc7-302">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-302">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-303">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-303">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-304">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.BasePriority%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-304">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.BasePriority%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-305">Для базового приоритета задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-305">The base priority was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-306">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-306">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginPeek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="51fc7-307">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-307">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="51fc7-308">Инициирует асинхронную операцию считывания, указывая службе MSMQ на необходимость запуска операции считывания сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-308">Initiates an asynchronous peek operation by telling Message Queuing to begin peeking a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-309">Инициирует асинхронную операцию считывания, не имеющую тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-309">Initiates an asynchronous peek operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-310">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-310">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-311">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, если сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-311">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-312"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-312"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-313">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-313">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию; <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.PeekCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-314"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-315"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-315">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-316"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-316">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-317">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-317">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-318">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-318">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-319">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-319">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-320"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-320">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-321">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-321">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-322">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-322">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-323">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-323">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-324">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-324">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-325">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-325">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-326">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-326">Workgroup mode</span></span>|<span data-ttu-id="51fc7-327">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-327">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-328">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-328">Local computer</span></span>|<span data-ttu-id="51fc7-329">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-329">Yes</span></span>|  
|<span data-ttu-id="51fc7-330">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-330">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-331">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-331">Yes</span></span>|  
|<span data-ttu-id="51fc7-332">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-332">Remote computer</span></span>|<span data-ttu-id="51fc7-333">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-333">No</span></span>|  
|<span data-ttu-id="51fc7-334">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-334">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-335">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-335">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-336">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> Чтобы инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-336">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="51fc7-337">При <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-337">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="51fc7-338">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-338">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-339">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-339">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-340">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-340">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-341">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-341">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="51fc7-342">Инициирует асинхронную операцию считывания с заданным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-342">Initiates an asynchronous peek operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-343">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-343">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-344">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, если сообщение не станет доступным в очереди, или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-344">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="51fc7-345"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-345"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-346">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-346">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию; <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.PeekCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-347"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-348"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-348">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-349"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-349">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-350">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-350">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-351">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-351">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-352">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-352">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-353"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-353">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginPeek%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-354">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-354">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-355">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-355">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-356">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-356">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-357">Эта перегрузка задает тайм-аут. Если время, заданное параметром `timeout` истекло, компонент инициирует <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-357">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="51fc7-358">Поскольку сообщения отсутствуют, следующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-358">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="51fc7-359">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-359">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-360">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-360">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-361">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-361">Workgroup mode</span></span>|<span data-ttu-id="51fc7-362">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-362">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-363">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-363">Local computer</span></span>|<span data-ttu-id="51fc7-364">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-364">Yes</span></span>|  
|<span data-ttu-id="51fc7-365">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-365">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-366">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-366">Yes</span></span>|  
|<span data-ttu-id="51fc7-367">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-367">Remote computer</span></span>|<span data-ttu-id="51fc7-368">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-368">No</span></span>|  
|<span data-ttu-id="51fc7-369">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-369">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-370">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-370">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-371">В следующем примере кода создается асинхронную операцию, используя путь к очереди «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-371">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="51fc7-372">Создает обработчик событий `MyPeekCompleted`и прикрепляет его к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-372">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="51fc7-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается с указанием времени ожидания до одной минуты для запуска асинхронной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-373"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called with a time-out of one minute, to initiate the asynchronous peek operation.</span></span> <span data-ttu-id="51fc7-374">При <xref:System.Messaging.MessageQueue.PeekCompleted> события или тайм-аут, сообщение возвращается в том случае, если он существует, а основной текст выводится на экран.</span><span class="sxs-lookup"><span data-stu-id="51fc7-374">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expires, the message is retrieved if one exists, and its body is written to the screen.</span></span> <span data-ttu-id="51fc7-375">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается повторно и инициировать асинхронную операцию просмотра с помощью того же тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-375">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CPP/mqbeginpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/CS/mqbeginpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_timeout/VB/mqbeginpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-376">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-376">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-377">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-377">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-378">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-378">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-379">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-379">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="51fc7-380">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-380">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="51fc7-381">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-381">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-382">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-382">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-383">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-383">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-384">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginPeek%2A> для вызова <xref:System.Messaging.MessageQueue.PeekCompleted> событие, если сообщение не станет доступным в очереди, или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-384">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginPeek%2A> to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="51fc7-385"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-385"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-386">Используйте эту перегрузку, чтобы связать сведения с операцией, которые будут сохраняться в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-386">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-387">Обработчик событий может доступа к этой информации, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> , связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-387">The event handler can access this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="51fc7-388">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginPeek%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-388">To use <xref:System.Messaging.MessageQueue.BeginPeek%2A>, create an event handler that processes the results of the asynchronous operation, and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Инициирует асинхронную операцию; <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.PeekCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-389"><xref:System.Messaging.MessageQueue.BeginPeek%2A> initiates an asynchronous peek operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.PeekCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-390"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> или путем извлечения результата с помощью <xref:System.Messaging.PeekCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-390">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> or by retrieving the result using the <xref:System.Messaging.PeekCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-391"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-391">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-392">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-392">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-393">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-393">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-394">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-394">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-395"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-396">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-396">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-397">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-397">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-398">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-398">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-399">Эта перегрузка задает время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="51fc7-399">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="51fc7-400">Если время, заданное параметром `timeout` истекло, компонент инициирует <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-400">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span> <span data-ttu-id="51fc7-401">Поскольку сообщения отсутствуют, следующий вызов <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-401">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="51fc7-402">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-402">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-403">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-403">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span> <span data-ttu-id="51fc7-404">Пример такого сценария см. в разделе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-404">For an illustration of this scenario, see the Example section.</span></span>  
  
 <span data-ttu-id="51fc7-405">Можно также использовать объект состояния для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-405">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="51fc7-406">При запуске этого потока, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалинг и передается обратно вместе со сведениями события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-406">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="51fc7-407">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-407">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-408">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-408">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-409">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-409">Workgroup mode</span></span>|<span data-ttu-id="51fc7-410">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-410">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-411">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-411">Local computer</span></span>|<span data-ttu-id="51fc7-412">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-412">Yes</span></span>|  
|<span data-ttu-id="51fc7-413">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-413">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-414">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-414">Yes</span></span>|  
|<span data-ttu-id="51fc7-415">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-415">Remote computer</span></span>|<span data-ttu-id="51fc7-416">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-416">No</span></span>|  
|<span data-ttu-id="51fc7-417">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-417">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-418">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-418">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-419">В следующем примере кода создается асинхронную операцию, используя путь к очереди «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-419">The following code example creates an asynchronous peek operation, using the queue path ".\myQueue".</span></span> <span data-ttu-id="51fc7-420">Создает обработчик событий `MyPeekCompleted`и прикрепляет его к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-420">It creates an event handler, `MyPeekCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate.</span></span> <span data-ttu-id="51fc7-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается, с указанием времени ожидания до одной минуты.</span><span class="sxs-lookup"><span data-stu-id="51fc7-421"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is called, with a time-out of one minute.</span></span> <span data-ttu-id="51fc7-422">Каждый вызов <xref:System.Messaging.MessageQueue.BeginPeek%2A> имеет уникальный целочисленный идентификатор, определяющий данную операцию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-422">Each call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> has a unique associated integer that identifies that particular operation.</span></span> <span data-ttu-id="51fc7-423">При <xref:System.Messaging.MessageQueue.PeekCompleted> события или истечения тайм-аута, сообщение, если оно существует, извлекается и тело и относящиеся к операции целочисленный идентификатор записываются на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-423">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised or the time-out expired, the message, if one exists, is retrieved and its body and the operation-specific integer identifier are written to the screen.</span></span> <span data-ttu-id="51fc7-424">Затем <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызывается повторно и инициировать асинхронную операцию просмотра с того же времени ожидания и с целочисленным идентификатором только что завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-424">Then <xref:System.Messaging.MessageQueue.BeginPeek%2A> is called again to initiate a new asynchronous peek operation with the same time-out and the associated integer of the just completed operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CPP/mqbeginpeek_timeoutstateobject.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/CS/mqbeginpeek_timeoutstateobject.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_TimeSpanStateObject#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_TimeSpanStateObject/VB/mqbeginpeek_timeoutstateobject.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-425">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-425">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-427">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-427">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginPeek (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-428">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-428">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="51fc7-429">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-429">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="51fc7-430">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-430">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="51fc7-431">Инициирует асинхронную операцию считывания с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-431">Initiates an asynchronous peek operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-432">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-432">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="51fc7-433">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-433">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-434">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-434">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-435">При использовании этой перегрузки обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди, или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.PeekCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="51fc7-435">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="51fc7-436">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для формирования <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-436">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="51fc7-437"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-437"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-438"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-438">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-439">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-439">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-440">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-440">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-441">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-441">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-442"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-443">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-443">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-444">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-444">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-445">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-445">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-446">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-446">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-447">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-447">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="51fc7-448">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-448">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-449">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-449">Workgroup mode</span></span>|<span data-ttu-id="51fc7-450">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-450">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-451">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-451">Local computer</span></span>|<span data-ttu-id="51fc7-452">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-452">Yes</span></span>|  
|<span data-ttu-id="51fc7-453">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-453">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-454">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-454">Yes</span></span>|  
|<span data-ttu-id="51fc7-455">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-455">Remote computer</span></span>|<span data-ttu-id="51fc7-456">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-456">No</span></span>|  
|<span data-ttu-id="51fc7-457">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-457">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-458">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-458">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-459">В следующем примере кода создается асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-459">The following code example creates an asynchronous peek operation.</span></span> <span data-ttu-id="51fc7-460">Пример кода отправке сообщения в очередь сообщений на локальном, а затем вызывает <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передавая: значение времени ожидания 10 секунд; уникальный целочисленный идентификатор конкретного сообщения; и новый экземпляр <xref:System.AsyncCallback> , определяющий обработчик событий `MyPeekCompleted`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-460">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginPeek%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyPeekCompleted`.</span></span> <span data-ttu-id="51fc7-461">Если <xref:System.Messaging.MessageQueue.PeekCompleted> событие, обработчик событий считывает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-461">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the event handler peeks at the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginPeek#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginPeek/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginPeek#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginPeek/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-462">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-462">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-463">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-463">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-464">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-464">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginPeek">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginPeek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginPeek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginPeek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginPeek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-465">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-465">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-466">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-466">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="51fc7-467">Одно из значений перечисления <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-467">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="51fc7-468">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-468">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <param name="state"><span data-ttu-id="51fc7-469">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-469">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="51fc7-470">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-470">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="51fc7-471">Инициирует асинхронную операцию считывания, которая имеет заданный тайм-аут и использует заданный курсор, заданную операцию считывания и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="51fc7-471">Initiates an asynchronous peek operation that has a specified time-out and that uses a specified cursor, a specified peek action, and a specified state object.</span></span> <span data-ttu-id="51fc7-472">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-472">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="51fc7-473">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-473">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="51fc7-474">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-474">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-475">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-475">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-476">При использовании этой перегрузки обратный вызов, указанный в параметре обратного вызова инициируется сообщение не станет доступным в очереди, или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-476">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired.</span></span> <span data-ttu-id="51fc7-477"><xref:System.Messaging.MessageQueue.PeekCompleted> Событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="51fc7-477">The <xref:System.Messaging.MessageQueue.PeekCompleted> event is not raised.</span></span> <span data-ttu-id="51fc7-478">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginPeek%2A> полагаются на этот компонент для формирования <xref:System.Messaging.MessageQueue.PeekCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-478">The other overloads of <xref:System.Messaging.MessageQueue.BeginPeek%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event.</span></span>  
  
 <span data-ttu-id="51fc7-479"><xref:System.Messaging.MessageQueue.PeekCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-479"><xref:System.Messaging.MessageQueue.PeekCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-480"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-480">The <xref:System.Messaging.MessageQueue.BeginPeek%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-481">Поскольку <xref:System.Messaging.MessageQueue.BeginPeek%2A> является асинхронным, можно вызвать для просмотра очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-481">Because <xref:System.Messaging.MessageQueue.BeginPeek%2A> is asynchronous, you can call it to peek the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-482">Для синхронного просмотра очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-482">To synchronously peek the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-483">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-483">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> Возвращает <xref:System.IAsyncResult> , определяющий асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-484"><xref:System.Messaging.MessageQueue.BeginPeek%2A> returns a <xref:System.IAsyncResult> that identifies the asynchronous operation started by the method.</span></span> <span data-ttu-id="51fc7-485">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-485">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-486">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-486">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-487">В этом случае использовать <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-487">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-488">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-488">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-489">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginPeek%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-489">For example, if you call <xref:System.Messaging.MessageQueue.BeginPeek%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="51fc7-490">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-490">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-491">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-491">Workgroup mode</span></span>|<span data-ttu-id="51fc7-492">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-492">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-493">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-493">Local computer</span></span>|<span data-ttu-id="51fc7-494">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-494">Yes</span></span>|  
|<span data-ttu-id="51fc7-495">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-495">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-496">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-496">Yes</span></span>|  
|<span data-ttu-id="51fc7-497">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-497">Remote computer</span></span>|<span data-ttu-id="51fc7-498">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-498">No</span></span>|  
|<span data-ttu-id="51fc7-499">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-499">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-500">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-500">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="51fc7-501">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-501">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-502">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-502">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-503">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-503">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-504">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-504">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-505">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-505">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <MemberGroup MemberName="BeginReceive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="51fc7-506">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-506">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="51fc7-507">Инициирует асинхронную операцию получения, указывая службе MSMQ на необходимость запуска операции получения сообщения и уведомления обработчика событий о завершении операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-507">Initiates an asynchronous receive operation by telling Message Queuing to begin receiving a message and notify the event handler when finished.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive () As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-508">Инициирует асинхронную операцию получения без тайм-аута. Операция остается незавершенной, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-508">Initiates an asynchronous receive operation that has no time-out. The operation is not complete until a message becomes available in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-509">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-509">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-510">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, когда сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-510">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message has been removed from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-511"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-512">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-512">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-513"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-514"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-514">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-515"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-515">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-516">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-516">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-517">Для синхронного получения сообщений, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-517">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-518">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-518">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-519"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-519">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-520">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-520">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-521">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-521">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-522">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-522">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-523">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-523">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-524">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="51fc7-524">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="51fc7-525">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, можно создать для данной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-525">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="51fc7-526">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-526">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="51fc7-527">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-527">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-528">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-528">Workgroup mode</span></span>|<span data-ttu-id="51fc7-529">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-529">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-530">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-530">Local computer</span></span>|<span data-ttu-id="51fc7-531">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-531">Yes</span></span>|  
|<span data-ttu-id="51fc7-532">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-532">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-533">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-533">Yes</span></span>|  
|<span data-ttu-id="51fc7-534">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-534">Remote computer</span></span>|<span data-ttu-id="51fc7-535">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-535">No</span></span>|  
|<span data-ttu-id="51fc7-536">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-536">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-537">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-537">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-538">В следующем примере кода создается цепочка асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="51fc7-538">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="51fc7-539">Предполагается, что есть очередь на локальном компьютере, именем «myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-539">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="51fc7-540">`Main` Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-540">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="51fc7-541">`MyReceiveCompleted` обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-541">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 <span data-ttu-id="51fc7-542">В следующем примере кода создается очередь асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="51fc7-542">The following code example queues asynchronous requests.</span></span> <span data-ttu-id="51fc7-543">Вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> использует <xref:System.IAsyncResult.AsyncWaitHandle%2A> результирующее значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-543">The call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> uses the <xref:System.IAsyncResult.AsyncWaitHandle%2A> in its return value.</span></span> <span data-ttu-id="51fc7-544">`Main` Процедура ожидает завершения перед выходом из всех асинхронных операций.</span><span class="sxs-lookup"><span data-stu-id="51fc7-544">The `Main` routine waits for all asynchronous operations to be completed before exiting.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_wh.cpp#2)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_wh.cs#2)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#2](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_wh.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-545">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-545">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-546">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-546">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-547">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-547">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <summary><span data-ttu-id="51fc7-548">Инициирует асинхронную операцию получения с указанным тайм-аутом. Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-548">Initiates an asynchronous receive operation that has a specified time-out. The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-549">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-549">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-550">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, если сообщение не станет доступным в очереди, или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-550">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="51fc7-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-551"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-552">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-552">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-553"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-554"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-554">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-555"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-555">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-556">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-556">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-557">Для синхронного получения сообщений, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-557">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-558">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-558">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-559">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, возникает событие завершения, но будет создано исключение при вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-559">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, the completion event is raised, but an exception will be thrown when calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-560"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-560">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-561">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-561">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-562">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-562">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-563">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-563">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-564">Эта перегрузка задает тайм-аут. Если время, заданное параметром `timeout` истекло, компонент инициирует <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-564">This overload specifies a time-out. If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="51fc7-565">Поскольку сообщения отсутствуют, следующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-565">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="51fc7-566">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="51fc7-566">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="51fc7-567">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, можно создать для данной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-567">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="51fc7-568">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-568">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="51fc7-569">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-569">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-570">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-570">Workgroup mode</span></span>|<span data-ttu-id="51fc7-571">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-571">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-572">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-572">Local computer</span></span>|<span data-ttu-id="51fc7-573">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-573">Yes</span></span>|  
|<span data-ttu-id="51fc7-574">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-574">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-575">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-575">Yes</span></span>|  
|<span data-ttu-id="51fc7-576">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-576">Remote computer</span></span>|<span data-ttu-id="51fc7-577">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-577">No</span></span>|  
|<span data-ttu-id="51fc7-578">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-578">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-579">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-579">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-580">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-580">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="51fc7-581">В примере кода создается обработчик событий `MyReceiveCompleted`и прикрепляет его к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-581">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="51fc7-582">Отправляет пример кода сообщение очереди сообщений на локальном, затем вызывает метод <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, передавая значение времени ожидания 10 секунд.</span><span class="sxs-lookup"><span data-stu-id="51fc7-582">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%29>, passing in a time-out value of ten seconds.</span></span> <span data-ttu-id="51fc7-583">Если <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, обработчик событий получает сообщение и выводит на экран текста сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-583">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive1#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive1/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive1#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive1/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-584">Значение, заданное для параметра <paramref name="timeout" />, недопустимо. Возможно, было введено отрицательное число.</span><span class="sxs-lookup"><span data-stu-id="51fc7-584">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly because it represents a negative number.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-585">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-585">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-586">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-586">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-587">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-587">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="51fc7-588">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-588">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <summary><span data-ttu-id="51fc7-589">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-589">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-590">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-590">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-591">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-591">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-592">Используется в асинхронной обработке <xref:System.Messaging.MessageQueue.BeginReceive%2A> для вызова <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, если сообщение не станет доступным в очереди, или по истечении заданного интервала времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-592">In asynchronous processing, you use <xref:System.Messaging.MessageQueue.BeginReceive%2A> to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message becomes available in the queue or when the specified interval of time has expired.</span></span>  
  
 <span data-ttu-id="51fc7-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-593"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-594">Используйте эту перегрузку, чтобы связать сведения с операцией, которые будут сохраняться в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-594">Use this overload to associate information with the operation that will be preserved throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-595">Обработчик событий может обнаружить эти сведения, просмотрев <xref:System.IAsyncResult.AsyncState%2A> свойство <xref:System.IAsyncResult> , связанного с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-595">The event handler can detect this information by looking at the <xref:System.IAsyncResult.AsyncState%2A> property of the <xref:System.IAsyncResult> that is associated with the operation.</span></span>  
  
 <span data-ttu-id="51fc7-596">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-596">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-597"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-598"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-598">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-599"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-599">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-600">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-600">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-601">Для синхронного получения сообщений, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-601">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-602">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-602">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-603"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-603">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-604">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-604">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-605">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-605">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-606">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-606">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-607">Эта перегрузка задает время ожидания и объект состояния.</span><span class="sxs-lookup"><span data-stu-id="51fc7-607">This overload specifies a time-out and a state object.</span></span> <span data-ttu-id="51fc7-608">Если время, заданное параметром `timeout` истекло, компонент инициирует <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-608">If the interval specified by the `timeout` parameter expires, this component raises the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span> <span data-ttu-id="51fc7-609">Поскольку сообщения отсутствуют, следующий вызов <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-609">Because no message exists, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> will throw an exception.</span></span>  
  
 <span data-ttu-id="51fc7-610">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-610">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-611">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-611">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="51fc7-612">Можно также использовать объект состояния для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-612">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="51fc7-613">При запуске этого потока, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалинг и передается обратно вместе со сведениями события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-613">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="51fc7-614">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="51fc7-614">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="51fc7-615">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, можно создать для данной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-615">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="51fc7-616">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-616">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="51fc7-617">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-617">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-618">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-618">Workgroup mode</span></span>|<span data-ttu-id="51fc7-619">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-619">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-620">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-620">Local computer</span></span>|<span data-ttu-id="51fc7-621">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-621">Yes</span></span>|  
|<span data-ttu-id="51fc7-622">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-622">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-623">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-623">Yes</span></span>|  
|<span data-ttu-id="51fc7-624">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-624">Remote computer</span></span>|<span data-ttu-id="51fc7-625">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-625">No</span></span>|  
|<span data-ttu-id="51fc7-626">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-626">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-627">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-627">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-628">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-628">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="51fc7-629">В примере кода создается обработчик событий `MyReceiveCompleted`и прикрепляет его к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-629">The code example creates an event handler, `MyReceiveCompleted`, and attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate.</span></span> <span data-ttu-id="51fc7-630">Отправляет пример кода сообщение очереди сообщений на локальном, затем вызывает метод <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, передавая значение времени ожидания 10 секунд и уникальный целочисленный идентификатор конкретного сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-630">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%29>, passing in a time-out value of ten seconds and a unique integer that identifies that particular message.</span></span> <span data-ttu-id="51fc7-631">Если <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, обработчик событий получает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-631">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive2#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive2/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive2#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive2/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-632">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-632">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-633">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-633">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-634">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-634">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, object stateObject, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, object stateObject, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="VB.NET" Value="Public Function BeginReceive (timeout As TimeSpan, stateObject As Object, callback As AsyncCallback) As IAsyncResult" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Object ^ stateObject, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="stateObject" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-635">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-635">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="stateObject"><span data-ttu-id="51fc7-636">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-636">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="51fc7-637">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-637">The <see cref="T:System.AsyncCallback" /> that will receive the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="51fc7-638">Инициирует асинхронную операцию получения с указанным тайм-аутом и заданным объектом состояния, который предоставляет связанные данные в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-638">Initiates an asynchronous receive operation that has a specified time-out and a specified state object, which provides associated information throughout the operation's lifetime.</span></span> <span data-ttu-id="51fc7-639">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-639">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="51fc7-640">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-640">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-641">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-641">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-642">При использовании этой перегрузки обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди, или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="51fc7-642">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="51fc7-643">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для формирования <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-643">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="51fc7-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-644"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-645">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-645">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-646"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-647"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-647">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-648"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-648">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-649">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-649">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-650">Для синхронного получения сообщений, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-650">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-651">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-651">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-652"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-652">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-653">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-653">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-654">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-654">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-655">В этом случае используется <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-655">In this case, you use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-656">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-656">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-657">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-657">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="51fc7-658">Можно также использовать объект состояния для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-658">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="51fc7-659">При запуске этого потока, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалинг и передается обратно вместе со сведениями события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-659">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="51fc7-660">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="51fc7-660">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="51fc7-661">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, можно создать для данной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-661">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="51fc7-662">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-662">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="51fc7-663">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-663">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-664">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-664">Workgroup mode</span></span>|<span data-ttu-id="51fc7-665">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-665">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-666">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-666">Local computer</span></span>|<span data-ttu-id="51fc7-667">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-667">Yes</span></span>|  
|<span data-ttu-id="51fc7-668">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-668">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-669">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-669">Yes</span></span>|  
|<span data-ttu-id="51fc7-670">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-670">Remote computer</span></span>|<span data-ttu-id="51fc7-671">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-671">No</span></span>|  
|<span data-ttu-id="51fc7-672">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-672">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-673">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-673">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-674">В следующем примере кода создается асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-674">The following code example creates an asynchronous receive operation.</span></span> <span data-ttu-id="51fc7-675">Пример кода отправке сообщения в очередь сообщений на локальном, а затем вызывает <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, передавая: значение времени ожидания 10 секунд; уникальный целочисленный идентификатор конкретного сообщения; и новый экземпляр <xref:System.AsyncCallback> , определяющий обработчик событий `MyReceiveCompleted`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-675">The code example sends a message to a local message queue, then calls <xref:System.Messaging.MessageQueue.BeginReceive%28System.TimeSpan%2CSystem.Object%2CSystem.AsyncCallback%29>, passing in: a time-out value of ten seconds; a unique integer that identifies that particular message; and a new instance of <xref:System.AsyncCallback> that identifies the event handler, `MyReceiveCompleted`.</span></span> <span data-ttu-id="51fc7-676">Если <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, обработчик событий получает сообщение и выводит на экран текст сообщения и целочисленный идентификатор сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-676">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the event handler receives the message and writes the message body and the integer message identifier to the screen.</span></span>  
  
 [!code-cpp[MessageQueueBeginReceive3#0](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueueBeginReceive3/cpp/class1.cpp#0)]
 [!code-csharp[MessageQueueBeginReceive3#0](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueueBeginReceive3/CS/class1.cs#0)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-677">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-677">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-678">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-678">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-679">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-679">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="BeginReceive">
      <MemberSignature Language="C#" Value="public IAsyncResult BeginReceive (TimeSpan timeout, System.Messaging.Cursor cursor, object state, AsyncCallback callback);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.IAsyncResult BeginReceive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, object state, class System.AsyncCallback callback) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.BeginReceive(System.TimeSpan,System.Messaging.Cursor,System.Object,System.AsyncCallback)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; IAsyncResult ^ BeginReceive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Object ^ state, AsyncCallback ^ callback);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IAsyncResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="state" Type="System.Object" />
        <Parameter Name="callback" Type="System.AsyncCallback" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-680">Объект <see cref="T:System.TimeSpan" />, который показывает период времени ожидания доступности сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-680">A <see cref="T:System.TimeSpan" /> that indicates the interval of time to wait for a message to become available.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-681">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-681">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="state"><span data-ttu-id="51fc7-682">Задаваемый приложением объект состояния, который содержит сведения, связанные с асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-682">A state object, specified by the application, that contains information associated with the asynchronous operation.</span></span></param>
        <param name="callback"><span data-ttu-id="51fc7-683">Объект <see cref="T:System.AsyncCallback" />, принимающий уведомление о завершении асинхронной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-683">The <see cref="T:System.AsyncCallback" /> that receives the notification of the asynchronous operation completion.</span></span></param>
        <summary><span data-ttu-id="51fc7-684">Инициирует асинхронную операцию получения, которая имеет заданный тайм-аут и использует заданный курсор и заданный объект состояния.</span><span class="sxs-lookup"><span data-stu-id="51fc7-684">Initiates an asynchronous receive operation that has a specified time-out and uses a specified cursor and a specified state object.</span></span> <span data-ttu-id="51fc7-685">Объект состояния предоставляет связанные сведения в течение всего времени выполнения операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-685">The state object provides associated information throughout the lifetime of the operation.</span></span> <span data-ttu-id="51fc7-686">Посредством обратного вызова эта перегрузка получает уведомление об отличительных особенностях обработчика событий для операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-686">This overload receives notification, through a callback, of the identity of the event handler for the operation.</span></span> <span data-ttu-id="51fc7-687">Операция остается незавершенной, пока сообщение не станет доступным в очереди или пока не истечет время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-687">The operation is not complete until either a message becomes available in the queue or the time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-688">Объект <see cref="T:System.IAsyncResult" />, идентифицирующий размещенный асинхронный запрос.</span><span class="sxs-lookup"><span data-stu-id="51fc7-688">The <see cref="T:System.IAsyncResult" /> that identifies the posted asynchronous request.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-689">При использовании этой перегрузки обратный вызов, указанный в параметре обратного вызова инициируется, сообщение не станет доступным в очереди, или по истечении заданного интервала времени. <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие не происходит.</span><span class="sxs-lookup"><span data-stu-id="51fc7-689">When you use this overload, the callback specified in the callback parameter is invoked directly when a message becomes available in the queue or when the specified interval of time has expired; the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is not raised.</span></span> <span data-ttu-id="51fc7-690">Другие перегрузки <xref:System.Messaging.MessageQueue.BeginReceive%2A> полагаются на этот компонент для формирования <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-690">The other overloads of <xref:System.Messaging.MessageQueue.BeginReceive%2A> rely on this component to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event.</span></span>  
  
 <span data-ttu-id="51fc7-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> также возникает, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-691"><xref:System.Messaging.MessageQueue.ReceiveCompleted> is also raised if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-692">Чтобы использовать <xref:System.Messaging.MessageQueue.BeginReceive%2A>, создайте обработчик событий, который будет обрабатывать результаты асинхронной операции и связывания его с делегатом событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-692">To use <xref:System.Messaging.MessageQueue.BeginReceive%2A>, create an event handler that processes the results of the asynchronous operation and associate it with your event delegate.</span></span> <span data-ttu-id="51fc7-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Инициирует асинхронную операцию; получения <xref:System.Messaging.MessageQueue> увидит формирование <xref:System.Messaging.MessageQueue.ReceiveCompleted> событий при поступлении сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-693"><xref:System.Messaging.MessageQueue.BeginReceive%2A> initiates an asynchronous receive operation; the <xref:System.Messaging.MessageQueue> is notified, through the raising of the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event, when a message arrives in the queue.</span></span> <span data-ttu-id="51fc7-694"><xref:System.Messaging.MessageQueue> Затем доступ к сообщению, вызвав <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> или извлечения результата с помощью <xref:System.Messaging.ReceiveCompletedEventArgs>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-694">The <xref:System.Messaging.MessageQueue> can then access the message by calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> or retrieving the result using the <xref:System.Messaging.ReceiveCompletedEventArgs>.</span></span>  
  
 <span data-ttu-id="51fc7-695"><xref:System.Messaging.MessageQueue.BeginReceive%2A> Метод возвращается немедленно, но асинхронной операции не будет завершена, пока не будет вызван обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="51fc7-695">The <xref:System.Messaging.MessageQueue.BeginReceive%2A> method returns immediately, but the asynchronous operation is not completed until the event handler is called.</span></span>  
  
 <span data-ttu-id="51fc7-696">Поскольку <xref:System.Messaging.MessageQueue.BeginReceive%2A> является асинхронным, его можно вызвать для получения сообщения из очереди без блокировки текущего потока выполнения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-696">Because <xref:System.Messaging.MessageQueue.BeginReceive%2A> is asynchronous, you can call it to receive a message from the queue without blocking the current thread of execution.</span></span> <span data-ttu-id="51fc7-697">Для синхронного получения сообщений, используйте <xref:System.Messaging.MessageQueue.Receive%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-697">To synchronously receive a message, use the <xref:System.Messaging.MessageQueue.Receive%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-698">После завершения асинхронной операции, можно вызвать <xref:System.Messaging.MessageQueue.BeginPeek%2A> или <xref:System.Messaging.MessageQueue.BeginReceive%2A> снова в обработчике событий, чтобы продолжать получать уведомления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-698">Once an asynchronous operation completes, you can call <xref:System.Messaging.MessageQueue.BeginPeek%2A> or <xref:System.Messaging.MessageQueue.BeginReceive%2A> again in the event handler to keep receiving notifications.</span></span>  
  
 <span data-ttu-id="51fc7-699"><xref:System.IAsyncResult> , <xref:System.Messaging.MessageQueue.BeginReceive%2A> Возвращает определяет асинхронную операцию, запущенную методом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-699">The <xref:System.IAsyncResult> that <xref:System.Messaging.MessageQueue.BeginReceive%2A> returns identifies the asynchronous operation that the method started.</span></span> <span data-ttu-id="51fc7-700">Эту функцию можно использовать <xref:System.IAsyncResult> во время операции, несмотря на то, что вы обычно не используют эти сведения, пока <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> вызывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-700">You can use this <xref:System.IAsyncResult> throughout the lifetime of the operation, although you generally do not use it until <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is called.</span></span> <span data-ttu-id="51fc7-701">Однако если запускается несколько асинхронных операций, можно поместить их <xref:System.IAsyncResult> значениям в массиве и укажите, следует ли ожидать все операции или для выполнения любой операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-701">However, if you start several asynchronous operations, you can place their <xref:System.IAsyncResult> values in an array and specify whether to wait for all operations or any operation to complete.</span></span> <span data-ttu-id="51fc7-702">В этом случае использовать <xref:System.IAsyncResult.AsyncWaitHandle%2A> свойство <xref:System.IAsyncResult> для идентификации завершенной операции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-702">In this case, use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> property of the <xref:System.IAsyncResult> to identify the completed operation.</span></span>  
  
 <span data-ttu-id="51fc7-703">Объект состояния связывает сведения о состоянии с операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-703">The state object associates state information with the operation.</span></span> <span data-ttu-id="51fc7-704">Например, при вызове метода <xref:System.Messaging.MessageQueue.BeginReceive%2A> несколько раз, чтобы инициировать несколько операций, можно идентифицировать каждую операцию с помощью отдельного объекта состояния, определении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-704">For example, if you call <xref:System.Messaging.MessageQueue.BeginReceive%2A> multiple times to initiate multiple operations, you can identify each operation through a separate state object that you define.</span></span>  
  
 <span data-ttu-id="51fc7-705">Можно также использовать объект состояния для передачи сведений между потоками процесса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-705">You can also use the state object to pass information across process threads.</span></span> <span data-ttu-id="51fc7-706">При запуске этого потока, но обратный вызов находится в другом потоке в асинхронном сценарии, объект состояния маршалинг и передается обратно вместе со сведениями события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-706">If a thread is started but the callback is on a different thread in an asynchronous scenario, the state object is marshaled and passed back along with information from the event.</span></span>  
  
 <span data-ttu-id="51fc7-707">Не используйте асинхронный вызов <xref:System.Messaging.MessageQueue.BeginReceive%2A> с транзакциями.</span><span class="sxs-lookup"><span data-stu-id="51fc7-707">Do not use the asynchronous call <xref:System.Messaging.MessageQueue.BeginReceive%2A> with transactions.</span></span> <span data-ttu-id="51fc7-708">Если вы хотите выполнить транзакционную асинхронную операцию, вызовите <xref:System.Messaging.MessageQueue.BeginPeek%2A>и разместите транзакцию и (синхронный) <xref:System.Messaging.MessageQueue.Receive%2A> метод обработчика событий, можно создать для данной операции считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-708">If you want to perform a transactional asynchronous operation, call <xref:System.Messaging.MessageQueue.BeginPeek%2A>, and put the transaction and the (synchronous) <xref:System.Messaging.MessageQueue.Receive%2A> method within the event handler you create for the peek operation.</span></span> <span data-ttu-id="51fc7-709">Обработчик событий может содержать функциональные возможности, как показано в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-709">Your event handler might contain functionality as shown in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.BeginTransaction();  
 myMessageQueue.Receive();  
 myMessageQueue.CommitTransaction();  
```  
  
 <span data-ttu-id="51fc7-710">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-710">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-711">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-711">Workgroup mode</span></span>|<span data-ttu-id="51fc7-712">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-712">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-713">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-713">Local computer</span></span>|<span data-ttu-id="51fc7-714">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-714">Yes</span></span>|  
|<span data-ttu-id="51fc7-715">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-715">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-716">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-716">Yes</span></span>|  
|<span data-ttu-id="51fc7-717">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-717">Remote computer</span></span>|<span data-ttu-id="51fc7-718">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-718">No</span></span>|  
|<span data-ttu-id="51fc7-719">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-719">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-720">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-720">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-721">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-721">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-722">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-722">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-723">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-723">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-724">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-724">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.TimeSpan" />
      </Docs>
    </Member>
    <Member MemberName="CanRead">
      <MemberSignature Language="C#" Value="public bool CanRead { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanRead" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanRead" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanRead As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanRead { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanRead")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-725">Получает значение, указывающее, может ли быть прочитан объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-725">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be read.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-726">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может прочитать данные из него; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-726"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can read from it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-727"><xref:System.Messaging.MessageQueue.CanRead%2A> Указывает, является ли приложение может просматривать и получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-727"><xref:System.Messaging.MessageQueue.CanRead%2A> indicates whether the application is able to peek or receive messages from the queue.</span></span> <span data-ttu-id="51fc7-728">Если <xref:System.Messaging.MessageQueue.CanRead%2A> — `true`, <xref:System.Messaging.MessageQueue> может получать и считывать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-728">If <xref:System.Messaging.MessageQueue.CanRead%2A> is `true`, the <xref:System.Messaging.MessageQueue> can receive or peek messages from the queue.</span></span> <span data-ttu-id="51fc7-729">В противном случае невозможно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-729">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="51fc7-730"><xref:System.Messaging.MessageQueue.CanRead%2A> — `false` Если очередь уже открыта с монопольным доступом для чтения (или если он открыт монопольного доступа, и этот <xref:System.Messaging.MessageQueue> запрашивает монопольный доступ), или если приложение не имеет достаточных прав для доступа к нему.</span><span class="sxs-lookup"><span data-stu-id="51fc7-730"><xref:System.Messaging.MessageQueue.CanRead%2A> is `false` if a queue is already open with exclusive read access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="51fc7-731">При попытке чтения из очереди приложения при <xref:System.Messaging.MessageQueue.CanRead%2A> — `false`, отказано в доступе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-731">If your application tries to read from a queue when <xref:System.Messaging.MessageQueue.CanRead%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="51fc7-732">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-732">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-733">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-733">Workgroup mode</span></span>|<span data-ttu-id="51fc7-734">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-734">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-735">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-735">Local computer</span></span>|<span data-ttu-id="51fc7-736">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-736">Yes</span></span>|  
|<span data-ttu-id="51fc7-737">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-737">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-738">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-738">Yes</span></span>|  
|<span data-ttu-id="51fc7-739">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-739">Remote computer</span></span>|<span data-ttu-id="51fc7-740">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-740">No</span></span>|  
|<span data-ttu-id="51fc7-741">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-741">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-742">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-742">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-743">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.CanRead%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-743">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanRead%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
    <Member MemberName="CanWrite">
      <MemberSignature Language="C#" Value="public bool CanWrite { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool CanWrite" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CanWrite" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CanWrite As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool CanWrite { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CanWrite")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-744">Получает значение, указывающее, может ли быть выполнена запись в <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-744">Gets a value that indicates whether the <see cref="T:System.Messaging.MessageQueue" /> can be written to.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-745">Значение <see langword="true" />, если класс <see cref="T:System.Messaging.MessageQueue" /> существует, и приложение может записать в него данные; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-745"><see langword="true" /> if the <see cref="T:System.Messaging.MessageQueue" /> exists and the application can write to it; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> Указывает, является ли приложение может отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-746"><xref:System.Messaging.MessageQueue.CanWrite%2A> indicates whether the application is able to send messages to the queue.</span></span> <span data-ttu-id="51fc7-747">Если <xref:System.Messaging.MessageQueue.CanWrite%2A> — `true`, <xref:System.Messaging.MessageQueue> могут отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-747">If <xref:System.Messaging.MessageQueue.CanWrite%2A> is `true`, the <xref:System.Messaging.MessageQueue> can send messages to the queue.</span></span> <span data-ttu-id="51fc7-748">В противном случае невозможно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-748">Otherwise, it cannot.</span></span>  
  
 <span data-ttu-id="51fc7-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> — `false` Если очереди уже был открыт монопольный доступ на запись (или если он открыт монопольного доступа, и этот <xref:System.Messaging.MessageQueue> запрашивает монопольный доступ), или если приложение не имеет достаточных прав для доступа к нему.</span><span class="sxs-lookup"><span data-stu-id="51fc7-749"><xref:System.Messaging.MessageQueue.CanWrite%2A> is `false` if a queue is already open with exclusive write access (or if it's open with non-exclusive access and this <xref:System.Messaging.MessageQueue> requests exclusive access), or if the application does not have sufficient rights to access it.</span></span> <span data-ttu-id="51fc7-750">Если приложение пытается выполнить запись в очередь при <xref:System.Messaging.MessageQueue.CanWrite%2A> — `false`, отказано в доступе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-750">If your application tries to write to a queue when <xref:System.Messaging.MessageQueue.CanWrite%2A> is `false`, access is denied.</span></span>  
  
 <span data-ttu-id="51fc7-751">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-751">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-752">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-752">Workgroup mode</span></span>|<span data-ttu-id="51fc7-753">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-753">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-754">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-754">Local computer</span></span>|<span data-ttu-id="51fc7-755">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-755">Yes</span></span>|  
|<span data-ttu-id="51fc7-756">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-756">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-757">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-757">Yes</span></span>|  
|<span data-ttu-id="51fc7-758">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-758">Remote computer</span></span>|<span data-ttu-id="51fc7-759">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-759">No</span></span>|  
|<span data-ttu-id="51fc7-760">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-760">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-761">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-761">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-762">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.CanWrite%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-762">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CanWrite%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
      </Docs>
    </Member>
    <Member MemberName="Category">
      <MemberSignature Language="C#" Value="public Guid Category { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Category" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Category" />
      <MemberSignature Language="VB.NET" Value="Public Property Category As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Category { Guid get(); void set(Guid value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Category")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-763">Возвращает или задает категорию очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-763">Gets or sets the queue category.</span></span></summary>
        <value><span data-ttu-id="51fc7-764">Объект <see cref="T:System.Guid" />, представляющий категорию очереди (идентификатор типа очереди сообщений), которая позволяет приложению классифицировать его очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-764">A <see cref="T:System.Guid" /> that represents the queue category (Message Queuing type identifier), which allows an application to categorize its queues.</span></span> <span data-ttu-id="51fc7-765">Значение по умолчанию: <see langword="Guid.empty" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-765">The default is <see langword="Guid.empty" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-766">Категория очереди позволяет приложению классифицировать его очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-766">The queue category allows an application to categorize its queues.</span></span> <span data-ttu-id="51fc7-767">Например можно поместить все очереди выставление счетов в одной категории, а все очереди заказа в другой.</span><span class="sxs-lookup"><span data-stu-id="51fc7-767">For example, you can place all Billing queues in one category and all Order queues in another.</span></span>  
  
 <span data-ttu-id="51fc7-768"><xref:System.Messaging.MessageQueue.Category%2A> Свойство предоставляет доступ к свойству идентификатора типов очередей сообщений (который доступен для чтения и записи), доступные через **свойства очереди** диалоговое окно в консоли управления компьютером.</span><span class="sxs-lookup"><span data-stu-id="51fc7-768">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing Type ID property (which is read/write), accessible through the **Queue Properties** dialog box in the Computer Management Console.</span></span> <span data-ttu-id="51fc7-769">Можно определить новую категорию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-769">You can define a new category.</span></span> <span data-ttu-id="51fc7-770">Несмотря на то, что можно использовать <xref:System.Guid.NewGuid%2A> для создания значения категории, которое является уникальным для всех <xref:System.Guid> значения, это действие не требуется.</span><span class="sxs-lookup"><span data-stu-id="51fc7-770">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, such an action is unnecessary.</span></span> <span data-ttu-id="51fc7-771">Значение категории должно отличаться только от других категорий, а не от всех других <xref:System.Guid> значения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-771">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="51fc7-772">Например, можно назначить {00000000-0000-0000-0000-000000000001} как <xref:System.Messaging.MessageQueue.Category%2A> для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-772">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="51fc7-773">Нет необходимости задать <xref:System.Messaging.MessageQueue.Category%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-773">It is not necessary to set the <xref:System.Messaging.MessageQueue.Category%2A>.</span></span> <span data-ttu-id="51fc7-774">Допускается значение `null`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-774">The value can be `null`.</span></span>  
  
 <span data-ttu-id="51fc7-775">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-775">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-776">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляры являются повлияло изменение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-776">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="51fc7-777">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-777">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-778">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-778">Workgroup mode</span></span>|<span data-ttu-id="51fc7-779">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-779">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-780">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-780">Local computer</span></span>|<span data-ttu-id="51fc7-781">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-781">Yes</span></span>|  
|<span data-ttu-id="51fc7-782">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-782">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-783">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-783">Yes</span></span>|  
|<span data-ttu-id="51fc7-784">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-784">Remote computer</span></span>|<span data-ttu-id="51fc7-785">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-785">No</span></span>|  
|<span data-ttu-id="51fc7-786">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-786">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-787">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-787">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-788">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.Category%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-788">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Category%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-789">Для категории очереди задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-789">The queue category was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-790">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-790">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Id" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ClearConnectionCache">
      <MemberSignature Language="C#" Value="public static void ClearConnectionCache ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ClearConnectionCache() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ClearConnectionCache ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ClearConnectionCache();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-791">Очищает кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-791">Clears the connection cache.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-792">При вызове <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, удаляются имена форматов, хранящиеся в кэше и закрытия дескрипторов открытые и хранящиеся в кэше.</span><span class="sxs-lookup"><span data-stu-id="51fc7-792">When you call <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, the format names stored in the cache are removed and handles opened and stored in the cache are closed.</span></span>  
  
 <span data-ttu-id="51fc7-793">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-793">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-794">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-794">Workgroup mode</span></span>|<span data-ttu-id="51fc7-795">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-795">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-796">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-796">Local computer</span></span>|<span data-ttu-id="51fc7-797">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-797">Yes</span></span>|  
|<span data-ttu-id="51fc7-798">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-798">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-799">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-799">Yes</span></span>|  
|<span data-ttu-id="51fc7-800">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-800">Remote computer</span></span>|<span data-ttu-id="51fc7-801">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-801">Yes</span></span>|  
|<span data-ttu-id="51fc7-802">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-802">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-803">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-803">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-804">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-804">The following code example calls <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>.</span></span>  
  
 [!code-csharp[MessageQueue#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-805">Освобождает все ресурсы, выделенные классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-805">Frees all resources allocated by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-806"><xref:System.Messaging.MessageQueue.Close%2A> Освобождает все ресурсы, связанные с <xref:System.Messaging.MessageQueue>, включая общие ресурсы, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-806"><xref:System.Messaging.MessageQueue.Close%2A> frees all resources associated with a <xref:System.Messaging.MessageQueue>, including shared resources if appropriate.</span></span> <span data-ttu-id="51fc7-807">Система возвращает себе ресурсы автоматически, если они по-прежнему доступны, например при вызове <xref:System.Messaging.MessageQueue.Send%28System.Object%29> метода, как в следующем коде C#.</span><span class="sxs-lookup"><span data-stu-id="51fc7-807">The system re-acquires these resources automatically if they are still available, for example when you call the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method, as in the following C# code.</span></span>  
  
```csharp  
myMessageQueue.Send("Text 1.");  
myMessageQueue.Close();  
myMessageQueue.Send("Text 2."); //Resources are re-acquired.  
```  
  
 <span data-ttu-id="51fc7-808">При вызове <xref:System.Messaging.MessageQueue.Close%2A>, что все <xref:System.Messaging.MessageQueue> свойства, которые напрямую обращаются к очереди сообщений, очищаются. <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, И <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> все остается прежним.</span><span class="sxs-lookup"><span data-stu-id="51fc7-808">When you call <xref:System.Messaging.MessageQueue.Close%2A>, all <xref:System.Messaging.MessageQueue> properties that directly access the Message Queuing queue are cleared out. The <xref:System.Messaging.MessageQueue.Path%2A>, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, <xref:System.Messaging.MessageQueue.Formatter%2A>, and <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> all remain as they were.</span></span>  
  
 <span data-ttu-id="51fc7-809"><xref:System.Messaging.MessageQueue.Close%2A> не всегда освободить чтения и записи в очередь, так как они могут быть общими.</span><span class="sxs-lookup"><span data-stu-id="51fc7-809"><xref:System.Messaging.MessageQueue.Close%2A> does not always free the read and write handles to a queue, because they might be shared.</span></span> <span data-ttu-id="51fc7-810">Можно использовать любой из следующих действий, чтобы убедиться, что <xref:System.Messaging.MessageQueue.Close%2A> освобождает дескрипторы чтения и записи в очередь:</span><span class="sxs-lookup"><span data-stu-id="51fc7-810">You can take any of the following steps to ensure that <xref:System.Messaging.MessageQueue.Close%2A> frees the read and write handles to a queue:</span></span>  
  
-   <span data-ttu-id="51fc7-811">Создание <xref:System.Messaging.MessageQueue> с монопольным доступом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-811">Create the <xref:System.Messaging.MessageQueue> with exclusive access.</span></span> <span data-ttu-id="51fc7-812">Чтобы сделать это, вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> или <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> конструктор и задайте `sharedModeDenyReceive` параметр `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-812">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%29> or <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor, and set the `sharedModeDenyReceive` parameter to `true`.</span></span>  
  
-   <span data-ttu-id="51fc7-813">Создание <xref:System.Messaging.MessageQueue> с отключенным кэшированием соединения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-813">Create the <xref:System.Messaging.MessageQueue> with connection caching disabled.</span></span> <span data-ttu-id="51fc7-814">Чтобы сделать это, вызовите <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> конструктор и задайте `enableConnectionCache` параметр `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-814">To do so, call the <xref:System.Messaging.MessageQueue.%23ctor%28System.String%2CSystem.Boolean%2CSystem.Boolean%29> constructor and set the `enableConnectionCache` parameter to `false`.</span></span>  
  
-   <span data-ttu-id="51fc7-815">Отключите кэширование подключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-815">Disable connection caching.</span></span> <span data-ttu-id="51fc7-816">Чтобы сделать это, установите <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> свойства `false`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-816">To do so, set the <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property to `false`.</span></span>  
  
 <span data-ttu-id="51fc7-817">Следует вызвать <xref:System.Messaging.MessageQueue.Close%2A> для очереди, прежде чем удалять очереди сервера очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-817">You should call <xref:System.Messaging.MessageQueue.Close%2A> for a queue before you delete the queue on the Message Queuing server.</span></span> <span data-ttu-id="51fc7-818">В противном случае сообщения, отправленные в очередь может вызывать исключения или отображаются в очереди недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-818">Otherwise, messages sent to the queue could throw exceptions or appear in the dead-letter queue.</span></span>  
  
 <span data-ttu-id="51fc7-819">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-819">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-820">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-820">Workgroup mode</span></span>|<span data-ttu-id="51fc7-821">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-821">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-822">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-822">Local computer</span></span>|<span data-ttu-id="51fc7-823">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-823">Yes</span></span>|  
|<span data-ttu-id="51fc7-824">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-824">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-825">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-825">Yes</span></span>|  
|<span data-ttu-id="51fc7-826">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-826">Remote computer</span></span>|<span data-ttu-id="51fc7-827">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-827">Yes</span></span>|  
|<span data-ttu-id="51fc7-828">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-828">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-829">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-829">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-830">В следующем примере кода закрывает очередь MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-830">The following code example closes a Message Queuing queue.</span></span>  
  
 [!code-cpp[MessageQueue.Close#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Close/CPP/mqclose.cpp#1)]
 [!code-csharp[MessageQueue.Close#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Close/CS/mqclose.cs#1)]
 [!code-vb[MessageQueue.Close#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Close/VB/mqclose.vb#1)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Create">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-831">Создает новую очередь на сервере очереди сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-831">Creates a new queue at the specified path on a Message Queuing server.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-832">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-832">The path of the queue to create.</span></span></param>
        <summary><span data-ttu-id="51fc7-833">Создает нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-833">Creates a non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="51fc7-834">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-834">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-835">Используйте этот перегруженный метод для создания нетранзакционной очереди MSMQ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-835">Use this overload to create a non-transactional Message Queuing queue.</span></span>  
  
 <span data-ttu-id="51fc7-836">Чтобы создать новый экземпляр <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, используйте <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-836">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="51fc7-837">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-837">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="51fc7-838">Синтаксис `path` параметра зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-838">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-839">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-839">Queue type</span></span>|<span data-ttu-id="51fc7-840">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-840">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-841">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-841">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-842">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-842">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="51fc7-843">Используйте «.» для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-843">Use "." for the local computer.</span></span> <span data-ttu-id="51fc7-844">Дополнительные сведения о синтаксисе см. <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-844">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="51fc7-845">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-845">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-846">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-846">Workgroup mode</span></span>|<span data-ttu-id="51fc7-847">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-847">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-848">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-848">Local computer</span></span>|<span data-ttu-id="51fc7-849">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-849">Yes</span></span>|  
|<span data-ttu-id="51fc7-850">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-850">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-851">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-851">Yes</span></span>|  
|<span data-ttu-id="51fc7-852">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-852">Remote computer</span></span>|<span data-ttu-id="51fc7-853">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-853">No</span></span>|  
|<span data-ttu-id="51fc7-854">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-854">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-855">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-855">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-856">В следующем примере кода создается общая и частная очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-856">The following code example creates public and private queues.</span></span> <span data-ttu-id="51fc7-857">Он отправляет сообщение в выбранной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-857">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_path/CPP/mqcreate.cpp#1)]
 [!code-csharp[MessageQueue.Create_path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_path/CS/mqcreate.cs#1)]
 [!code-vb[MessageQueue.Create_path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_path/VB/mqcreate.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-858">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="51fc7-858">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-859">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-859">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="51fc7-860">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-860">-or-</span></span>  
  
 <span data-ttu-id="51fc7-861">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-861">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="Create">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue Create (string path, bool transactional);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue Create(string path, bool transactional) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Create(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Create (path As String, transactional As Boolean) As MessageQueue" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueue ^ Create(System::String ^ path, bool transactional);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="transactional" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-862">Путь создаваемой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-862">The path of the queue to create.</span></span></param>
        <param name="transactional">
          <span data-ttu-id="51fc7-863">Значение <see langword="true" />, если необходимо создать транзакционную очередь; значение <see langword="false" />, если необходимо создать нетранзакционную очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-863"><see langword="true" /> to create a transactional queue; <see langword="false" /> to create a non-transactional queue.</span></span></param>
        <summary><span data-ttu-id="51fc7-864">Создает транзакционную или нетранзакционную очередь сообщений по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-864">Creates a transactional or non-transactional Message Queuing queue at the specified path.</span></span></summary>
        <returns><span data-ttu-id="51fc7-865">Класс <see cref="T:System.Messaging.MessageQueue" />, представляющий новую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-865">A <see cref="T:System.Messaging.MessageQueue" /> that represents the new queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-866">Эту перегрузку можно использовать для создания транзакционной очереди в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-866">You can use this overload to create a transactional queue in Message Queuing.</span></span> <span data-ttu-id="51fc7-867">Нетранзакционная очередь, можно создать, присвоив `transactional` параметр `false` или вызвав другая перегрузка метода <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-867">You can create a non-transactional queue, by setting the `transactional` parameter to `false` or by calling the other overload of <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="51fc7-868">Чтобы создать новый экземпляр <xref:System.Messaging.MessageQueue> класса в приложении и привязать его к существующей очереди, используйте <xref:System.Messaging.MessageQueue.%23ctor%2A> конструктор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-868">To create a new instance of the <xref:System.Messaging.MessageQueue> class in your application and bind it to an existing queue, use the <xref:System.Messaging.MessageQueue.%23ctor%2A> constructor.</span></span> <span data-ttu-id="51fc7-869">Чтобы создать новую очередь в очереди сообщений, вызовите <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-869">To create a new queue in Message Queuing, call <xref:System.Messaging.MessageQueue.Create%28System.String%29>.</span></span>  
  
 <span data-ttu-id="51fc7-870">Синтаксис `path` параметра зависит от типа очереди он ссылается, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-870">The syntax for the `path` parameter depends on the type of queue it references, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-871">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-871">Queue type</span></span>|<span data-ttu-id="51fc7-872">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-872">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-873">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-873">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-874">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-874">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="51fc7-875">Используйте «.» для локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-875">Use "." for the local computer.</span></span> <span data-ttu-id="51fc7-876">Дополнительные сведения о синтаксисе см. <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-876">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="51fc7-877">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-877">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-878">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-878">Workgroup mode</span></span>|<span data-ttu-id="51fc7-879">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-879">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-880">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-880">Local computer</span></span>|<span data-ttu-id="51fc7-881">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-881">Yes</span></span>|  
|<span data-ttu-id="51fc7-882">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-882">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-883">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-883">Yes</span></span>|  
|<span data-ttu-id="51fc7-884">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-884">Remote computer</span></span>|<span data-ttu-id="51fc7-885">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-885">No</span></span>|  
|<span data-ttu-id="51fc7-886">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-886">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-887">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-887">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-888">В следующем примере кода создаются открытых и закрытых транзакций очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-888">The following code example creates public and private transactional queues.</span></span> <span data-ttu-id="51fc7-889">Он отправляет сообщение в выбранной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-889">It sends a message to selected queues.</span></span>  
  
 [!code-cpp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CPP/mqcreate_transactional.cpp#1)]
 [!code-csharp[MessageQueue.Create_PathTransactional#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/CS/mqcreate_transactional.cs#1)]
 [!code-vb[MessageQueue.Create_PathTransactional#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Create_PathTransactional/VB/mqcreate_transactional.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-890">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="51fc7-890">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-891">По указанному пути уже существует очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-891">A queue already exists at the specified path.</span></span>  
  
 <span data-ttu-id="51fc7-892">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-892">-or-</span></span>  
  
 <span data-ttu-id="51fc7-893">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
      </Docs>
    </Member>
    <Member MemberName="CreateCursor">
      <MemberSignature Language="C#" Value="public System.Messaging.Cursor CreateCursor ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Cursor CreateCursor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.CreateCursor" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateCursor () As Cursor" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Cursor ^ CreateCursor();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Cursor</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-894">Создает новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-894">Creates a new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-895">Новый объект <see cref="T:System.Messaging.Cursor" /> для текущей очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-895">A new <see cref="T:System.Messaging.Cursor" /> for the current message queue.</span></span> <span data-ttu-id="51fc7-896">Этот курсор используется для сохранения определенного положения в очереди при чтении сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-896">This cursor is used to maintain a specific location in the queue when reading the queue's messages.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="T:System.Messaging.Cursor" />
      </Docs>
    </Member>
    <Member MemberName="CreateTime">
      <MemberSignature Language="C#" Value="public DateTime CreateTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime CreateTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.CreateTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CreateTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime CreateTime { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_CreateTime")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-897">Получает время и дату создания очереди в службе очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-897">Gets the time and date that the queue was created in Message Queuing.</span></span></summary>
        <value><span data-ttu-id="51fc7-898">Объект <see cref="T:System.DateTime" /> представляющий дату и время создания очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-898">A <see cref="T:System.DateTime" /> that represents the date and time at which the queue was created.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> относится к очереди на сервере очереди сообщений не <xref:System.Messaging.MessageQueue> экземпляра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-899"><xref:System.Messaging.MessageQueue.CreateTime%2A> refers to the queue on the Message Queuing server, not the <xref:System.Messaging.MessageQueue> instance.</span></span>  
  
 <span data-ttu-id="51fc7-900">Если очередь существует, это свойство представляет время создания очереди, скорректированное в местное время сервера, на котором существует очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-900">If the queue exists, this property represents the time the queue was created, adjusted to the local time of the server on which the queue exists.</span></span>  
  
 <span data-ttu-id="51fc7-901">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-901">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-902">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-902">Workgroup mode</span></span>|<span data-ttu-id="51fc7-903">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-903">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-904">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-904">Local computer</span></span>|<span data-ttu-id="51fc7-905">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-905">Yes</span></span>|  
|<span data-ttu-id="51fc7-906">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-906">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-907">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-907">Yes</span></span>|  
|<span data-ttu-id="51fc7-908">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-908">Remote computer</span></span>|<span data-ttu-id="51fc7-909">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-909">No</span></span>|  
|<span data-ttu-id="51fc7-910">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-910">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-911">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-911">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-912">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.CreateTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-912">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.CreateTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-913">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-913">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.LastModifyTime" />
      </Docs>
    </Member>
    <Member MemberName="DefaultPropertiesToSend">
      <MemberSignature Language="C#" Value="public System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.DefaultPropertiesToSend DefaultPropertiesToSend" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
      <MemberSignature Language="VB.NET" Value="Public Property DefaultPropertiesToSend As DefaultPropertiesToSend" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::DefaultPropertiesToSend ^ DefaultPropertiesToSend { System::Messaging::DefaultPropertiesToSend ^ get(); void set(System::Messaging::DefaultPropertiesToSend ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_DefaultPropertiesToSend")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.DefaultPropertiesToSend</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-914">Получает или задает значения свойств сообщения, которые будут использоваться по умолчанию, когда приложение будет отправлять сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-914">Gets or sets the message property values to be used by default when the application sends messages to the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-915">Свойство <see cref="T:System.Messaging.DefaultPropertiesToSend" />, содержащее используемые по умолчанию значения свойств сообщений очереди сообщений, которые применяются, когда приложение отправляет в очередь объекты, отличные от экземпляров <see cref="T:System.Messaging.Message" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-915">A <see cref="T:System.Messaging.DefaultPropertiesToSend" /> that contains the default Message Queuing message property values used when the application sends objects other than <see cref="T:System.Messaging.Message" /> instances to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-916">При отправке любой объект, который не относится к типу <xref:System.Messaging.Message> в очередь <xref:System.Messaging.MessageQueue> вставляет объект в сообщение Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-916">When you send any object that is not of type <xref:System.Messaging.Message> to the queue, the <xref:System.Messaging.MessageQueue> inserts the object into a Message Queuing message.</span></span> <span data-ttu-id="51fc7-917">В этот момент <xref:System.Messaging.MessageQueue> применяет к этому сообщению значения свойств, указанные в <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-917">At that time, the <xref:System.Messaging.MessageQueue> applies to the message the property values you specify in the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property.</span></span> <span data-ttu-id="51fc7-918">И наоборот при отправке <xref:System.Messaging.Message> в очередь, эти свойства уже заданы для самого экземпляра, поэтому <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> учитывается для <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-918">Conversely, if you send a <xref:System.Messaging.Message> to the queue, these properties are already specified for the instance itself, so <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> is ignored for the <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="51fc7-919">Несмотря на то, что значение свойства с помощью <xref:System.Messaging.MessageQueue> объекта, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> ссылается на свойства сообщения, которые отправляются в очередь, а не саму очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-919">Although you set the properties through the <xref:System.Messaging.MessageQueue> object, the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> refers to the properties of the messages that are sent to the queue, not the queue itself.</span></span>  
  
 <span data-ttu-id="51fc7-920">В следующей таблице показаны значения по умолчанию для свойства.</span><span class="sxs-lookup"><span data-stu-id="51fc7-920">The default values for the properties are shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-921">Свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-921">Property</span></span>|<span data-ttu-id="51fc7-922">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="51fc7-922">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.DefaultPropertiesToSend.AcknowledgeType%2A>|`AcknowledgeType.None`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AdministrationQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.AppSpecific%2A>|<span data-ttu-id="51fc7-923">Ноль (0)</span><span class="sxs-lookup"><span data-stu-id="51fc7-923">Zero (0)</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.AttachSenderId%2A>|`true`|  
|<xref:System.Messaging.DefaultPropertiesToSend.EncryptionAlgorithm%2A>|`EncryptionAlgorithm.RC2`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Extension%2A>|<span data-ttu-id="51fc7-924">Массив байтов нулевой длины</span><span class="sxs-lookup"><span data-stu-id="51fc7-924">A zero-length array of bytes</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.HashAlgorithm%2A>|`HashAlgorithm.MD5`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Label%2A>|<span data-ttu-id="51fc7-925">Пустая строка (»»)</span><span class="sxs-lookup"><span data-stu-id="51fc7-925">Empty string ("")</span></span>|  
|<xref:System.Messaging.DefaultPropertiesToSend.Priority%2A>|`MessagePriority.Normal`|  
|<xref:System.Messaging.DefaultPropertiesToSend.Recoverable%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.ResponseQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToBeReceived%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TimeToReachQueue%2A>|`Message.InfiniteTimeout`|  
|<xref:System.Messaging.DefaultPropertiesToSend.TransactionStatusQueue%2A>|`null`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.DefaultPropertiesToSend.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="51fc7-926">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-926">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-927">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-927">Workgroup mode</span></span>|<span data-ttu-id="51fc7-928">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-928">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-929">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-929">Local computer</span></span>|<span data-ttu-id="51fc7-930">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-930">Yes</span></span>|  
|<span data-ttu-id="51fc7-931">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-931">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-932">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-932">Yes</span></span>|  
|<span data-ttu-id="51fc7-933">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-933">Remote computer</span></span>|<span data-ttu-id="51fc7-934">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-934">Yes</span></span>|  
|<span data-ttu-id="51fc7-935">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-935">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-936">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-936">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-937">В следующем примере кода используется приоритет сообщения для определения свойств по умолчанию для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-937">The following code example uses the priority of a message to determine default properties to send for the message.</span></span>  
  
 [!code-cpp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CPP/mqdefaultpropertiestosend.cpp#1)]
 [!code-csharp[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/CS/mqdefaultpropertiestosend.cs#1)]
 [!code-vb[MessageQueue.DefaultPropertiesToSend#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.DefaultPropertiesToSend/VB/mqdefaultpropertiestosend.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-938">Для очереди нельзя задать использующиеся по умолчанию свойства. Возможно, потому что неправильно задано одно из свойств.</span><span class="sxs-lookup"><span data-stu-id="51fc7-938">The default properties could not be set for the queue, possibly because one of the properties is not valid.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.AcknowledgeTypes" />
        <altmember cref="T:System.Messaging.EncryptionAlgorithm" />
        <altmember cref="T:System.Messaging.HashAlgorithm" />
        <altmember cref="F:System.Messaging.Message.InfiniteTimeout" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (path As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-939">Расположение удаляемой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-939">The location of the queue to be deleted.</span></span></param>
        <summary><span data-ttu-id="51fc7-940">Удаляет очередь с сервера очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-940">Deletes a queue on a Message Queuing server.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-941">Синтаксис `path` параметр зависит от типа очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-941">The syntax for the `path` parameter depends on the type of queue.</span></span>  
  
|<span data-ttu-id="51fc7-942">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-942">Queue type</span></span>|<span data-ttu-id="51fc7-943">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-943">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-944">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-944">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-945">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-945">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
  
 <span data-ttu-id="51fc7-946">Дополнительные сведения о синтаксисе см. <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-946">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="51fc7-947">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-947">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="51fc7-948">Ссылка</span><span class="sxs-lookup"><span data-stu-id="51fc7-948">Reference</span></span>|<span data-ttu-id="51fc7-949">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-949">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="51fc7-950">Название формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-950">Format name</span></span>|<span data-ttu-id="51fc7-951">FormatName: [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-951">FormatName:[ *format name* ]</span></span>|  
|<span data-ttu-id="51fc7-952">Метка</span><span class="sxs-lookup"><span data-stu-id="51fc7-952">Label</span></span>|<span data-ttu-id="51fc7-953">Метка: [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-953">Label:[ *label* ]</span></span>|  
  
 <span data-ttu-id="51fc7-954">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-954">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-955">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-955">Workgroup mode</span></span>|<span data-ttu-id="51fc7-956">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-956">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-957">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-957">Local computer</span></span>|<span data-ttu-id="51fc7-958">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-958">Yes</span></span>|  
|<span data-ttu-id="51fc7-959">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-959">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-960">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-960">Yes</span></span>|  
|<span data-ttu-id="51fc7-961">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-961">Remote computer</span></span>|<span data-ttu-id="51fc7-962">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-962">No</span></span>|  
|<span data-ttu-id="51fc7-963">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-963">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-964">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-964">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-965">В следующем примере кода удаляется очередь MSMQ, если он существует.</span><span class="sxs-lookup"><span data-stu-id="51fc7-965">The following code example deletes a Message Queuing queue, if it exists.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-966">Значение параметра <paramref name="path" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="51fc7-966">The <paramref name="path" /> parameter is <see langword="null" /> or is an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-967">Для параметра <paramref name="path" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="51fc7-967">The syntax for the <paramref name="path" /> parameter is not valid.</span></span>  
  
 <span data-ttu-id="51fc7-968">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-968">-or-</span></span>  
  
 <span data-ttu-id="51fc7-969">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-969">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="DenySharedReceive">
      <MemberSignature Language="C#" Value="public bool DenySharedReceive { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DenySharedReceive" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.DenySharedReceive" />
      <MemberSignature Language="VB.NET" Value="Public Property DenySharedReceive As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DenySharedReceive { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_DenySharedReceive")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-970">Получает или задает значение, показывающее, имеет ли этот объект <see cref="T:System.Messaging.MessageQueue" /> монопольный доступ на получение сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-970">Gets or sets a value that indicates whether this <see cref="T:System.Messaging.MessageQueue" /> has exclusive access to receive messages from the Message Queuing queue.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-971">Значение <see langword="true" />, если этот класс <see cref="T:System.Messaging.MessageQueue" /> имеет права монопольного доступа для получения сообщений из очереди; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-971"><see langword="true" /> if this <see cref="T:System.Messaging.MessageQueue" /> has exclusive rights to receive messages from the queue; otherwise, <see langword="false" />.</span></span> <span data-ttu-id="51fc7-972">Значение по умолчанию: <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-972">The default is <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> Указывает режим создания общих очереди, упоминаемой в этом <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-973"><xref:System.Messaging.MessageQueue.DenySharedReceive%2A> specifies the shared mode of the queue referenced by this <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-974">Задать <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> для `true` , только это <xref:System.Messaging.MessageQueue> должны иметь доступ на просмотр и получение сообщений из очереди с указанным <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-974">Set <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> to `true` to indicate that only this <xref:System.Messaging.MessageQueue> should have access to peek or receive messages from the queue with the specified <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="51fc7-975">Если другой <xref:System.Messaging.MessageQueue> или другое приложение связано с тем же ресурсом очереди, этот экземпляр или приложение не сможет просматривать и получать сообщения, но она по-прежнему отправлять их.</span><span class="sxs-lookup"><span data-stu-id="51fc7-975">If another <xref:System.Messaging.MessageQueue> or another application is associated with the same queue resource, that instance or application will not be able to peek or receive messages, but it can still send them.</span></span>  
  
 <span data-ttu-id="51fc7-976">Если <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> — `false`, очередь доступна для нескольких приложений для отправки, просмотра или получения сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-976">If <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> is `false`, the queue is available to multiple applications for sending, peeking, or receiving messages.</span></span>  
  
 <span data-ttu-id="51fc7-977">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-977">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-978">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-978">Workgroup mode</span></span>|<span data-ttu-id="51fc7-979">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-979">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-980">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-980">Local computer</span></span>|<span data-ttu-id="51fc7-981">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-981">Yes</span></span>|  
|<span data-ttu-id="51fc7-982">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-982">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-983">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-983">Yes</span></span>|  
|<span data-ttu-id="51fc7-984">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-984">Remote computer</span></span>|<span data-ttu-id="51fc7-985">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-985">Yes</span></span>|  
|<span data-ttu-id="51fc7-986">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-986">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-987">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-987">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-988">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-988">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.DenySharedReceive%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="51fc7-989">Значение <see langword="true" /> позволяет освободить как управляемые, так и неуправляемые ресурсы; значение <see langword="false" /> освобождает только неуправляемые ресурсы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-989"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="51fc7-990">Уничтожает ресурсы (кроме памяти), используемые классом <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-990">Disposes of the resources (other than memory) used by the <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-991">Вызовите метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> по окончании использования класса <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-991">Call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> when you are finished using the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-992">Метод <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> оставляет класс <xref:System.Messaging.MessageQueue> в непригодном для использования состоянии.</span><span class="sxs-lookup"><span data-stu-id="51fc7-992">The <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> method leaves the <xref:System.Messaging.MessageQueue> in an unusable state.</span></span> <span data-ttu-id="51fc7-993">После вызова метода <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, необходимо освободить все ссылки на <xref:System.Messaging.MessageQueue> , занимаемая ими память можно удалять его сборщику мусора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-993">After calling <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29>, you must release all references to the <xref:System.Messaging.MessageQueue> so the memory it was occupying can be reclaimed by garbage collection.</span></span>  
  
 <span data-ttu-id="51fc7-994">Необходимо вызвать <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> перед освобождением последней ссылки на <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-994">You should call <xref:System.Messaging.MessageQueue.Dispose%28System.Boolean%29> before you release your last reference to the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-995">В противном случае ресурсы <xref:System.Messaging.MessageQueue> — не будут освобождены до сборки мусора не будет <xref:System.Messaging.MessageQueue> деструктор объекта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-995">Otherwise, the resources the <xref:System.Messaging.MessageQueue> is using will not be freed until garbage collection calls the <xref:System.Messaging.MessageQueue> object's destructor.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <Member MemberName="EnableConnectionCache">
      <MemberSignature Language="C#" Value="public static bool EnableConnectionCache { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property bool EnableConnectionCache" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EnableConnectionCache" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property EnableConnectionCache As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property bool EnableConnectionCache { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-996">Получает или задает значение, указывающее, будет ли приложение поддерживать кэш подключений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-996">Gets or sets a value that indicates whether a cache of connections will be maintained by the application.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-997">Значение <see langword="true" />, если необходимо создать и использовать кэш подключений; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-997"><see langword="true" /> to create and use a connection cache; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-998">Кэш подключений приведен список ссылок на структуры, содержащие чтения или записи в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-998">A connection cache is a list of references to structures that contain read or write handles to queues.</span></span> <span data-ttu-id="51fc7-999">При <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> — `true`, <xref:System.Messaging.MessageQueue> занимает маркеры из кэша при каждом вызове <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, или <xref:System.Messaging.MessageQueue.Receive%2A>, а не создает новые дескрипторы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-999">When <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> is `true`, the <xref:System.Messaging.MessageQueue> borrows handles from the cache each time you call <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, <xref:System.Messaging.MessageQueue.Peek%2A>, or <xref:System.Messaging.MessageQueue.Receive%2A>, rather than open new handles.</span></span> <span data-ttu-id="51fc7-1000">Это может повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1000">This can improve performance.</span></span> <span data-ttu-id="51fc7-1001">Использование кэша подключений также изолирует <xref:System.Messaging.MessageQueue> от изменений топологии сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1001">Using a connection cache also insulates the <xref:System.Messaging.MessageQueue> from changes in the network topology.</span></span>  
  
 <span data-ttu-id="51fc7-1002">Если создать новое соединение в очередь, когда кэш подключений заполнен <xref:System.Messaging.MessageQueue> перезаписывает бы недавно использовавшихся структуры с новым соединением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1002">If you create a new connection to a queue when the connection cache is full, the <xref:System.Messaging.MessageQueue> overwrites the least recently accessed structure with the new connection.</span></span> <span data-ttu-id="51fc7-1003">Очистку кэша можно провести с помощью метода <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, например, если имена формата очередей, вы работаете с были изменены, чтобы предыдущие чтения и записи, дескрипторы становятся недействительными.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1003">You can clear the cache entirely by calling <xref:System.Messaging.MessageQueue.ClearConnectionCache%2A>, for example, if the format names of the queues you are working with have changed so that the previous read and write handles are no longer valid.</span></span>  
  
 <span data-ttu-id="51fc7-1004">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1004">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1005">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1005">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1006">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1006">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1007">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1007">Local computer</span></span>|<span data-ttu-id="51fc7-1008">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1008">Yes</span></span>|  
|<span data-ttu-id="51fc7-1009">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1009">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1010">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1010">Yes</span></span>|  
|<span data-ttu-id="51fc7-1011">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1011">Remote computer</span></span>|<span data-ttu-id="51fc7-1012">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1012">Yes</span></span>|  
|<span data-ttu-id="51fc7-1013">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1013">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1014">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1014">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1015">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1015">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EnableConnectionCache%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.ClearConnectionCache" />
      </Docs>
    </Member>
    <Member MemberName="EncryptionRequired">
      <MemberSignature Language="C#" Value="public System.Messaging.EncryptionRequired EncryptionRequired { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Messaging.EncryptionRequired EncryptionRequired" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.EncryptionRequired" />
      <MemberSignature Language="VB.NET" Value="Public Property EncryptionRequired As EncryptionRequired" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::EncryptionRequired EncryptionRequired { System::Messaging::EncryptionRequired get(); void set(System::Messaging::EncryptionRequired value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_EncryptionRequired")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.EncryptionRequired</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1016">Получает или задает значение, указывающее, будет ли очередь принимать только неконфиденциальные (незашифрованные) сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1016">Gets or sets a value that indicates whether the queue accepts only non-private (non-encrypted) messages.</span></span></summary>
        <value><span data-ttu-id="51fc7-1017">Одно из значений перечисления <see cref="T:System.Messaging.EncryptionRequired" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1017">One of the <see cref="T:System.Messaging.EncryptionRequired" /> values.</span></span> <span data-ttu-id="51fc7-1018">Значение по умолчанию: <see langword="None" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1018">The default is <see langword="None" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1019">При указании, что шифрование является обязательным для сообщений, отправленных в очередь, шифруются только тел сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1019">When you specify that encryption is required for the messages sent to a queue, only the message bodies are encrypted.</span></span> <span data-ttu-id="51fc7-1020">Другие члены (например, <xref:System.Messaging.Message.Label%2A> и <xref:System.Messaging.Message.SenderId%2A> свойства) не могут быть зашифрованы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1020">The other members (for example, the <xref:System.Messaging.Message.Label%2A> and <xref:System.Messaging.Message.SenderId%2A> properties) cannot be encrypted.</span></span>  
  
 <span data-ttu-id="51fc7-1021">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1021">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-1022">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляры являются повлияло изменение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1022">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="51fc7-1023">Если сообщение зашифровано, автоматически делает закрытый.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1023">Encrypting a message makes the message private.</span></span> <span data-ttu-id="51fc7-1024">Можно указать требования шифрования очереди `None`, `Body`, или `Optional` , установив <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойство соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1024">You can specify the queue's encryption requirement to be `None`, `Body`, or `Optional` by setting the <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property appropriately.</span></span> <span data-ttu-id="51fc7-1025"><xref:System.Messaging.Message.UseEncryption%2A> Требования шифрования очереди должно соответствовать сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1025">The <xref:System.Messaging.Message.UseEncryption%2A> setting of the message must correspond to the encryption requirement of the queue.</span></span> <span data-ttu-id="51fc7-1026">Если сообщение не зашифровано, но очередь не указывает `Body`, или если сообщение зашифровано, но очередь не указывает `None`, сообщение будет отклонено очередью.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1026">If the message is not encrypted but the queue specifies `Body`, or if the message is encrypted but the queue specifies `None`, the message is rejected by the queue.</span></span> <span data-ttu-id="51fc7-1027">Если отправляющее приложение запрашивает сообщение отрицательного подтверждения в этом событии, очереди сообщений указывает отправляющего приложения, что сообщение было отвергнуто.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1027">If the sending application requests a negative acknowledgment message in this event, Message Queuing indicates the message's rejection to the sending application.</span></span> <span data-ttu-id="51fc7-1028">Если <xref:System.Messaging.Message.UseDeadLetterQueue%2A> свойство `true`, завершаются с ошибкой шифрования помещается в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1028">If the <xref:System.Messaging.Message.UseDeadLetterQueue%2A> property is `true`, a message that fails encryption is sent to the dead-letter queue.</span></span> <span data-ttu-id="51fc7-1029">В противном случае сообщение теряется.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1029">Otherwise, the message is lost.</span></span>  
  
 <span data-ttu-id="51fc7-1030">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1030">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1031">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1031">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1032">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1032">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1033">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1033">Local computer</span></span>|<span data-ttu-id="51fc7-1034">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1034">Yes</span></span>|  
|<span data-ttu-id="51fc7-1035">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1035">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1036">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1036">Yes</span></span>|  
|<span data-ttu-id="51fc7-1037">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1037">Remote computer</span></span>|<span data-ttu-id="51fc7-1038">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1038">No</span></span>|  
|<span data-ttu-id="51fc7-1039">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1039">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1040">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1040">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1041">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1041">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.EncryptionRequired%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1042">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1042">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Acknowledgment" />
        <altmember cref="P:System.Messaging.Message.UseEncryption" />
      </Docs>
    </Member>
    <Member MemberName="EndPeek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndPeek (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndPeek(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndPeek(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndPeek (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndPeek(IAsyncResult ^ asyncResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="51fc7-1043">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию считывания, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1043">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous peek operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="51fc7-1044">Завершает указанную асинхронную операцию считывания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1044">Completes the specified asynchronous peek operation.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1045">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1045">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1046">Когда <xref:System.Messaging.MessageQueue.PeekCompleted> события <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> завершает операцию, которая была начата <xref:System.Messaging.MessageQueue.BeginPeek%2A> вызова.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1046">When the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginPeek%2A> call.</span></span> <span data-ttu-id="51fc7-1047">Чтобы сделать это, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> считывает сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1047">To do so, <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> peeks the message.</span></span>  
  
 <span data-ttu-id="51fc7-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> можно указать время ожидания, что приведет к тому <xref:System.Messaging.MessageQueue.PeekCompleted> событие при возникновении тайм-аута до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1048"><xref:System.Messaging.MessageQueue.BeginPeek%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="51fc7-1049">При возникновении тайм-аута без сообщений, поступающих в очередь в последующем вызове <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> приводит к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1049">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="51fc7-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> используется для чтения сообщения, которое вызвало <xref:System.Messaging.MessageQueue.PeekCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1050"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to read the message that caused the <xref:System.Messaging.MessageQueue.PeekCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="51fc7-1051">Если вы хотите продолжить асинхронный просмотр сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginPeek%2A> после вызова <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1051">If you want to continue to asynchronously peek messages, you can again call <xref:System.Messaging.MessageQueue.BeginPeek%2A> after calling <xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-1052">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1052">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1053">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1053">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1054">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1054">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1055">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1055">Local computer</span></span>|<span data-ttu-id="51fc7-1056">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1056">Yes</span></span>|  
|<span data-ttu-id="51fc7-1057">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1057">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1058">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1058">Yes</span></span>|  
|<span data-ttu-id="51fc7-1059">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1059">Remote computer</span></span>|<span data-ttu-id="51fc7-1060">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1060">No</span></span>|  
|<span data-ttu-id="51fc7-1061">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1061">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1062">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1062">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1063">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> Чтобы инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-1063">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="51fc7-1064">При <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1064">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="51fc7-1065">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1065">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1066">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1066">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1067">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1067">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1068">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1068">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
      </Docs>
    </Member>
    <Member MemberName="EndReceive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message EndReceive (IAsyncResult asyncResult);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message EndReceive(class System.IAsyncResult asyncResult) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.EndReceive(System.IAsyncResult)" />
      <MemberSignature Language="VB.NET" Value="Public Function EndReceive (asyncResult As IAsyncResult) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ EndReceive(IAsyncResult ^ asyncResult);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="asyncResult" Type="System.IAsyncResult" />
      </Parameters>
      <Docs>
        <param name="asyncResult"><span data-ttu-id="51fc7-1069">Объект <see cref="T:System.IAsyncResult" />, определяющий асинхронную операцию получения, которая завершается и из которой извлекается конечный результат.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1069">The <see cref="T:System.IAsyncResult" /> that identifies the asynchronous receive operation to finish and from which to retrieve an end result.</span></span></param>
        <summary><span data-ttu-id="51fc7-1070">Завершает указанную асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1070">Completes the specified asynchronous receive operation.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1071">Класс <see cref="T:System.Messaging.Message" />, связанный с завершенной асинхронной операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1071">The <see cref="T:System.Messaging.Message" /> associated with the completed asynchronous operation.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1072">Когда <xref:System.Messaging.MessageQueue.ReceiveCompleted> события <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> завершает операцию, которая была начата <xref:System.Messaging.MessageQueue.BeginReceive%2A> вызова.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1072">When the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> completes the operation that was initiated by the <xref:System.Messaging.MessageQueue.BeginReceive%2A> call.</span></span> <span data-ttu-id="51fc7-1073">Чтобы сделать это, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> получает сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1073">To do so, <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> receives the message.</span></span>  
  
 <span data-ttu-id="51fc7-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> можно указать время ожидания, что приведет к тому <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие при возникновении тайм-аута до появления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1074"><xref:System.Messaging.MessageQueue.BeginReceive%2A> can specify a time-out, which causes the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised if the time-out occurs before a message appears in the queue.</span></span> <span data-ttu-id="51fc7-1075">При возникновении тайм-аута без сообщений, поступающих в очередь в последующем вызове <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> приводит к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1075">When a time-out occurs without a message arriving in the queue, a subsequent call to <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> throws an exception.</span></span>  
  
 <span data-ttu-id="51fc7-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> используется для чтения (с удалением из очереди) сообщения, которое вызвало <xref:System.Messaging.MessageQueue.ReceiveCompleted> вызова события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1076"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to read (removing from the queue) the message that caused the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event to be raised.</span></span>  
  
 <span data-ttu-id="51fc7-1077">Если вы хотите продолжить асинхронное получение сообщений, можно снова вызвать метод <xref:System.Messaging.MessageQueue.BeginReceive%2A> после вызова <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1077">If you want to continue to asynchronously receive messages, you can again call <xref:System.Messaging.MessageQueue.BeginReceive%2A> after calling <xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29>.</span></span>  
  
 <span data-ttu-id="51fc7-1078">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1078">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1079">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1079">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1080">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1080">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1081">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1081">Local computer</span></span>|<span data-ttu-id="51fc7-1082">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1082">Yes</span></span>|  
|<span data-ttu-id="51fc7-1083">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1083">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1084">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1084">Yes</span></span>|  
|<span data-ttu-id="51fc7-1085">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1085">Remote computer</span></span>|<span data-ttu-id="51fc7-1086">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1086">No</span></span>|  
|<span data-ttu-id="51fc7-1087">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1087">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1088">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1088">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1089">В следующем примере кода создается цепочка асинхронных запросов.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1089">The following code example chains asynchronous requests.</span></span> <span data-ttu-id="51fc7-1090">Предполагается, что есть очередь на локальном компьютере, именем «myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-1090">It assumes there is a queue on the local computer called "myQueue".</span></span> <span data-ttu-id="51fc7-1091">`Main` Функция начинает асинхронную операцию, которая обрабатывается `MyReceiveCompleted` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1091">The `Main` function begins the asynchronous operation that is handled by the `MyReceiveCompleted` routine.</span></span> <span data-ttu-id="51fc7-1092">`MyReceiveCompleted` обрабатывает текущее сообщение и начинает новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1092">`MyReceiveCompleted` processes the current message and begins a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CPP/mqbeginreceive_noparms_mre.cpp#1)]
 [!code-csharp[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/CS/mqbeginreceive_noparms_mre.cs#1)]
 [!code-vb[MessageQueue.BeginReceive_noparms_combined#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginReceive_noparms_combined/VB/mqbeginreceive_noparms_mre.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1093">Параметр <paramref name="asyncResult" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1093">The <paramref name="asyncResult" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1094">Для параметра <paramref name="asyncResult" /> используется неправильный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1094">The syntax of the <paramref name="asyncResult" /> parameter is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1095">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1095">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ path);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="51fc7-1096">Расположение искомой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1096">The location of the queue to find.</span></span></param>
        <summary><span data-ttu-id="51fc7-1097">Определяет, существует ли по указанному пути очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1097">Determines whether a Message Queuing queue exists at the specified path.</span></span></summary>
        <returns>
          <span data-ttu-id="51fc7-1098">Значение <see langword="true" />, если очередь по указанному пути существует; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1098"><see langword="true" /> if a queue with the specified path exists; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1099"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод определяет, существует ли очередь Message Queuing по указанному пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1099">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method determines whether a Message Queuing queue exists at a specified path.</span></span> <span data-ttu-id="51fc7-1100">Метод не существует в том, чтобы определить, существует ли очередь с указанным именем формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1100">No method exists to determine whether a queue with a specified format name exists.</span></span> <span data-ttu-id="51fc7-1101">Дополнительные сведения о синтаксисе имени формата и других формах синтаксиса пути см. в разделе <xref:System.Messaging.MessageQueue.Path%2A> свойство.)</span><span class="sxs-lookup"><span data-stu-id="51fc7-1101">For more information about the format name syntax and other path syntax forms, see the <xref:System.Messaging.MessageQueue.Path%2A> property.)</span></span>  
  
 <span data-ttu-id="51fc7-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> является ресурсоемкой операцией.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1102"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> is an expensive operation.</span></span> <span data-ttu-id="51fc7-1103">Используйте только в том случае, когда это необходимо в приложении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1103">Use it only when it is necessary within the application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="51fc7-1104"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> Метод не поддерживает <xref:System.Messaging.MessageQueue.FormatName%2A> префикс.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1104">The <xref:System.Messaging.MessageQueue.Exists%28System.String%29> method does not support the <xref:System.Messaging.MessageQueue.FormatName%2A> prefix.</span></span>  
  
 <span data-ttu-id="51fc7-1105">Синтаксис `path` параметр зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1105">The syntax for the `path` parameter depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-1106">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-1106">Queue type</span></span>|<span data-ttu-id="51fc7-1107">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-1107">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-1108">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-1108">Public queue</span></span>|`MachineName`\\`QueueName`|  
  
 <span data-ttu-id="51fc7-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> не может вызываться для проверки существования удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1109"><xref:System.Messaging.MessageQueue.Exists%28System.String%29> cannot be called to verify the existence of a remote private queue.</span></span>  
  
 <span data-ttu-id="51fc7-1110">Дополнительные сведения о синтаксисе см. <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1110">For more syntax, see the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span>  
  
 <span data-ttu-id="51fc7-1111">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1111">Alternatively, you can use the <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path.</span></span>  
  
|<span data-ttu-id="51fc7-1112">Ссылка</span><span class="sxs-lookup"><span data-stu-id="51fc7-1112">Reference</span></span>|<span data-ttu-id="51fc7-1113">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-1113">Syntax</span></span>|  
|---------------|------------|  
|<span data-ttu-id="51fc7-1114">Метка</span><span class="sxs-lookup"><span data-stu-id="51fc7-1114">Label</span></span>|<span data-ttu-id="51fc7-1115">Метка: [ `label` ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-1115">Label:[ `label` ]</span></span>|  
  
 <span data-ttu-id="51fc7-1116">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1116">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1117">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1117">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1118">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1118">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1119">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1119">Local computer</span></span>|<span data-ttu-id="51fc7-1120">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1120">Yes</span></span>|  
|<span data-ttu-id="51fc7-1121">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1121">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1122">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1122">No</span></span>|  
|<span data-ttu-id="51fc7-1123">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1123">Remote computer</span></span>|<span data-ttu-id="51fc7-1124">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1124">No</span></span>|  
|<span data-ttu-id="51fc7-1125">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1125">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1126">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1126">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1127">В следующем примере кода проверяет, является ли очередь MSMQ существует, а затем удаляет его.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1127">The following code example verifies whether a Message Queuing queue exists, and then deletes it.</span></span>  
  
 [!code-cpp[MessageQueue.ExistsDelete#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CPP/mqexistsdelete.cpp#1)]
 [!code-csharp[MessageQueue.ExistsDelete#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ExistsDelete/CS/mqexistsdelete.cs#1)]
 [!code-vb[MessageQueue.ExistsDelete#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ExistsDelete/VB/mqexistsdelete.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1128">Неправильный синтаксис параметра <paramref name="path" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1128">The <paramref name="path" /> syntax is not valid.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1129">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1129">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="51fc7-1130">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-1130">-or-</span></span>  
  
 <span data-ttu-id="51fc7-1131">Метод <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> вызывается на удаленной частной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1131">The <see cref="M:System.Messaging.MessageQueue.Exists(System.String)" /> method is being called on a remote private queue</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1132">При проверке существования очереди приложение использовало синтаксис имени формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1132">The application used format name syntax when verifying queue existence.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
      </Docs>
    </Member>
    <Member MemberName="FormatName">
      <MemberSignature Language="C#" Value="public string FormatName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string FormatName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.FormatName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property FormatName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ FormatName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_FormatName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1133">Получает уникальное имя очереди, созданное службой очереди сообщений в момент создания очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1133">Gets the unique queue name that Message Queuing generated at the time of the queue's creation.</span></span></summary>
        <value><span data-ttu-id="51fc7-1134">Имя очереди, которое является уникальным в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1134">The name for the queue, which is unique on the network.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1135"><xref:System.Messaging.MessageQueue.FormatName%2A> Свойство содержит имя формата очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1135">The <xref:System.Messaging.MessageQueue.FormatName%2A> property contains the format name of the queue.</span></span> <span data-ttu-id="51fc7-1136">Служба Message Queuing использует имя формата для определения открываемой очереди и способа доступа к ней.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1136">Message Queuing uses the format name to identify which queue to open and how to access it.</span></span> <span data-ttu-id="51fc7-1137">В отличие от большинства характеристик очереди имя формата не свойством очереди приложения Message Queuing, поэтому они недоступны через средство управления очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1137">Unlike most of a queue's characteristics, the format name is not a Message Queuing application queue property, so you cannot access it through the Message Queuing management tool.</span></span> <span data-ttu-id="51fc7-1138">Имя формата — это уникальное имя для очереди, который создается службой Message Queuing при создании очереди или создается приложением позднее.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1138">The format name is simply a unique name for the queue, which Message Queuing generates when it creates the queue or which the application generates later.</span></span>  
  
 <span data-ttu-id="51fc7-1139">При указании пути, используя синтаксис имени пути (например, `myComputer\myQueue`) вместо того чтобы использовать синтаксис имени формата при чтении или записи в очередь, основной контроллер домена (с использованием Active Directory) преобразует <xref:System.Messaging.MessageQueue.Path%2A> в связанных <xref:System.Messaging.MessageQueue.FormatName%2A> перед получением доступа к очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1139">If you specify a path using the path name syntax (such as `myComputer\myQueue`) rather than using the format name syntax when you read or write to the queue, the primary domain controller (which uses Active Directory) translates the <xref:System.Messaging.MessageQueue.Path%2A> into the associated <xref:System.Messaging.MessageQueue.FormatName%2A> before accessing the queue.</span></span> <span data-ttu-id="51fc7-1140">Если приложение работает в автономном режиме, необходимо использовать синтаксис имени формата; в противном случае основной контроллер домена будет недоступен для выполнения преобразования путь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1140">If your application is working offline, you must use the format name syntax; otherwise, the primary domain controller will not be available to perform the path translation.</span></span>  
  
 <span data-ttu-id="51fc7-1141">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1141">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1142">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1142">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1143">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1143">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1144">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1144">Local computer</span></span>|<span data-ttu-id="51fc7-1145">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1145">Yes</span></span>|  
|<span data-ttu-id="51fc7-1146">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1146">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1147">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1147">Yes</span></span>|  
|<span data-ttu-id="51fc7-1148">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1148">Remote computer</span></span>|<span data-ttu-id="51fc7-1149">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1149">Yes</span></span>|  
|<span data-ttu-id="51fc7-1150">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1150">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1151">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1151">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1152">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.FormatName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1152">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.FormatName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1153"><see cref="P:System.Messaging.MessageQueue.Path" /> не указывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1153">The <see cref="P:System.Messaging.MessageQueue.Path" /> is not set.</span></span>  
  
 <span data-ttu-id="51fc7-1154">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-1154">-or-</span></span>  
  
 <span data-ttu-id="51fc7-1155">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1155">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="T:System.Messaging.MessageQueue" />
      </Docs>
    </Member>
    <Member MemberName="Formatter">
      <MemberSignature Language="C#" Value="public System.Messaging.IMessageFormatter Formatter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.IMessageFormatter Formatter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Formatter" />
      <MemberSignature Language="VB.NET" Value="Public Property Formatter As IMessageFormatter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::IMessageFormatter ^ Formatter { System::Messaging::IMessageFormatter ^ get(); void set(System::Messaging::IMessageFormatter ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter(typeof(System.Messaging.Design.MessageFormatterConverter))</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Formatter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.IMessageFormatter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1156">Получает или задает модуль форматирования, используемый для сериализации объекта в текст сообщения или десериализации из текста сообщения, прочитанного из очереди или записанного в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1156">Gets or sets the formatter used to serialize an object into or deserialize an object from the body of a message read from or written to the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1157">Объект <see cref="T:System.Messaging.IMessageFormatter" />, создающий поток, записываемый в текст сообщения или считываемый из него.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1157">The <see cref="T:System.Messaging.IMessageFormatter" /> that produces a stream to be written to or read from the message body.</span></span> <span data-ttu-id="51fc7-1158">Значение по умолчанию: <see cref="T:System.Messaging.XmlMessageFormatter" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1158">The default is <see cref="T:System.Messaging.XmlMessageFormatter" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1159"><xref:System.Messaging.MessageQueue.Formatter%2A> Свойство содержит экземпляр объекта модуля форматирования, который преобразует сообщения, когда приложение считывает или записывает в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1159">The <xref:System.Messaging.MessageQueue.Formatter%2A> property contains an instance of a formatter object, which transforms messages when your application reads or writes to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1160">Когда приложение отправляет сообщение в очередь, модуль форматирования сериализует объект в поток и вставляет его в тело сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1160">When the application sends message to the queue, the formatter serializes the object into a stream and inserts it into the message body.</span></span> <span data-ttu-id="51fc7-1161">При чтении из очереди форматер десериализует данные из <xref:System.Messaging.Message.Body%2A> свойство <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1161">When reading from a queue, the formatter deserializes the message data into the <xref:System.Messaging.Message.Body%2A> property of a <xref:System.Messaging.Message>.</span></span>  
  
 <span data-ttu-id="51fc7-1162"><xref:System.Messaging.XmlMessageFormatter> Слабо связанный, поэтому нет необходимости иметь объект того же типа на отправителя и получателя, при применении этого формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1162">The <xref:System.Messaging.XmlMessageFormatter> is loosely coupled, so it is not necessary to have the same object type on the sender and receiver when using this format.</span></span> <span data-ttu-id="51fc7-1163"><xref:System.Messaging.ActiveXMessageFormatter> И <xref:System.Messaging.BinaryMessageFormatter> сериализации данных в двоичное представление.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1163">The <xref:System.Messaging.ActiveXMessageFormatter> and <xref:System.Messaging.BinaryMessageFormatter> serialize the data into binary representation.</span></span> <span data-ttu-id="51fc7-1164"><xref:System.Messaging.ActiveXMessageFormatter> Используется при отправке и получении COM-компонентов.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1164">The <xref:System.Messaging.ActiveXMessageFormatter> is used when sending or receiving COM components.</span></span>  
  
 <span data-ttu-id="51fc7-1165"><xref:System.Messaging.BinaryMessageFormatter> и <xref:System.Messaging.ActiveXMessageFormatter> обеспечивают более высокую производительность, чем <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1165"><xref:System.Messaging.BinaryMessageFormatter> and <xref:System.Messaging.ActiveXMessageFormatter> provide faster throughput than the <xref:System.Messaging.XmlMessageFormatter>.</span></span> <span data-ttu-id="51fc7-1166"><xref:System.Messaging.ActiveXMessageFormatter> Обеспечивает возможность взаимодействия с приложениями очереди сообщений Visual Basic 6.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1166">The <xref:System.Messaging.ActiveXMessageFormatter> allows interoperability with Visual Basic 6.0 Message Queuing applications.</span></span>  
  
 <span data-ttu-id="51fc7-1167">Когда приложение отправляет сообщения в очередь <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> применяется только для тех сообщений, которые используются свойства сообщения по умолчанию <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1167">When your application sends messages to the queue, the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> applies only to those messages that use the default message properties, <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>.</span></span> <span data-ttu-id="51fc7-1168">При отправке <xref:System.Messaging.Message> для очереди, очереди сообщений использует модуль форматирования, определенные в <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> свойства вместо сериализации текста сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1168">If you send a <xref:System.Messaging.Message> to the queue, Message Queuing uses the formatter defined in the <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property to serialize the body instead.</span></span>  
  
 <span data-ttu-id="51fc7-1169"><xref:System.Messaging.MessageQueue> Всегда будет использоваться классом <xref:System.Messaging.Message> для получения и просмотра сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1169">The <xref:System.Messaging.MessageQueue> class will always use a <xref:System.Messaging.Message> to receive or peek a message from the queue.</span></span> <span data-ttu-id="51fc7-1170">Сообщение сериализуется с помощью <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1170">The message is deserialized using the <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-1171">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1171">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1172">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1172">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1173">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1173">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1174">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1174">Local computer</span></span>|<span data-ttu-id="51fc7-1175">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1175">Yes</span></span>|  
|<span data-ttu-id="51fc7-1176">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1176">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1177">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1177">Yes</span></span>|  
|<span data-ttu-id="51fc7-1178">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1178">Remote computer</span></span>|<span data-ttu-id="51fc7-1179">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1179">No</span></span>|  
|<span data-ttu-id="51fc7-1180">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1180">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1181">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1181">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1182">В следующем примере кода демонстрируется, форматирование текста сообщения с помощью <xref:System.Messaging.BinaryMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1182">The following code example demonstrates formatting a message body using <xref:System.Messaging.BinaryMessageFormatter>.</span></span>  
  
 [!code-cpp[MessagingBinaryFormatter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessagingBinaryFormatter/CPP/message_binaryformatter.cpp#1)]
 [!code-csharp[MessagingBinaryFormatter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessagingBinaryFormatter/CS/message_binaryformatter.cs#1)]
 [!code-vb[MessagingBinaryFormatter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessagingBinaryFormatter/VB/message_binaryformatter.vb#1)]  
  
 <span data-ttu-id="51fc7-1183">В следующем примере кода демонстрируется, форматирование текста сообщения с помощью <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1183">The following code example demonstrates formatting a message body using <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 [!code-cpp[Message.Body#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Body/CPP/message_sendreceive.cpp#1)]
 [!code-csharp[Message.Body#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Body/CS/message_sendreceive.cs#1)]
 [!code-vb[Message.Body#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Body/VB/message_sendreceive.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Messaging.XmlMessageFormatter" />
        <altmember cref="T:System.Messaging.ActiveXMessageFormatter" />
        <altmember cref="T:System.Messaging.BinaryMessageFormatter" />
        <altmember cref="P:System.Messaging.Message.Formatter" />
      </Docs>
    </Member>
    <Member MemberName="GetAllMessages">
      <MemberSignature Language="C#" Value="public System.Messaging.Message[] GetAllMessages ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message[] GetAllMessages() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetAllMessages" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllMessages () As Message()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Messaging::Message ^&gt; ^ GetAllMessages();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1184">Возвращает все сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1184">Returns all the messages that are in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1185">Массив типа <see cref="T:System.Messaging.Message" />, который представляет все сообщения очереди в том же порядке, в каком они располагаются в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1185">An array of type <see cref="T:System.Messaging.Message" /> that represents all the messages in the queue, in the same order as they appear in the Message Queuing queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Возвращает статический снимок сообщений в очереди, не динамические ссылки на эти сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1186"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a static snapshot of the messages in the queue, not dynamic links to those messages.</span></span> <span data-ttu-id="51fc7-1187">Таким образом массив нельзя использовать для изменения сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1187">Therefore, you cannot use the array to modify the messages in the queue.</span></span> <span data-ttu-id="51fc7-1188">Если требуется, чтобы в режиме реального времени, динамическое взаимодействие с очередью (например, возможность удаления сообщений), вызовите <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> метод, который возвращает динамический список сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1188">If you want real-time, dynamic interaction with the queue (such as the ability to delete messages), call the <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> method, which returns a dynamic list of the messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1189">Поскольку <xref:System.Messaging.MessageQueue.GetAllMessages%2A> возвращает копию сообщения в очереди на момент вызова метода, массив не отражает новые сообщения, поступающие в очередь или сообщений, удаленных из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1189">Because <xref:System.Messaging.MessageQueue.GetAllMessages%2A> returns a copy of the messages in the queue at the time the method was called, the array does not reflect new messages that arrive in the queue or messages that are removed from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> Получает только свойства, не отфильтрованные <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1190"><xref:System.Messaging.MessageQueue.GetAllMessages%2A> retrieves only those properties not filtered out by the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span>  
  
 <span data-ttu-id="51fc7-1191">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1191">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1192">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1192">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1193">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1193">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1194">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1194">Local computer</span></span>|<span data-ttu-id="51fc7-1195">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1195">Yes</span></span>|  
|<span data-ttu-id="51fc7-1196">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1196">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1197">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1197">Yes</span></span>|  
|<span data-ttu-id="51fc7-1198">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1198">Remote computer</span></span>|<span data-ttu-id="51fc7-1199">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1199">No</span></span>|  
|<span data-ttu-id="51fc7-1200">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1200">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1201">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1201">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1202">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1202">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#21](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#21)]
 [!code-csharp[MessageQueue2#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1203">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1203">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetEnumerator">
      <MemberSignature Language="C#" Value="public System.Collections.IEnumerator GetEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance class System.Collections.IEnumerator GetEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetEnumerator () As IEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual System::Collections::IEnumerator ^ GetEnumerator();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.Collections.IEnumerable.GetEnumerator</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Collections.IEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1204">Перечисляет сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1204">Enumerates the messages in a queue.</span></span> <span data-ttu-id="51fc7-1205">Параметр <see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1205"><see cref="M:System.Messaging.MessageQueue.GetEnumerator" /> is deprecated.</span></span> <span data-ttu-id="51fc7-1206">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1206"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1207">Объект <see cref="T:System.Collections.IEnumerator" />, обеспечивающий динамическое подключение к сообщениям очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1207">A <see cref="T:System.Collections.IEnumerator" /> that provides a dynamic connection to the messages in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1208">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1208">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1209">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1209">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1210">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1210">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1211">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1211">Local computer</span></span>|<span data-ttu-id="51fc7-1212">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1212">Yes</span></span>|  
|<span data-ttu-id="51fc7-1213">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1213">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1214">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1214">Yes</span></span>|  
|<span data-ttu-id="51fc7-1215">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1215">Remote computer</span></span>|<span data-ttu-id="51fc7-1216">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1216">No</span></span>|  
|<span data-ttu-id="51fc7-1217">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1217">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1218">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1218">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1219">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1219">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.GetEnumerator%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#22](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#22)]
 [!code-csharp[MessageQueue2#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMachineId">
      <MemberSignature Language="C#" Value="public static Guid GetMachineId (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig valuetype System.Guid GetMachineId(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMachineId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMachineId (machineName As String) As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static Guid GetMachineId(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="51fc7-1220">Имя компьютера, на котором расположена очередь, без двух обратных косых черт (\\\\) в начале.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1220">The name of the computer that contains the queue, without the two preceding backslashes (\\\\).</span></span></param>
        <summary><span data-ttu-id="51fc7-1221">Получает идентификатор компьютера, на котором расположена очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1221">Gets the identifier of the computer on which the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> is located.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1222">Объект <see cref="T:System.Guid" />, который представляет уникальный идентификатор компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1222">A <see cref="T:System.Guid" /> that represents a unique identifier for the computer on which the queue is located.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1223">Идентификатор компьютера можно использовать для двух целей, в частности: для чтения журнала компьютера и задания сертификатов безопасности.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1223">You can use a computer's identifier for two purposes, among others: to read the computer journal and to set security certificates.</span></span> <span data-ttu-id="51fc7-1224">Тем не менее, не может вызвать <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> на удаленном компьютере, при работе вне сети, так как оно должно иметь доступ к службе каталогов на контроллере домена.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1224">However, you cannot call <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29> for a remote computer when you are working offline because the application must have access to the directory service on the domain controller.</span></span>  
  
 <span data-ttu-id="51fc7-1225">Идентификатор компьютера (или идентификаторы компьютеров) является <xref:System.Guid> , служба Message Queuing создает при добавлении компьютера в среде предприятия.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1225">The computer identifier (or machine identifier) is a <xref:System.Guid> that Message Queuing creates when a computer is added to the enterprise.</span></span> <span data-ttu-id="51fc7-1226">Служба Message Queuing объединяет идентификатор компьютера с `Machine` и `Journal` ключевые слова, чтобы создать журнал компьютера формат имени, которое имеет синтаксис `Machine=<computeridentifier>;Journal`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1226">Message Queuing combines the computer identifier with the `Machine` and `Journal` keywords to create the machine journal's format name, which has the syntax `Machine=<computeridentifier>;Journal`.</span></span> <span data-ttu-id="51fc7-1227">Журнал компьютера, который также известен как очередь журнала, является очередь системы, в которой хранятся копии создаваемые приложением сообщения, когда <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойство `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1227">The machine journal, which is also known as the journal queue, is a system queue that stores copies of application-generated messages when the <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property is `true`.</span></span>  
  
 <span data-ttu-id="51fc7-1228">Этот синтаксис журнала является допустимым только при создании имени формата очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1228">This syntax for the journal is only valid when constructing the format name for the queue.</span></span> <span data-ttu-id="51fc7-1229">Синтаксис имени пути `MachineName` \\ `Journal$`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1229">The path name syntax is `MachineName`\\`Journal$`.</span></span>  
  
 <span data-ttu-id="51fc7-1230">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1230">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1231">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1231">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1232">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1232">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1233">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1233">Local computer</span></span>|<span data-ttu-id="51fc7-1234">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1234">No</span></span>|  
|<span data-ttu-id="51fc7-1235">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1235">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1236">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1236">No</span></span>|  
|<span data-ttu-id="51fc7-1237">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1237">Remote computer</span></span>|<span data-ttu-id="51fc7-1238">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1238">No</span></span>|  
|<span data-ttu-id="51fc7-1239">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1239">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1240">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1240">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1241">В приведенном ниже примере кода вызывается <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1241">The following code example calls <xref:System.Messaging.MessageQueue.GetMachineId%28System.String%29>.</span></span>  
  
 [!code-csharp[MessageQueue#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1242">Не удается извлечь идентификатор компьютера. Возможной причиной может быть недоступность службы каталогов: например, при работе в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1242">The computer identifier could not be retrieved, possibly because the directory service is not available; for example, if you are working offline.</span></span>  
  
 <span data-ttu-id="51fc7-1243">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-1243">-or-</span></span>  
  
 <span data-ttu-id="51fc7-1244">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1244">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1245">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1245">Creates an enumerator object for all the messages in the queue.</span></span> <span data-ttu-id="51fc7-1246">Параметр <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> использовать не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1246"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator" /> is deprecated.</span></span> <span data-ttu-id="51fc7-1247">Вместо него следует использовать метод <see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1247"><see cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" /> should be used instead.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1248">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1248">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> Создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1249"><xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="51fc7-1250">Можно удалить из очереди сообщений в текущей позиции перечислителя в путем вызова <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> для <xref:System.Messaging.MessageEnumerator> , <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1250">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator%2A> returns.</span></span>  
  
 <span data-ttu-id="51fc7-1251">Поскольку курсор связан с динамическим списком сообщений в очереди, перечисление отражает все изменения, внесенные в сообщения в очереди, если сообщение находится за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1251">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="51fc7-1252">Например перечислитель может автоматически получить доступ к сообщению с более низким приоритетом, размещенному за текущей позицией курсора, но не более высокий приоритет сообщения вставлена до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1252">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="51fc7-1253">Тем не менее, вы можете сбросить перечисления, тем самым наведя курсор назад в начало списка, путем вызова <xref:System.Messaging.MessageEnumerator.Reset%2A> для <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1253">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="51fc7-1254">Порядок сообщений в перечислении отражает их порядок в очереди, поэтому появятся сообщения с более высоким приоритетом перед более низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1254">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="51fc7-1255">Если требуется статический снимок сообщений в очереди, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1255">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="51fc7-1256">Этот метод возвращает массив <xref:System.Messaging.Message> объектов, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1256">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="51fc7-1257">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1257">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1258">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1258">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1259">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1259">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1260">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1260">Local computer</span></span>|<span data-ttu-id="51fc7-1261">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1261">Yes</span></span>|  
|<span data-ttu-id="51fc7-1262">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1262">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1263">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1263">Yes</span></span>|  
|<span data-ttu-id="51fc7-1264">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1264">Remote computer</span></span>|<span data-ttu-id="51fc7-1265">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1265">Yes</span></span>|  
|<span data-ttu-id="51fc7-1266">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1266">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1267">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1267">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1268">В следующем примере кода возвращает динамический список сообщений в очереди и пересчет всех сообщений <xref:System.Messaging.Message.Priority%2A> свойство <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1268">The following code example gets a dynamic list of messages in a queue and counts all messages with the <xref:System.Messaging.Message.Priority%2A> property set to <xref:System.Messaging.MessagePriority.Lowest?displayProperty=nameWithType>.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CPP/mqgetmessageenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/CS/mqgetmessageenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageEnumerator#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageEnumerator/VB/mqgetmessageenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageEnumerator2">
      <MemberSignature Language="C#" Value="public System.Messaging.MessageEnumerator GetMessageEnumerator2 ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.MessageEnumerator GetMessageEnumerator2() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      <MemberSignature Language="VB.NET" Value="Public Function GetMessageEnumerator2 () As MessageEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::MessageEnumerator ^ GetMessageEnumerator2();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1269">Создает объект перечислителя для всех сообщений очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1269">Creates an enumerator object for all the messages in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1270">Объект <see cref="T:System.Messaging.MessageEnumerator" /> содержащий сообщения, которые находятся в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1270">The <see cref="T:System.Messaging.MessageEnumerator" /> holding the messages that are contained in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> Создает динамический список всех сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1271"><xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> creates a dynamic list of all the messages in a queue.</span></span> <span data-ttu-id="51fc7-1272">Можно удалить из очереди сообщений в текущей позиции перечислителя в путем вызова <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> для <xref:System.Messaging.MessageEnumerator> , <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> возвращает.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1272">You can remove from the queue the message at the enumerator's current position by calling <xref:System.Messaging.MessageEnumerator.RemoveCurrent%2A> for the <xref:System.Messaging.MessageEnumerator> that <xref:System.Messaging.MessageQueue.GetMessageEnumerator2%2A> returns.</span></span>  
  
 <span data-ttu-id="51fc7-1273">Поскольку курсор связан с динамическим списком сообщений в очереди, перечисление отражает все изменения, внесенные в сообщения в очереди, если сообщение находится за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1273">Because the cursor is associated with the dynamic list of messages in the queue, the enumeration reflects any modification you make to the messages in the queue, if the message is beyond the current cursor position.</span></span> <span data-ttu-id="51fc7-1274">Например перечислитель может автоматически получить доступ к сообщению с более низким приоритетом, размещенному за текущей позицией курсора, но не более высокий приоритет сообщения вставлена до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1274">For example, the enumerator can automatically access a lower-priority message placed beyond the cursor's current position, but not a higher-priority message inserted before that position.</span></span> <span data-ttu-id="51fc7-1275">Тем не менее, вы можете сбросить перечисления, тем самым наведя курсор назад в начало списка, путем вызова <xref:System.Messaging.MessageEnumerator.Reset%2A> для <xref:System.Messaging.MessageEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1275">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageEnumerator.Reset%2A> for the <xref:System.Messaging.MessageEnumerator>.</span></span>  
  
 <span data-ttu-id="51fc7-1276">Порядок сообщений в перечислении отражает их порядок в очереди, поэтому появятся сообщения с более высоким приоритетом перед более низким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1276">The order of the messages in the enumeration reflects their order in the queue, so higher-priority messages will appear before lower-priority ones.</span></span>  
  
 <span data-ttu-id="51fc7-1277">Если требуется статический снимок сообщений в очереди, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1277">If you want a static snapshot of the messages in the queue rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetAllMessages%2A>.</span></span> <span data-ttu-id="51fc7-1278">Этот метод возвращает массив <xref:System.Messaging.Message> объектов, которые представляют сообщения на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1278">This method returns an array of <xref:System.Messaging.Message> objects, which represent the messages at the time the method was called.</span></span>  
  
 <span data-ttu-id="51fc7-1279">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1279">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1280">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1280">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1281">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1281">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1282">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1282">Local computer</span></span>|<span data-ttu-id="51fc7-1283">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1283">Yes</span></span>|  
|<span data-ttu-id="51fc7-1284">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1284">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1285">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1285">Yes</span></span>|  
|<span data-ttu-id="51fc7-1286">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1286">Remote computer</span></span>|<span data-ttu-id="51fc7-1287">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1287">Yes</span></span>|  
|<span data-ttu-id="51fc7-1288">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1288">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1289">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1289">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetAllMessages" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetMessageQueueEnumerator">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-1290">Создает объект перечислителя для динамического списка общих очередей сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1290">Creates an enumerator object for a dynamic listing of the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator () As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1291">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1291">Provides forward-only cursor semantics to enumerate through all public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1292">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление всех общих очередей сообщений в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1292">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of all the public message queues on the network.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1293">Эта перегрузка <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращает перечисление общих очередей, которые находятся в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1293">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns an enumeration of all the public queues that are on the network.</span></span>  
  
 <span data-ttu-id="51fc7-1294">Поскольку курсор связан с динамическим перечислением, перечисление отражаются все изменения, внесенные в список очередей удалены или добавлены за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1294">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue list for queues deleted or added beyond the cursor's current position.</span></span> <span data-ttu-id="51fc7-1295">Добавление и удаление очередей, расположенных до текущей позиции курсора, не отражаются.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1295">Additions or deletion of queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="51fc7-1296">Например перечислитель позволяет автоматически обращаться к очереди, добавленной за позицией курсора, но не вставлена до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1296">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="51fc7-1297">Тем не менее, вы можете сбросить перечисления, тем самым наведя курсор назад в начало списка, путем вызова <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> для <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1297">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="51fc7-1298">Нет, не определен порядок очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1298">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="51fc7-1299">Перечислитель не упорядочивает их по компьютера, метки, открытые или закрытые состояния или любому другому доступному критерию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1299">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="51fc7-1300">Если требуется статический снимок очередей в сети, а не динамическое подключение к ним, вызовите <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1300">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, call <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="51fc7-1301">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объектов, которые представлены очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1301">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span>  
  
 <span data-ttu-id="51fc7-1302">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1303">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1303">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1304">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1305">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1305">Local computer</span></span>|<span data-ttu-id="51fc7-1306">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1306">No</span></span>|  
|<span data-ttu-id="51fc7-1307">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1307">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1308">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1308">No</span></span>|  
|<span data-ttu-id="51fc7-1309">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1309">Remote computer</span></span>|<span data-ttu-id="51fc7-1310">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1310">No</span></span>|  
|<span data-ttu-id="51fc7-1311">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1311">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1312">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1313">В следующем примере кода выполняется итерация по всем очередям сообщений в сети и исследуются пути каждой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1313">The following code example iterates through all the message queues in the network, and examines the path for each queue.</span></span> <span data-ttu-id="51fc7-1314">Наконец он отображает число общих очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1314">Finally, it displays the number of public queues on the network.</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CPP/mqgetmessagequeueenumerator.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/CS/mqgetmessagequeueenumerator.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_noparms/VB/mqgetmessagequeueenumerator.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetMessageQueueEnumerator">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueueEnumerator GetMessageQueueEnumerator(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetMessageQueueEnumerator (criteria As MessageQueueCriteria) As MessageQueueEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::MessageQueueEnumerator ^ GetMessageQueueEnumerator(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueueEnumerator</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="51fc7-1315">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации доступных очередей сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1315">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the available message queues.</span></span></param>
        <summary><span data-ttu-id="51fc7-1316">Обеспечивает семантику курсора последовательного доступа для перечисления во всех общих очередях сети, удовлетворяющих указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1316">Provides forward-only cursor semantics to enumerate through all public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1317">Объект <see cref="T:System.Messaging.MessageQueueEnumerator" />, обеспечивающий динамическое перечисление общих очередей сообщений сети, удовлетворяющих ограничениям, заданным параметром <paramref name="criteria" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1317">A <see cref="T:System.Messaging.MessageQueueEnumerator" /> that provides a dynamic listing of the public message queues on the network that satisfy the restrictions specified by the <paramref name="criteria" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1318">Эта перегрузка <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> возвращает список всех общих очередей в сети, которые удовлетворяют критериям, заданным в критериях приложения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1318">This overload of <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A> returns a listing of all the public queues on the network that satisfy criteria defined in the application criteria.</span></span> <span data-ttu-id="51fc7-1319">Можно указать критерии, которые включают, например, очереди, время создания или изменения, имя компьютера, метки, категории или любое сочетание этих.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1319">You can specify the criteria to include, for example, queue creation or modification time, computer name, label, category, or any combination of these.</span></span>  
  
 <span data-ttu-id="51fc7-1320">Поскольку курсор связан с динамическим перечислением, перечисление отражаются все изменения, вносимые в очередь, находящихся за текущей позицией курсора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1320">Because the cursor is associated with a dynamic listing, the enumeration reflects any modification you make to a queue that occurs beyond the cursor's current position.</span></span> <span data-ttu-id="51fc7-1321">Изменение очередей, расположенных до текущей позиции курсора, не отражаются.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1321">Changes to queues located before the cursor's current position are not reflected.</span></span> <span data-ttu-id="51fc7-1322">Например перечислитель позволяет автоматически обращаться к очереди, добавленной за позицией курсора, но не вставлена до этой позиции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1322">For example, the enumerator can automatically access a queue appended beyond the cursor position but not one inserted before that position.</span></span> <span data-ttu-id="51fc7-1323">Тем не менее, вы можете сбросить перечисления, тем самым наведя курсор назад в начало списка, путем вызова <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> для <xref:System.Messaging.MessageQueueEnumerator>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1323">However, you can reset the enumeration, thereby moving the cursor back to the beginning of the list, by calling <xref:System.Messaging.MessageQueueEnumerator.Reset%2A> for the <xref:System.Messaging.MessageQueueEnumerator>.</span></span>  
  
 <span data-ttu-id="51fc7-1324">Нет, не определен порядок очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1324">There is no defined ordering of queues in a network.</span></span> <span data-ttu-id="51fc7-1325">Перечислитель не упорядочивает их по компьютера, метки, открытые или закрытые состояния или любому другому доступному критерию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1325">An enumerator does not order them, for example, by computer, label, public or private status, or any other accessible criteria.</span></span>  
  
 <span data-ttu-id="51fc7-1326">Статический снимок очередей в сети, а не динамическое подключение к ним, укажите критерии для <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> или вызвать <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1326">If you want a static snapshot of the queues on the network rather than a dynamic connection to them, specify criteria for <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> or call <xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29>.</span></span> <span data-ttu-id="51fc7-1327">Каждый из этих двух методов возвращает массив <xref:System.Messaging.MessageQueue> объектов, которые представлены очереди на момент вызова метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1327">Each of these two methods returns an array of <xref:System.Messaging.MessageQueue> objects, which represent the queues at the time the method was called.</span></span> <span data-ttu-id="51fc7-1328">Вызов <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, или <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> дает тот же результат, что и вызов метода <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> с критериями фильтра свойств <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, и <xref:System.Messaging.MessageQueue.MachineName%2A>соответственно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1328">Calling <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> provides the same results as calling <xref:System.Messaging.MessageQueue.GetPublicQueues%2A> with the filtering criteria of <xref:System.Messaging.MessageQueue.Category%2A>, <xref:System.Messaging.MessageQueue.Label%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>, respectively.</span></span>  
  
 <span data-ttu-id="51fc7-1329">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1329">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1330">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1330">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1331">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1331">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1332">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1332">Local computer</span></span>|<span data-ttu-id="51fc7-1333">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1333">No</span></span>|  
|<span data-ttu-id="51fc7-1334">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1334">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1335">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1335">No</span></span>|  
|<span data-ttu-id="51fc7-1336">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1336">Remote computer</span></span>|<span data-ttu-id="51fc7-1337">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1337">No</span></span>|  
|<span data-ttu-id="51fc7-1338">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1338">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1339">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1339">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1340">В следующем примере кода выполняется итерация по очереди сообщений и отображаются пути всех очередей сообщений, созданных за последний день и который существует на компьютере «Мойкомпьютер».</span><span class="sxs-lookup"><span data-stu-id="51fc7-1340">The following code example iterates through message queues and displays the path of each queue that was created in the last day and that exists on the computer "MyComputer".</span></span>  
  
 [!code-cpp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CPP/mqgetmessagequeueenumerator_criteria.cpp#1)]
 [!code-csharp[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/CS/mqgetmessagequeueenumerator_criteria.cs#1)]
 [!code-vb[MessageQueue.GetMessageQueueEnumerator_criteria#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetMessageQueueEnumerator_criteria/VB/mqgetmessagequeueenumerator_criteria.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageEnumerator2" />
      </Docs>
    </Member>
    <Member MemberName="GetPrivateQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPrivateQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPrivateQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPrivateQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPrivateQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPrivateQueuesByMachine(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="51fc7-1341">Компьютер, из которого извлекаются частные очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1341">The computer from which to retrieve the private queues.</span></span></param>
        <summary><span data-ttu-id="51fc7-1342">Извлекает все частные очереди на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1342">Retrieves all the private queues on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1343">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные частные очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1343">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved private queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> Извлекает статический снимок очередей на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1344"><xref:System.Messaging.MessageQueue.GetPrivateQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues on a specified computer.</span></span>  
  
 <span data-ttu-id="51fc7-1345">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1345">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1346">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1346">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1347">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1347">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1348">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1348">Local computer</span></span>|<span data-ttu-id="51fc7-1349">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1349">Yes</span></span>|  
|<span data-ttu-id="51fc7-1350">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1350">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1351">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1351">Yes</span></span>|  
|<span data-ttu-id="51fc7-1352">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1352">Remote computer</span></span>|<span data-ttu-id="51fc7-1353">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1353">Yes</span></span>|  
|<span data-ttu-id="51fc7-1354">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1354">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1355">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1355">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1356">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1356">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1357">Значение параметра <paramref name="machineName" /> — <see langword="null" /> или пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="51fc7-1357">The <paramref name="machineName" /> parameter is <see langword="null" /> or an empty string ("").</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1358">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1358">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetPublicQueues">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-1359">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1359">Retrieves all the public queues on the network.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues () As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1360">Извлекает все общие очереди сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1360">Retrieves all the public queues on the network.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1361">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1361">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1362">Используйте этот перегруженный метод, если требуется полный список всех общих очередей в сети.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1362">Use this overload if you want a complete list of all the public queues on the network.</span></span> <span data-ttu-id="51fc7-1363">Если вы хотите ограничить список по определенным критериям, такие как <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, или время последнего изменения используйте другую перегрузку этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1363">If you want to restrict the list by certain criteria, such as <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, or last modified time use another overload of this method.</span></span> <span data-ttu-id="51fc7-1364">(Кроме того, можно использовать <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, или <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span><span class="sxs-lookup"><span data-stu-id="51fc7-1364">(Alternatively, you can use <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, or <xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>.)</span></span>  
  
 <span data-ttu-id="51fc7-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1365"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="51fc7-1366">Для взаимодействия с динамический список очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1366">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-1367">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1367">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1368">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1368">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1369">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1369">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1370">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1370">Local computer</span></span>|<span data-ttu-id="51fc7-1371">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1371">No</span></span>|  
|<span data-ttu-id="51fc7-1372">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1372">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1373">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1373">No</span></span>|  
|<span data-ttu-id="51fc7-1374">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1374">Remote computer</span></span>|<span data-ttu-id="51fc7-1375">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1375">No</span></span>|  
|<span data-ttu-id="51fc7-1376">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1376">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1377">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1377">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1378">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1378">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1379">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1379">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueues">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueues (System.Messaging.MessageQueueCriteria criteria);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueues(class System.Messaging.MessageQueueCriteria criteria) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueues(System.Messaging.MessageQueueCriteria)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueues (criteria As MessageQueueCriteria) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueues(System::Messaging::MessageQueueCriteria ^ criteria);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="criteria" Type="System.Messaging.MessageQueueCriteria" />
      </Parameters>
      <Docs>
        <param name="criteria"><span data-ttu-id="51fc7-1380">Объект <see cref="T:System.Messaging.MessageQueueCriteria" />, содержащий критерии фильтрации очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1380">A <see cref="T:System.Messaging.MessageQueueCriteria" /> that contains the criteria used to filter the queues.</span></span></param>
        <summary><span data-ttu-id="51fc7-1381">Извлекает все общие очереди сети, удовлетворяющие указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1381">Retrieves all the public queues on the network that meet the specified criteria.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1382">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1382">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1383">Если требуется отфильтровать все общие очереди сети метки, категории или имя компьютера, <xref:System.Messaging.MessageQueue> класс содержит конкретные методы, которые предоставляют эти функциональные возможности (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, и <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>соответственно).</span><span class="sxs-lookup"><span data-stu-id="51fc7-1383">If you want to filter all the public queues on the network by label, category, or computer name, the <xref:System.Messaging.MessageQueue> class contains specific methods that provide that functionality (<xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29>, <xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29>, and <xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29>, respectively).</span></span> <span data-ttu-id="51fc7-1384">Используйте эту перегрузку, чтобы получить список всех общих очередей сети, удовлетворяющих более одного из этих критериев (например, если вы хотите указать метку и категорию).</span><span class="sxs-lookup"><span data-stu-id="51fc7-1384">Use this overload to get a list of all the public queues on the network that meet more than one of these criteria (for example, if you want to specify both a label and a category).</span></span> <span data-ttu-id="51fc7-1385">Можно также осуществлять фильтрацию по критериям сообщение отличный от <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, и <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1385">You can also filter by message criteria other than <xref:System.Messaging.MessageQueue.Label%2A>, <xref:System.Messaging.MessageQueue.Category%2A>, and <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="51fc7-1386">Например Эта перегрузка используется для фильтрации по времени последнего изменения очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1386">For example, you use this overload to filter by a queue's last-modified time.</span></span> <span data-ttu-id="51fc7-1387">Просто создайте новый экземпляр <xref:System.Messaging.MessageQueueCriteria> класса, задайте соответствующие свойства экземпляра и сделать этот экземпляр `criteria` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1387">Simply create a new instance of the <xref:System.Messaging.MessageQueueCriteria> class, set the appropriate properties in the instance, and pass the instance as the `criteria` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1388"><xref:System.Messaging.MessageQueue.GetPublicQueues%2A> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="51fc7-1389">Для взаимодействия с динамический список очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1389">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-1390">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1390">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1391">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1391">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1392">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1392">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1393">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1393">Local computer</span></span>|<span data-ttu-id="51fc7-1394">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1394">No</span></span>|  
|<span data-ttu-id="51fc7-1395">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1395">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1396">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1396">No</span></span>|  
|<span data-ttu-id="51fc7-1397">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1397">Remote computer</span></span>|<span data-ttu-id="51fc7-1398">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1398">No</span></span>|  
|<span data-ttu-id="51fc7-1399">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1399">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1400">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1400">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1401">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1401">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1402">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1402">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueCriteria" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByCategory">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByCategory (Guid category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByCategory(valuetype System.Guid category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByCategory(System.Guid)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByCategory (category As Guid) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByCategory(Guid category);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="category" Type="System.Guid" />
      </Parameters>
      <Docs>
        <param name="category"><span data-ttu-id="51fc7-1403">Класс <see cref="T:System.Guid" />, который группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1403">A <see cref="T:System.Guid" /> that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="51fc7-1404">Извлекает все общие очереди сети, принадлежащие к указанной категории.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1404">Retrieves all the public queues on the network that belong to the specified category.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1405">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1405">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1406">Используйте этот метод для фильтрации общих очередей по категории.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1406">Use this method to filter the public queues by category.</span></span> <span data-ttu-id="51fc7-1407"><xref:System.Messaging.MessageQueue.Category%2A> Свойство предоставляет доступ к очереди сообщений типа свойства ID (который является чтение и запись) определенной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1407">The <xref:System.Messaging.MessageQueue.Category%2A> property provides access to the Message Queuing type ID property (which is read/write) of a particular queue.</span></span> <span data-ttu-id="51fc7-1408">Несмотря на то, что можно использовать <xref:System.Guid.NewGuid%2A> для создания значения категории, которое является уникальным для всех <xref:System.Guid> значения, нет необходимости.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1408">Although you can use <xref:System.Guid.NewGuid%2A> to create a category value that is unique across all <xref:System.Guid> values, it is not necessary.</span></span> <span data-ttu-id="51fc7-1409">Значение категории должно отличаться только от других категорий, а не от всех других <xref:System.Guid> значения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1409">The category value needs to be distinct only from other categories, not from all other <xref:System.Guid> values.</span></span> <span data-ttu-id="51fc7-1410">Например, можно назначить {00000000-0000-0000-0000-000000000001} как <xref:System.Messaging.MessageQueue.Category%2A> для одного набора очередей и {00000000-0000-0000-0000-000000000002} как <xref:System.Messaging.MessageQueue.Category%2A> для другого набора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1410">For example, you can assign {00000000-0000-0000-0000-000000000001} as the <xref:System.Messaging.MessageQueue.Category%2A> for one set of queues and {00000000-0000-0000-0000-000000000002} as the <xref:System.Messaging.MessageQueue.Category%2A> for another set.</span></span>  
  
 <span data-ttu-id="51fc7-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1411"><xref:System.Messaging.MessageQueue.GetPublicQueuesByCategory%28System.Guid%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="51fc7-1412">Для взаимодействия с динамический список очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1412">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="51fc7-1413">Можно указать категорию в рамках <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1413">You can specify the category as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="51fc7-1414">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1414">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1415">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1415">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1416">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1416">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1417">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1417">Local computer</span></span>|<span data-ttu-id="51fc7-1418">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1418">No</span></span>|  
|<span data-ttu-id="51fc7-1419">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1419">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1420">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1420">No</span></span>|  
|<span data-ttu-id="51fc7-1421">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1421">Remote computer</span></span>|<span data-ttu-id="51fc7-1422">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1422">No</span></span>|  
|<span data-ttu-id="51fc7-1423">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1423">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1424">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1424">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1425">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1425">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1426">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1426">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByLabel">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByLabel (string label);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByLabel(string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByLabel(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByLabel (label As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByLabel(System::String ^ label);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="label"><span data-ttu-id="51fc7-1427">Метка, которая группирует набор очередей для извлечения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1427">A label that groups the set of queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="51fc7-1428">Извлекает все общие очереди сети с указанной меткой.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1428">Retrieves all the public queues on the network that carry the specified label.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1429">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на извлеченные общие очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1429">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the retrieved public queues.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1430">Используйте этот метод для фильтрации общих очередей по метке.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1430">Use this method to filter the public queues by label.</span></span>  
  
 <span data-ttu-id="51fc7-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1431"><xref:System.Messaging.MessageQueue.GetPublicQueuesByLabel%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="51fc7-1432">Для взаимодействия с динамический список очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1432">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="51fc7-1433">Метки можно указать как часть <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1433">You can specify the label as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="51fc7-1434">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1434">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1435">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1435">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1436">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1436">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1437">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1437">Local computer</span></span>|<span data-ttu-id="51fc7-1438">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1438">No</span></span>|  
|<span data-ttu-id="51fc7-1439">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1439">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1440">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1440">No</span></span>|  
|<span data-ttu-id="51fc7-1441">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1441">Remote computer</span></span>|<span data-ttu-id="51fc7-1442">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1442">No</span></span>|  
|<span data-ttu-id="51fc7-1443">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1443">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1444">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1444">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1445">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1445">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1446">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1446">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1447">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1447">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetPublicQueuesByMachine">
      <MemberSignature Language="C#" Value="public static System.Messaging.MessageQueue[] GetPublicQueuesByMachine (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.MessageQueue[] GetPublicQueuesByMachine(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetPublicQueuesByMachine(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetPublicQueuesByMachine (machineName As String) As MessageQueue()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Messaging::MessageQueue ^&gt; ^ GetPublicQueuesByMachine(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.MessageQueue[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="51fc7-1448">Имя компьютера, на котором располагается набор извлекаемых общих очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1448">The name of the computer that contains the set of public queues to be retrieved.</span></span></param>
        <summary><span data-ttu-id="51fc7-1449">Извлекает все общие очереди, находящиеся на указанном компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1449">Retrieves all the public queues that reside on the specified computer.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1450">Массив объектов <see cref="T:System.Messaging.MessageQueue" />, ссылающихся на общие очереди, находящиеся на компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1450">An array of <see cref="T:System.Messaging.MessageQueue" /> objects that reference the public queues on the computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1451">Этот метод используется для фильтрации общих очередей на компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1451">Use this method to filter the public queues by computer.</span></span>  
  
 <span data-ttu-id="51fc7-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> Извлекает статический снимок очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1452"><xref:System.Messaging.MessageQueue.GetPublicQueuesByMachine%28System.String%29> retrieves a static snapshot of the queues.</span></span> <span data-ttu-id="51fc7-1453">Для взаимодействия с динамический список очередей, используйте <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1453">To interact with a dynamic list of the queues, use <xref:System.Messaging.MessageQueue.GetMessageQueueEnumerator%2A>.</span></span> <span data-ttu-id="51fc7-1454">Можно указать имя компьютера в рамках <xref:System.Messaging.MessageQueueCriteria> передачи в метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1454">You can specify the computer name as part of the <xref:System.Messaging.MessageQueueCriteria> you pass into the method.</span></span>  
  
 <span data-ttu-id="51fc7-1455">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1456">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1456">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1457">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1458">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1458">Local computer</span></span>|<span data-ttu-id="51fc7-1459">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1459">No</span></span>|  
|<span data-ttu-id="51fc7-1460">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1460">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1461">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1461">No</span></span>|  
|<span data-ttu-id="51fc7-1462">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1462">Remote computer</span></span>|<span data-ttu-id="51fc7-1463">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1463">No</span></span>|  
|<span data-ttu-id="51fc7-1464">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1464">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1465">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1465">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1466">В следующем примере извлекаются списки очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1466">The following code example retrieves lists of queues.</span></span>  
  
 [!code-cpp[MessageQueue.GetQueueLists#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CPP/mqgetqueuelists.cpp#1)]
 [!code-csharp[MessageQueue.GetQueueLists#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.GetQueueLists/CS/mqgetqueuelists.cs#1)]
 [!code-vb[MessageQueue.GetQueueLists#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.GetQueueLists/VB/mqgetqueuelists.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1467">Параметр <paramref name="machineName" /> имеет неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1467">The <paramref name="machineName" /> parameter has incorrect syntax.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1468">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1468">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="GetSecurityContext">
      <MemberSignature Language="C#" Value="public static System.Messaging.SecurityContext GetSecurityContext ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Messaging.SecurityContext GetSecurityContext() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.GetSecurityContext" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetSecurityContext () As SecurityContext" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Messaging::SecurityContext ^ GetSecurityContext();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.SecurityContext</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1469">Извлекает контекст безопасности, который служба MSMQ связывает с текущим пользователем (удостоверением потока) на момент этого вызова.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1469">Retrieves the security context that MSMQ associates with the current user (thread identity) at the time of this call.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1470">Объект <see cref="T:System.Messaging.SecurityContext" />, содержащий контекст безопасности.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1470">A <see cref="T:System.Messaging.SecurityContext" /> object that contains the security context.</span></span></returns>
        <remarks>To be added.</remarks>
        <altmember cref="P:System.Messaging.Message.SecurityContext" />
      </Docs>
    </Member>
    <Member MemberName="Id">
      <MemberSignature Language="C#" Value="public Guid Id { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Guid Id" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Id" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Id As Guid" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Guid Id { Guid get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_GuidId")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Guid</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1471">Получает уникальный идентификатор очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1471">Gets the unique Message Queuing identifier of the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1472">Свойство <see cref="P:System.Messaging.MessageQueue.Id" />, представляющее идентификатор сообщения, создаваемый приложением очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1472">A <see cref="P:System.Messaging.MessageQueue.Id" /> that represents the message identifier generated by the Message Queuing application.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1473">Message Queuing присваивает <xref:System.Messaging.MessageQueue.Id%2A> свойства при создании очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1473">Message Queuing sets the <xref:System.Messaging.MessageQueue.Id%2A> property when it creates the queue.</span></span> <span data-ttu-id="51fc7-1474">Это свойство доступно только для общих очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1474">This property is only available for public queues.</span></span>  
  
 <span data-ttu-id="51fc7-1475">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1475">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1476">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1476">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1477">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1477">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1478">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1478">Local computer</span></span>|<span data-ttu-id="51fc7-1479">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1479">Yes</span></span>|  
|<span data-ttu-id="51fc7-1480">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1480">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1481">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1481">Yes</span></span>|  
|<span data-ttu-id="51fc7-1482">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1482">Remote computer</span></span>|<span data-ttu-id="51fc7-1483">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1483">No</span></span>|  
|<span data-ttu-id="51fc7-1484">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1484">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1485">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1485">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1486">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.Id%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1486">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Id%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1487">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1487">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Category" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteQueueSize">
      <MemberSignature Language="C#" Value="public static readonly long InfiniteQueueSize;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly int64 InfiniteQueueSize" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteQueueSize As Long " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly long InfiniteQueueSize;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1488">Указывает, что для очереди нет ограничений по размеру.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1488">Specifies that no size restriction exists for a queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1489">Этот элемент часто используется при задании <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> или <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1489">This member is frequently used when setting <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> or <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1490">В следующем примере кода показано использование <xref:System.Messaging.MessageQueue.InfiniteQueueSize> член.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1490">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteQueueSize> member.</span></span>  
  
 [!code-csharp[MessageQueue#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="InfiniteTimeout">
      <MemberSignature Language="C#" Value="public static readonly TimeSpan InfiniteTimeout;" />
      <MemberSignature Language="ILAsm" Value=".field public static initonly valuetype System.TimeSpan InfiniteTimeout" />
      <MemberSignature Language="DocId" Value="F:System.Messaging.MessageQueue.InfiniteTimeout" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly InfiniteTimeout As TimeSpan " />
      <MemberSignature Language="C++ CLI" Value="public: static initonly TimeSpan InfiniteTimeout;" />
      <MemberType>Field</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.TimeSpan</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1491">Указывает, что для методов считывания и получения сообщений не существует тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1491">Specifies that no time-out exists for methods that peek or receive messages.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1492"><xref:System.Messaging.MessageQueue> поддерживает два типа методов извлечения сообщений: синхронные и асинхронные.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1492"><xref:System.Messaging.MessageQueue> supports two types of message retrieval: synchronous and asynchronous.</span></span> <span data-ttu-id="51fc7-1493">Синхронные методы <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.Receive%2A>, поток процесса указанный интервал времени для нового сообщения прибывают в очередь ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1493">The synchronous methods, <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.Receive%2A>, cause the process thread to wait a specified time interval for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1494">Если за указанный временной интервал <xref:System.Messaging.MessageQueue.InfiniteTimeout>, поток процесса остается заблокированных, пока не будет доступно новое сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1494">If the specified time interval is <xref:System.Messaging.MessageQueue.InfiniteTimeout>, the process thread remains blocked until a new message is available.</span></span> <span data-ttu-id="51fc7-1495">С другой стороны <xref:System.Messaging.MessageQueue.BeginPeek%2A> и <xref:System.Messaging.MessageQueue.BeginReceive%2A> (асинхронные методы), на выполнение задач основного приложения продолжают выполняться в отдельном потоке, до прибытия сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1495">On the other hand, <xref:System.Messaging.MessageQueue.BeginPeek%2A> and <xref:System.Messaging.MessageQueue.BeginReceive%2A> (the asynchronous methods), allow the main application tasks to continue in a separate thread until a message arrives in the queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1496">В следующем примере кода показано использование <xref:System.Messaging.MessageQueue.InfiniteTimeout> член.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1496">The following code example demonstrates the use of the <xref:System.Messaging.MessageQueue.InfiniteTimeout> member.</span></span>  
  
 [!code-csharp[MessageQueue#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Label">
      <MemberSignature Language="C#" Value="public string Label { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Label" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Label" />
      <MemberSignature Language="VB.NET" Value="Public Property Label As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Label { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Label")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1497">Получает или задает описание очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1497">Gets or sets the queue description.</span></span></summary>
        <value><span data-ttu-id="51fc7-1498">Метка очереди сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1498">The label for the message queue.</span></span> <span data-ttu-id="51fc7-1499">Значение по умолчанию — пустая строка ("").</span><span class="sxs-lookup"><span data-stu-id="51fc7-1499">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1500">Максимальная длина метки очереди сообщений — 124 символам.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1500">The maximum length of a message queue label is 124 characters.</span></span>  
  
 <span data-ttu-id="51fc7-1501"><xref:System.Messaging.MessageQueue.Label%2A> Свойство необязательно должен быть уникальным для всех очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1501">The <xref:System.Messaging.MessageQueue.Label%2A> property does not need to be unique across all queues.</span></span> <span data-ttu-id="51fc7-1502">Однако если несколько очередей одного и того же <xref:System.Messaging.MessageQueue.Label%2A>, нельзя использовать <xref:System.Messaging.MessageQueue.Send%28System.Object%29> метод для передачи сообщения для всех из них.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1502">However, if multiple queues share the same <xref:System.Messaging.MessageQueue.Label%2A>, you cannot use the <xref:System.Messaging.MessageQueue.Send%28System.Object%29> method to broadcast a message to all of them.</span></span> <span data-ttu-id="51fc7-1503">Если используется синтаксис метки для <xref:System.Messaging.MessageQueue.Path%2A> свойство при отправке сообщения, будет создано исключение при <xref:System.Messaging.MessageQueue.Label%2A> не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1503">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="51fc7-1504">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1504">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1505">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1505">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1506">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1506">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1507">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1507">Local computer</span></span>|<span data-ttu-id="51fc7-1508">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1508">Yes</span></span>|  
|<span data-ttu-id="51fc7-1509">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1509">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1510">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1510">Yes</span></span>|  
|<span data-ttu-id="51fc7-1511">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1511">Remote computer</span></span>|<span data-ttu-id="51fc7-1512">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1512">No</span></span>|  
|<span data-ttu-id="51fc7-1513">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1513">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1514">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1514">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1515">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.Label%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1515">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.Label%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1516">Для метки задано недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1516">The label was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1517">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1517">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="LastModifyTime">
      <MemberSignature Language="C#" Value="public DateTime LastModifyTime { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.DateTime LastModifyTime" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.LastModifyTime" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LastModifyTime As DateTime" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property DateTime LastModifyTime { DateTime get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_LastModifyTime")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.DateTime</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1518">Получает время последнего изменения свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1518">Gets the last time the properties of a queue were modified.</span></span></summary>
        <value><span data-ttu-id="51fc7-1519">Объект <see cref="T:System.DateTime" />, который указывает, когда свойства очереди были изменены в последний раз.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1519">A <see cref="T:System.DateTime" /> that indicates when the queue properties were last modified.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1520">Время последнего изменения включает при создании этой очереди, а также <xref:System.Messaging.MessageQueue> свойство, которое изменяет очередь Message Queuing, такие как <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1520">The last modification time includes when the queue was created and any <xref:System.Messaging.MessageQueue> property that modifies the Message Queuing queue, such as <xref:System.Messaging.MessageQueue.BasePriority%2A>.</span></span> <span data-ttu-id="51fc7-1521">Значение <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство представляет собой системное время на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1521">The value of the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property represents the system time of the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-1522">Необходимо вызвать <xref:System.Messaging.MessageQueue.Refresh%2A> перед получением <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство; в противном случае время изменения, связанные с этим <xref:System.Messaging.MessageQueue> могут устареть.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1522">You must call <xref:System.Messaging.MessageQueue.Refresh%2A> before getting the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property; otherwise, the modification time associated with this <xref:System.Messaging.MessageQueue> might not be current.</span></span>  
  
 <span data-ttu-id="51fc7-1523">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1523">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1524">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1524">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1525">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1525">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1526">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1526">Local computer</span></span>|<span data-ttu-id="51fc7-1527">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1527">Yes</span></span>|  
|<span data-ttu-id="51fc7-1528">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1528">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1529">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1529">Yes</span></span>|  
|<span data-ttu-id="51fc7-1530">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1530">Remote computer</span></span>|<span data-ttu-id="51fc7-1531">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1531">No</span></span>|  
|<span data-ttu-id="51fc7-1532">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1532">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1533">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1533">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1534">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1534">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1535">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1535">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CreateTime" />
        <altmember cref="P:System.Messaging.MessageQueue.DenySharedReceive" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MachineName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1536">Получает или задает имя компьютера, на котором расположена очередь Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1536">Gets or sets the name of the computer where the Message Queuing queue is located.</span></span></summary>
        <value><span data-ttu-id="51fc7-1537">Имя компьютера, на котором расположена очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1537">The name of the computer where the queue is located.</span></span> <span data-ttu-id="51fc7-1538">По умолчанию службой Message Queuing используется значение ".", т. е. локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1538">The Message Queuing default is ".", the local computer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1539"><xref:System.Messaging.MessageQueue.MachineName%2A> — Это Неотъемлемый компонент синтаксиса понятного имени очереди <xref:System.Messaging.MessageQueue.Path%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1539">The <xref:System.Messaging.MessageQueue.MachineName%2A> is an integral component of the friendly name syntax of the queue <xref:System.Messaging.MessageQueue.Path%2A>.</span></span> <span data-ttu-id="51fc7-1540">В следующей таблице показаны синтаксис, который следует использовать для очереди заданного типа, когда нужно определить путь к очереди, используя его понятное имя.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1540">The following table shows the syntax you should use for a queue of a specified type when you want to identify the queue path using its friendly name.</span></span>  
  
|<span data-ttu-id="51fc7-1541">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-1541">Queue type</span></span>|<span data-ttu-id="51fc7-1542">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-1542">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-1543">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-1543">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-1544">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-1544">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="51fc7-1545">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-1545">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="51fc7-1546">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-1546">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="51fc7-1547">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-1547">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="51fc7-1548">Машины транзакционную очередь недоставленных сообщений</span><span class="sxs-lookup"><span data-stu-id="51fc7-1548">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="51fc7-1549">Используйте «.» для локального компьютера, при указании <xref:System.Messaging.MessageQueue.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1549">Use "." for the local computer when specifying the <xref:System.Messaging.MessageQueue.MachineName%2A>.</span></span> <span data-ttu-id="51fc7-1550">Только имя компьютера является для этого свойства, например, `Server0`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1550">Only the computer name is recognized for this property, for example, `Server0`.</span></span> <span data-ttu-id="51fc7-1551"><xref:System.Messaging.MessageQueue.MachineName%2A> Свойство не поддерживает формат IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1551">The <xref:System.Messaging.MessageQueue.MachineName%2A> property does not support the IP address format.</span></span>  
  
 <span data-ttu-id="51fc7-1552">Если определить <xref:System.Messaging.MessageQueue.Path%2A> на основе <xref:System.Messaging.MessageQueue.MachineName%2A>, приложение вызывает исключение при работе в автономном режиме, поскольку для перевода пути необходим контроллер домена.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1552">If you define the <xref:System.Messaging.MessageQueue.Path%2A> in terms of the <xref:System.Messaging.MessageQueue.MachineName%2A>, the application throws an exception when working offline because the domain controller is required for path translation.</span></span> <span data-ttu-id="51fc7-1553">Таким образом, необходимо использовать <xref:System.Messaging.MessageQueue.FormatName%2A> для <xref:System.Messaging.MessageQueue.Path%2A> синтаксис при работе в автономном режиме.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1553">Therefore, you must use the <xref:System.Messaging.MessageQueue.FormatName%2A> for the <xref:System.Messaging.MessageQueue.Path%2A> syntax when working offline.</span></span>  
  
 <span data-ttu-id="51fc7-1554"><xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, И <xref:System.Messaging.MessageQueue.QueueName%2A> связанных свойств.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1554">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="51fc7-1555">Изменение <xref:System.Messaging.MessageQueue.MachineName%2A> свойству <xref:System.Messaging.MessageQueue.Path%2A> изменение свойства.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1555">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="51fc7-1556">Формируется на основе нового <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1556">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="51fc7-1557">Изменение <xref:System.Messaging.MessageQueue.Path%2A> (например, чтобы использовать синтаксис имени формата) сбрасывает <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства, чтобы ссылаться на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1557">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span> <span data-ttu-id="51fc7-1558">Если <xref:System.Messaging.MessageQueue.QueueName%2A> свойство пусто, <xref:System.Messaging.MessageQueue.Path%2A> присвоено очередь журнала указанного вами компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1558">If the <xref:System.Messaging.MessageQueue.QueueName%2A> property is empty, the <xref:System.Messaging.MessageQueue.Path%2A> is set to the Journal queue of the computer you specify.</span></span>  
  
 <span data-ttu-id="51fc7-1559">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1559">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1560">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1560">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1561">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1561">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1562">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1562">Local computer</span></span>|<span data-ttu-id="51fc7-1563">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1563">Yes</span></span>|  
|<span data-ttu-id="51fc7-1564">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1564">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1565">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1565">Yes</span></span>|  
|<span data-ttu-id="51fc7-1566">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1566">Remote computer</span></span>|<span data-ttu-id="51fc7-1567">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1567">Yes</span></span>|  
|<span data-ttu-id="51fc7-1568">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1568">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1569">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1569">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1570">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.MachineName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1570">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MachineName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1571">Недопустимое имя компьютера. Причиной может быть неверный синтаксис.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1571">The name of the computer is not valid, possibly because the syntax is incorrect.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1572">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1572">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
        <altmember cref="M:System.Messaging.MessageQueue.GetMessageQueueEnumerator" />
      </Docs>
    </Member>
    <Member MemberName="MaximumJournalSize">
      <MemberSignature Language="C#" Value="public long MaximumJournalSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumJournalSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumJournalSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumJournalSize { long get(); void set(long value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumJournalSize")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1573">Получает или задает максимальный размер очереди журнала.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1573">Gets or sets the maximum size of the journal queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1574">Максимальный размер очереди журнала в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1574">The maximum size, in kilobytes, of the journal queue.</span></span> <span data-ttu-id="51fc7-1575">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1575">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> предоставляет доступ к ограничению в хранилища очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1576"><xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> provides access to the Message Queuing journal storage limit.</span></span> <span data-ttu-id="51fc7-1577">Это значение, только если <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> — `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1577">It is relevant only when <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> is `true`.</span></span> <span data-ttu-id="51fc7-1578">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1578">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-1579">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляров затрагиваемые изменением</span><span class="sxs-lookup"><span data-stu-id="51fc7-1579">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="51fc7-1580">Если хранение сообщений в журнале или в очереди недоставленных сообщений, необходимо периодически очищать очередь для удаления сообщений, которые больше не нужны.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1580">If you store messages in a journal or dead-letter queue, you should periodically clear the queue to remove messages that are no longer needed.</span></span> <span data-ttu-id="51fc7-1581">Сообщений в такой очереди учитываются квоты для компьютера, на котором находится очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1581">Messages in such a queue count toward the message quota for the computer where the queue resides.</span></span> <span data-ttu-id="51fc7-1582">(Администратор устанавливает квота компьютера).</span><span class="sxs-lookup"><span data-stu-id="51fc7-1582">(The administrator sets the computer quota.)</span></span>  
  
 <span data-ttu-id="51fc7-1583">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1583">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1584">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1584">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1585">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1585">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1586">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1586">Local computer</span></span>|<span data-ttu-id="51fc7-1587">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1587">Yes</span></span>|  
|<span data-ttu-id="51fc7-1588">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1588">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1589">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1589">Yes</span></span>|  
|<span data-ttu-id="51fc7-1590">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1590">Remote computer</span></span>|<span data-ttu-id="51fc7-1591">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1591">No</span></span>|  
|<span data-ttu-id="51fc7-1592">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1592">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1593">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1593">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1594">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1594">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#21](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1595">Для максимального размера очереди журнала установлено недопустимое значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1595">The maximum journal queue size was set to an invalid value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1596">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1596">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.UseJournalQueue" />
        <altmember cref="P:System.Messaging.MessageQueue.MaximumQueueSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MaximumQueueSize">
      <MemberSignature Language="C#" Value="public long MaximumQueueSize { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumQueueSize" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MaximumQueueSize" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumQueueSize As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumQueueSize { long get(); void set(long value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MaximumQueueSize")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1597">Получает или задает максимальный размер очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1597">Gets or sets the maximum size of the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1598">Максимальный размер очереди в килобайтах.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1598">The maximum size, in kilobytes, of the queue.</span></span> <span data-ttu-id="51fc7-1599">По умолчанию службой Message Queuing не устанавливаются ограничения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1599">The Message Queuing default specifies that no limit exists.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1600"><xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> Предоставляет доступ к очереди сообщений сообщения ограничение хранилища, которая отделена от квоты сообщений на компьютере, администратор определяет.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1600">The <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> provides access to the Message Queuing message storage limit, which is separate from the computer's message quota that the administrator defines.</span></span> <span data-ttu-id="51fc7-1601">Дополнительные сведения о квоты сообщений см. в разделе <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1601">For more information about the message quota, see <xref:System.Messaging.MessageQueue.MaximumJournalSize%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-1602">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1602">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-1603">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляров затрагиваемые изменением</span><span class="sxs-lookup"><span data-stu-id="51fc7-1603">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change</span></span>  
  
 <span data-ttu-id="51fc7-1604">Если попытка превышает максимальный размер очереди или квоты сообщений компьютера, сообщения могут быть утеряны.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1604">If an attempt is made to exceed either the maximum queue size or the computer message quota, messages might be lost.</span></span> <span data-ttu-id="51fc7-1605">При достижении квоты очереди, служба Message Queuing уведомляет в очередь администрирования, отправляющего приложения, чтобы указать, что очередь заполнена, возвращая отрицательное подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1605">When the queue quota is reached, Message Queuing notifies the administration queue of the sending application to indicate that the queue is full, by returning a negative acknowledgment message.</span></span> <span data-ttu-id="51fc7-1606">Служба Message Queuing продолжает отправлять отрицательные подтверждения, пока общий размер сообщений в очереди не станет меньше значения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1606">Message Queuing continues to send negative acknowledgments until the total size of the messages in the queue drops below the limit.</span></span>  
  
 <span data-ttu-id="51fc7-1607">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1607">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1608">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1608">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1609">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1609">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1610">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1610">Local computer</span></span>|<span data-ttu-id="51fc7-1611">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1611">Yes</span></span>|  
|<span data-ttu-id="51fc7-1612">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1612">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1613">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1613">Yes</span></span>|  
|<span data-ttu-id="51fc7-1614">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1614">Remote computer</span></span>|<span data-ttu-id="51fc7-1615">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1615">No</span></span>|  
|<span data-ttu-id="51fc7-1616">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1616">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1617">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1617">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1618">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1618">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.MaximumQueueSize%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#22](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1619">Максимальный размер очереди содержит отрицательное значение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1619">The maximum queue size contains a negative value.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1620">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1620">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteQueueSize" />
      </Docs>
    </Member>
    <Member MemberName="MessageReadPropertyFilter">
      <MemberSignature Language="C#" Value="public System.Messaging.MessagePropertyFilter MessageReadPropertyFilter { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Messaging.MessagePropertyFilter MessageReadPropertyFilter" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MessageReadPropertyFilter" />
      <MemberSignature Language="VB.NET" Value="Public Property MessageReadPropertyFilter As MessagePropertyFilter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Messaging::MessagePropertyFilter ^ MessageReadPropertyFilter { System::Messaging::MessagePropertyFilter ^ get(); void set(System::Messaging::MessagePropertyFilter ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MessageReadPropertyFilter")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.MessagePropertyFilter</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1621">Получает или задает фильтр свойств для получения и считывания сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1621">Gets or sets the property filter for receiving or peeking messages.</span></span></summary>
        <value><span data-ttu-id="51fc7-1622">Объект <see cref="T:System.Messaging.MessagePropertyFilter" />, который очередь использует для фильтрации набора свойств, получаемого или считываемого ею для каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1622">The <see cref="T:System.Messaging.MessagePropertyFilter" /> used by the queue to filter the set of properties it receives or peeks for each message.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1623">Этот фильтр представляет собой набор логических значений, ограничивающих свойства сообщения, <xref:System.Messaging.MessageQueue> Получает или просматривает.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1623">This filter is a set of Boolean values restricting the message properties that the <xref:System.Messaging.MessageQueue> receives or peeks.</span></span> <span data-ttu-id="51fc7-1624">Когда <xref:System.Messaging.MessageQueue> получения или выбирает сообщение из очереди сервера, он извлекает только те свойства, для которого <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> значение `true`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1624">When the <xref:System.Messaging.MessageQueue> receives or peeks a message from the server queue, it retrieves only those properties for which the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> value is `true`.</span></span>  
  
 <span data-ttu-id="51fc7-1625">Ниже представлены исходные значения свойств для <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> свойства.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1625">The following shows initial property values for the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> property.</span></span> <span data-ttu-id="51fc7-1626">Эти параметры являются идентичными с вызовом метода <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> на <xref:System.Messaging.MessagePropertyFilter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1626">These settings are identical to calling <xref:System.Messaging.MessagePropertyFilter.SetDefaults%2A> on a <xref:System.Messaging.MessagePropertyFilter>.</span></span>  
  
|<span data-ttu-id="51fc7-1627">Свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1627">Property</span></span>|<span data-ttu-id="51fc7-1628">Значение по умолчанию</span><span class="sxs-lookup"><span data-stu-id="51fc7-1628">Default value</span></span>|  
|--------------|-------------------|  
|<xref:System.Messaging.MessagePropertyFilter.Acknowledgment%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AcknowledgeType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AdministrationQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AppSpecific%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ArrivedTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.AttachSenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Authenticated%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderName%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.AuthenticationProviderType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Body%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.ConnectorType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.CorrelationId%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultBodySize%2A>|<span data-ttu-id="51fc7-1629">1024 байт</span><span class="sxs-lookup"><span data-stu-id="51fc7-1629">1024 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultExtensionSize%2A>|<span data-ttu-id="51fc7-1630">255 байт</span><span class="sxs-lookup"><span data-stu-id="51fc7-1630">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DefaultLabelSize%2A>|<span data-ttu-id="51fc7-1631">255 байт</span><span class="sxs-lookup"><span data-stu-id="51fc7-1631">255 bytes</span></span>|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DestinationSymmetricKey%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.DigitalSignature%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.EncryptionAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Extension%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.HashAlgorithm%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Id%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.IsFirstInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.IsLastInTransaction%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Label%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.MessageType%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Priority%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.Recoverable%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.ResponseQueue%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderCertificate%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SenderVersion%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.SentTime%2A>|`true`|  
|<xref:System.Messaging.MessagePropertyFilter.SourceMachine%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToBeReceived%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TimeToReachQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionId%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.TransactionStatusQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseAuthentication%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseDeadLetterQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseEncryption%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseJournalQueue%2A>|`false`|  
|<xref:System.Messaging.MessagePropertyFilter.UseTracing%2A>|`false`|  
  
 <span data-ttu-id="51fc7-1632">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1632">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1633">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1633">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1634">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1634">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1635">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1635">Local computer</span></span>|<span data-ttu-id="51fc7-1636">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1636">Yes</span></span>|  
|<span data-ttu-id="51fc7-1637">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1637">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1638">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1638">Yes</span></span>|  
|<span data-ttu-id="51fc7-1639">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1639">Remote computer</span></span>|<span data-ttu-id="51fc7-1640">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1640">Yes</span></span>|  
|<span data-ttu-id="51fc7-1641">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1641">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1642">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1642">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1643">Следующий пример кода использует <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> для ограничения полученных свойств сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1643">The following code example uses the <xref:System.Messaging.MessageQueue.MessageReadPropertyFilter%2A> to restrict the message properties received.</span></span>  
  
 [!code-cpp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CPP/mqmessagereadpropertyfilter.cpp#1)]
 [!code-csharp[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/CS/mqmessagereadpropertyfilter.cs#1)]
 [!code-vb[MessageQueue.MessageReadPropertyFilter#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.MessageReadPropertyFilter/VB/mqmessagereadpropertyfilter.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1644">Значение фильтра — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1644">The filter is <see langword="null" />.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="MulticastAddress">
      <MemberSignature Language="C#" Value="public string MulticastAddress { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MulticastAddress" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.MulticastAddress" />
      <MemberSignature Language="VB.NET" Value="Public Property MulticastAddress As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MulticastAddress { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_MulticastAddress")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1645">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1645">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-1646">Получает или задает адрес многоадресной рассылки, связанный с данной очередью.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1646">Gets or sets the multicast address associated with the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1647">Объект <see cref="T:System.String" />, содержащий допустимый групповой адрес (в виде, показанном ниже) или значение <see langword="null" />, которое указывает, что очередь не связана с групповым адресом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1647">A <see cref="T:System.String" /> that contains a valid multicast address (in the form shown below) or <see langword="null" />, which indicates that the queue is not associated with a multicast address.</span></span>  
  
```  
&lt;address&gt;:&lt;port&gt;  
```</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1648"><xref:System.Messaging.MessageQueue.MulticastAddress%2A> Свойство используется для связывания с адресом многоадресной рассылки, который может использоваться при отправке сообщений нетранзакционную очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1648">The <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property is used to associate a non-transactional queue with a multicast address that can be used when sending messages.</span></span> <span data-ttu-id="51fc7-1649">Не удалось связать транзакционной очереди с адресом многоадресной рассылки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1649">You cannot associate a transactional queue with a multicast address.</span></span> <span data-ttu-id="51fc7-1650">Если отправляющее приложение отправляет сообщения многоадресной рассылки, служба Message Queuing передает копию сообщения в каждую очередь, связанную с этим адресом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1650">When the sending application sends messages to a multicast address, Message Queuing sends a copy of the message to every queue associated with that address.</span></span>  
  
 <span data-ttu-id="51fc7-1651">Многоадресная рассылка адреса должны быть в диапазоне класса D от 224.0.0.0 до 239.255.255.255, который соответствует установке первых четырех старших битов, равных 1110.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1651">IP multicast addresses must be in the class D range from 224.0.0.0 to 239.255.255.255, which corresponds to setting the first four high-order bits equal to 1110.</span></span> <span data-ttu-id="51fc7-1652">Однако только определенные диапазоны адресов в этом диапазоне не зарезервированы и доступны для отправки многоадресных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1652">However, only certain ranges of addresses in this range are unreserved and available for sending multicast messages.</span></span> <span data-ttu-id="51fc7-1653">Новейший список зарезервированных адресов многоадресной рассылки, в разделе [адресов многоадресной рассылки Internet Assigned номер Authority (IANA)](http://go.microsoft.com/fwlink/?linkid=3859) веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1653">For the latest list of reserved multicast addresses, see the [Internet Assigned Number Authority (IANA) Internet Multicast Addresses](http://go.microsoft.com/fwlink/?linkid=3859) Web page.</span></span> <span data-ttu-id="51fc7-1654">Не ограничены по номеру порта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1654">There are no restrictions on the port number.</span></span>  
  
 <span data-ttu-id="51fc7-1655">Если несколько исходных компьютерах отправляют сообщения многоадресной рассылки и требуется конкретная очередь получения сообщений от только с одного компьютера, каждом компьютере-источнике необходимо отправлять сообщения на разные комбинации IP адрес и номер порта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1655">If several source computers are sending multicast messages and you want a specific queue to receive messages from only one source computer, each source computer must send messages to a different combination of IP address and port number.</span></span>  
  
 <span data-ttu-id="51fc7-1656">Чтобы отменить связь очереди с адресом многоадресной рассылки, задайте <xref:System.Messaging.MessageQueue.MulticastAddress%2A> строку нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1656">To dissociate a queue from a multicast address, set the <xref:System.Messaging.MessageQueue.MulticastAddress%2A> property to a zero-length string.</span></span> <span data-ttu-id="51fc7-1657">Не устанавливайте значение `null`, как это приведет к <xref:System.ArgumentNullException>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1657">Do not set it to `null`, as this will result in a <xref:System.ArgumentNullException>.</span></span>  
  
 <span data-ttu-id="51fc7-1658">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1658">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1659">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1659">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1660">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1660">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1661">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1661">Local computer</span></span>|<span data-ttu-id="51fc7-1662">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1662">Yes</span></span>|  
|<span data-ttu-id="51fc7-1663">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1663">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1664">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1664">Yes</span></span>|  
|<span data-ttu-id="51fc7-1665">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1665">Remote computer</span></span>|<span data-ttu-id="51fc7-1666">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1666">No</span></span>|  
|<span data-ttu-id="51fc7-1667">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1667">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1668">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1668">No</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-1669">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1669">MSMQ 3.0 is not installed.</span></span></exception>
      </Docs>
    </Member>
    <Member MemberName="Path">
      <MemberSignature Language="C#" Value="public string Path { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Path" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Path" />
      <MemberSignature Language="VB.NET" Value="Public Property Path As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Path { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.Editor("System.Messaging.Design.QueuePathEditor", "System.Drawing.Design.UITypeEditor, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Path")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1670">Получает или задает путь очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1670">Gets or sets the queue's path.</span></span> <span data-ttu-id="51fc7-1671">После задания свойства <see cref="P:System.Messaging.MessageQueue.Path" /> объект <see cref="T:System.Messaging.MessageQueue" /> будет указывать на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1671">Setting the <see cref="P:System.Messaging.MessageQueue.Path" /> causes the <see cref="T:System.Messaging.MessageQueue" /> to point to a new queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-1672">Очередь, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1672">The queue that is referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-1673">Значение по умолчанию зависит от того, какой используется конструктор <see cref="M:System.Messaging.MessageQueue.#ctor" />. Значение равно либо <see langword="null" />, либо задается параметром <paramref name="path" /> конструктора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1673">The default depends on which <see cref="M:System.Messaging.MessageQueue.#ctor" /> constructor you use; it is either <see langword="null" /> or is specified by the constructor's <paramref name="path" /> parameter.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1674">Синтаксис <xref:System.Messaging.MessageQueue.Path%2A> свойство зависит от типа очереди его точек в, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1674">The syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue it points to, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-1675">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-1675">Queue type</span></span>|<span data-ttu-id="51fc7-1676">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-1676">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-1677">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-1677">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-1678">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-1678">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="51fc7-1679">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-1679">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
|<span data-ttu-id="51fc7-1680">Очередь журнала компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-1680">Machine journal queue</span></span>|`MachineName`\\`Journal$`|  
|<span data-ttu-id="51fc7-1681">Очередь недоставленных сообщений компьютера</span><span class="sxs-lookup"><span data-stu-id="51fc7-1681">Machine dead-letter queue</span></span>|`MachineName`\\`Deadletter$`|  
|<span data-ttu-id="51fc7-1682">Машины транзакционную очередь недоставленных сообщений</span><span class="sxs-lookup"><span data-stu-id="51fc7-1682">Machine transactional dead-letter queue</span></span>|`MachineName`\\`XactDeadletter$`|  
  
 <span data-ttu-id="51fc7-1683">Используйте «.» для представления локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1683">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-1684"><xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, И <xref:System.Messaging.MessageQueue.QueueName%2A> связанных свойств.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1684">The <xref:System.Messaging.MessageQueue.MachineName%2A>, <xref:System.Messaging.MessageQueue.Path%2A>, and <xref:System.Messaging.MessageQueue.QueueName%2A> properties are related.</span></span> <span data-ttu-id="51fc7-1685">Изменение <xref:System.Messaging.MessageQueue.MachineName%2A> свойству <xref:System.Messaging.MessageQueue.Path%2A> изменение свойства.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1685">Changing the <xref:System.Messaging.MessageQueue.MachineName%2A> property causes the <xref:System.Messaging.MessageQueue.Path%2A> property to change.</span></span> <span data-ttu-id="51fc7-1686">Формируется на основе нового <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1686">It is built from the new <xref:System.Messaging.MessageQueue.MachineName%2A> and the <xref:System.Messaging.MessageQueue.QueueName%2A>.</span></span> <span data-ttu-id="51fc7-1687">Изменение <xref:System.Messaging.MessageQueue.Path%2A> (например, чтобы использовать синтаксис имени формата) сбрасывает <xref:System.Messaging.MessageQueue.MachineName%2A> и <xref:System.Messaging.MessageQueue.QueueName%2A> свойства, чтобы ссылаться на новую очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1687">Changing the <xref:System.Messaging.MessageQueue.Path%2A> (for example, to use the format name syntax) resets the <xref:System.Messaging.MessageQueue.MachineName%2A> and <xref:System.Messaging.MessageQueue.QueueName%2A> properties to refer to the new queue.</span></span>  
  
 <span data-ttu-id="51fc7-1688">Кроме того, можно использовать <xref:System.Messaging.MessageQueue.FormatName%2A> или <xref:System.Messaging.MessageQueue.Label%2A> для описания пути к очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1688">Alternatively, you can use the <xref:System.Messaging.MessageQueue.FormatName%2A> or <xref:System.Messaging.MessageQueue.Label%2A> to describe the queue path, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-1689">Ссылка</span><span class="sxs-lookup"><span data-stu-id="51fc7-1689">Reference</span></span>|<span data-ttu-id="51fc7-1690">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-1690">Syntax</span></span>|<span data-ttu-id="51fc7-1691">Пример</span><span class="sxs-lookup"><span data-stu-id="51fc7-1691">Example</span></span>|  
|---------------|------------|-------------|  
|<span data-ttu-id="51fc7-1692">Название формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1692">Format name</span></span>|<span data-ttu-id="51fc7-1693">`FormatName:` [ *имя формата* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-1693">`FormatName:` [ *format name* ]</span></span>|<span data-ttu-id="51fc7-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span><span class="sxs-lookup"><span data-stu-id="51fc7-1694">`FormatName:Public=` 5A5F7535-AE9A-41d4-935C-845C2AFF7112</span></span>|  
|<span data-ttu-id="51fc7-1695">Метка</span><span class="sxs-lookup"><span data-stu-id="51fc7-1695">Label</span></span>|<span data-ttu-id="51fc7-1696">`Label:` [ *метка* ]</span><span class="sxs-lookup"><span data-stu-id="51fc7-1696">`Label:` [ *label* ]</span></span>|<span data-ttu-id="51fc7-1697">`Label:` TheLabel</span><span class="sxs-lookup"><span data-stu-id="51fc7-1697">`Label:` TheLabel</span></span>|  
  
 <span data-ttu-id="51fc7-1698">Если используется синтаксис метки для <xref:System.Messaging.MessageQueue.Path%2A> свойство при отправке сообщения, будет создано исключение при <xref:System.Messaging.MessageQueue.Label%2A> не является уникальным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1698">If you use the label syntax for the <xref:System.Messaging.MessageQueue.Path%2A> property when you send the message, an exception will be thrown if the <xref:System.Messaging.MessageQueue.Label%2A> is not unique.</span></span>  
  
 <span data-ttu-id="51fc7-1699">Для работы в автономном режиме необходимо использовать синтаксис имени формата, а не синтаксис понятного имени из первой таблицы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1699">To work offline, you must use the format name syntax, rather than the friendly name syntax in the first table.</span></span> <span data-ttu-id="51fc7-1700">В противном случае исключение недоступности основного контроллера домена (на котором установлена Active Directory) для разрешения пути в имя формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1700">Otherwise, an exception is thrown because the primary domain controller (on which Active Directory resides) is not available to resolve the path to the format name.</span></span>  
  
 <span data-ttu-id="51fc7-1701">После задания нового пути закрывается очередь сообщений и освобождаются все дескрипторы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1701">Setting a new path closes the message queue and releases all handles.</span></span>  
  
 <span data-ttu-id="51fc7-1702">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1702">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1703">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1703">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1704">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1704">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1705">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1705">Local computer</span></span>|<span data-ttu-id="51fc7-1706">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1706">Yes</span></span>|  
|<span data-ttu-id="51fc7-1707">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1707">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1708">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1708">Yes</span></span>|  
|<span data-ttu-id="51fc7-1709">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1709">Remote computer</span></span>|<span data-ttu-id="51fc7-1710">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1710">Yes</span></span>|  
|<span data-ttu-id="51fc7-1711">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1711">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1712">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1712">Yes</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="51fc7-1713">В режиме рабочей группы можно использовать только частные очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1713">In workgroup mode you can only use private queues.</span></span> <span data-ttu-id="51fc7-1714">Укажите путь, используя синтаксис частной очереди `MachineName` \\ `Private$` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1714">You specify the path using the private queue syntax `MachineName`\\`Private$`\\`QueueName`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1715">В следующем примере кода создается новый <xref:System.Messaging.MessageQueue> объекты с различными типами синтаксиса имени пути.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1715">The following code example creates new <xref:System.Messaging.MessageQueue> objects using various path name syntax types.</span></span> <span data-ttu-id="51fc7-1716">В каждом случае он отправляет сообщение в очередь, путь, определенный в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1716">In each case, it sends a message to the queue whose path is defined in the constructor.</span></span>  
  
 [!code-cpp[MessageQueue.Path#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Path/CPP/mqpath.cpp#1)]
 [!code-csharp[MessageQueue.Path#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Path/CS/mqpath.cs#1)]
 [!code-vb[MessageQueue.Path#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Path/VB/mqpath.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1717">Недопустимый путь. Возможно из-за неправильного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1717">The path is not valid, possibly because the syntax is not valid.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.QueueName" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
        <altmember cref="P:System.Messaging.MessageQueue.FormatName" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.#ctor" />
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Peek">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="51fc7-1718">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1718">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="51fc7-1719">Возвращает копию первого сообщения в очереди, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1719">Returns a copy of the first message in the queue without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1720">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1720">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-1721">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1721">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1722">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1722">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1723">Используйте эту перегрузку для считывания очереди или ожидания поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1723">Use this overload to peek a queue, or to wait until a message exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1724"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет первого сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1724">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="51fc7-1725">Таким образом, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращают одно и то же сообщение, пока не поступит сообщение с более высоким приоритетом в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1725">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-1726"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, читает и удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1726">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="51fc7-1727">Повторные вызовы <xref:System.Messaging.MessageQueue.Receive%2A>, таким образом, возвращают различные сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1727">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="51fc7-1728">Служба Message Queuing упорядочивает сообщения в очередь в порядке приоритета и временем поступления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1728">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="51fc7-1729">Новое сообщение помещается перед более старым, только если он имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1729">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="51fc7-1730">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1730">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1731">Поскольку эта перегрузка не тайм-аут, приложение может ожидать неопределенное время.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1731">Because this overload does not specify a time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="51fc7-1732">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1732">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span> <span data-ttu-id="51fc7-1733">Кроме того, можно указать время ожидания для сообщения прибывают в очередь, используя перегруженный <xref:System.Messaging.MessageQueue.Peek%2A> , указывающее время ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1733">Alternatively, you can specify a time-out for a message to arrive in the queue by using the overload of <xref:System.Messaging.MessageQueue.Peek%2A> that specifies a time-out.</span></span>  
  
 <span data-ttu-id="51fc7-1734">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1734">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1735">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1735">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1736">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1736">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1737">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1737">Local computer</span></span>|<span data-ttu-id="51fc7-1738">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1738">Yes</span></span>|  
|<span data-ttu-id="51fc7-1739">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1739">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1740">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1740">Yes</span></span>|  
|<span data-ttu-id="51fc7-1741">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1741">Remote computer</span></span>|<span data-ttu-id="51fc7-1742">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1742">No</span></span>|  
|<span data-ttu-id="51fc7-1743">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1743">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1744">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1744">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1745">В следующих примерах используется <xref:System.Messaging.MessageQueue.Peek%2A> метод в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1745">The following examples use the <xref:System.Messaging.MessageQueue.Peek%2A> method on a queue.</span></span>  
  
 <span data-ttu-id="51fc7-1746">В первом примере приложение ожидает, пока сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1746">In the first example, the application waits until a message becomes available in the queue.</span></span> <span data-ttu-id="51fc7-1747">Обратите внимание, что первый пример не осуществляет доступ к сообщение, поступающее; он просто останавливается обработка до прибытия сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1747">Note that the first example does not access the message that arrives; it merely pauses processing until a message arrives.</span></span> <span data-ttu-id="51fc7-1748">Если сообщение уже существует в очереди, будет возвращено немедленно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1748">If a message already exists in the queue, it will return immediately.</span></span>  
  
 <span data-ttu-id="51fc7-1749">Во втором примере сообщение, содержащее определяемые приложением `Order` класса отправляются в очередь и затем считывается из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1749">In the second example, a message that contains an application-defined `Order` class is sent to the queue, and then peeked from the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CPP/mqpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Peek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_noparms/CS/mqpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.Peek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_noparms/VB/mqpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1750">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1750">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-1751">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1751">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Peek (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-1752">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1752">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <summary><span data-ttu-id="51fc7-1753">Возвращает, не удаляя (считывает), первое сообщение в очереди, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1753">Returns without removing (peeks) the first message in the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-1754">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1754">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1755">Объект <see cref="T:System.Messaging.Message" />, представляющий первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1755">The <see cref="T:System.Messaging.Message" /> that represents the first message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1756">Используйте эту перегрузку для считывания очереди или ожидания указанного периода времени поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1756">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="51fc7-1757">Метод возвращает немедленно, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1757">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1758"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет первого сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1758">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, the first message from the queue.</span></span> <span data-ttu-id="51fc7-1759">Таким образом, повторные вызовы <xref:System.Messaging.MessageQueue.Peek%2A> возвращают одно и то же сообщение, пока не поступит сообщение с более высоким приоритетом в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1759">Therefore, repeated calls to <xref:System.Messaging.MessageQueue.Peek%2A> return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-1760"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, читает и удаляет из очереди первое сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1760">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes the first message from the queue.</span></span> <span data-ttu-id="51fc7-1761">Повторные вызовы <xref:System.Messaging.MessageQueue.Receive%2A>, таким образом, возвращают различные сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1761">Repeated calls to <xref:System.Messaging.MessageQueue.Receive%2A>, therefore, return different messages.</span></span>  
  
 <span data-ttu-id="51fc7-1762">Служба Message Queuing упорядочивает сообщения в очередь в порядке приоритета и временем поступления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1762">Message Queuing orders messages in the queue according to priority and arrival time.</span></span> <span data-ttu-id="51fc7-1763">Новое сообщение помещается перед более старым, только если он имеет более высокий приоритет.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1763">A newer message is placed before an older one only if it is of a higher priority.</span></span>  
  
 <span data-ttu-id="51fc7-1764">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1764">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1765">Поток будет заблокирован в течение указанного периода времени или на неопределенное время, если вы указываете <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1765">The thread will be blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="51fc7-1766">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1766">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-1767">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1767">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1768">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1768">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1769">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1769">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1770">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1770">Local computer</span></span>|<span data-ttu-id="51fc7-1771">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1771">Yes</span></span>|  
|<span data-ttu-id="51fc7-1772">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1772">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1773">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1773">Yes</span></span>|  
|<span data-ttu-id="51fc7-1774">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1774">Remote computer</span></span>|<span data-ttu-id="51fc7-1775">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1775">No</span></span>|  
|<span data-ttu-id="51fc7-1776">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1776">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1777">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1777">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1778">Следующий пример кода использует <xref:System.Messaging.MessageQueue.Peek%2A> метода с указанием времени ожидания, равную нулю, чтобы проверить, пуста ли очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1778">The following code example uses the <xref:System.Messaging.MessageQueue.Peek%2A> method with a time-out of zero to check whether the queue is empty.</span></span>  
  
 [!code-cpp[MessageQueue.Peek_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CPP/mqpeek_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Peek_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Peek_timeout/CS/mqpeek_timeout.cs#1)]
 [!code-vb[MessageQueue.Peek_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Peek_timeout/VB/mqpeek_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1779">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1779">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1780">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1780">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-1781">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1781">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="Peek">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Peek (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.PeekAction action);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Peek(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.PeekAction action) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Peek(System.TimeSpan,System.Messaging.Cursor,System.Messaging.PeekAction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Peek(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::PeekAction action);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="action" Type="System.Messaging.PeekAction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-1782">Объект <see cref="T:System.TimeSpan" />, показывающий максимальное время ожидания появления первого сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1782">A <see cref="T:System.TimeSpan" /> that indicates the maximum time to wait for the queue to contain a message.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-1783">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1783">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="action"><span data-ttu-id="51fc7-1784">Одно из значений перечисления <see cref="T:System.Messaging.PeekAction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1784">One of the <see cref="T:System.Messaging.PeekAction" /> values.</span></span> <span data-ttu-id="51fc7-1785">Указывает, следует ли считывать текущее сообщение в очереди или следующее сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1785">Indicates whether to peek at the current message in the queue, or the next message.</span></span></param>
        <summary><span data-ttu-id="51fc7-1786">Возвращает, не удаляя (считывает), текущее или следующее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1786">Returns without removing (peeks) the current or next message in the queue, using the specified cursor.</span></span> <span data-ttu-id="51fc7-1787">Метод <see cref="M:System.Messaging.MessageQueue.Peek" /> является синхронным, поэтому он блокирует текущий поток до тех пор, пока сообщение не станет доступным или пока не истечет заданный тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1787">The <see cref="M:System.Messaging.MessageQueue.Peek" /> method is synchronous, so it blocks the current thread until a message becomes available or the specified time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1788">Объект <see cref="T:System.Messaging.Message" />, представляющий сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1788">A <see cref="T:System.Messaging.Message" /> that represents a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1789">Используйте эту перегрузку для считывания очереди или ожидания указанного периода времени поступления сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1789">Use this overload to peek a queue, or to wait a specified period of time until a message exists in the queue.</span></span> <span data-ttu-id="51fc7-1790">Метод возвращает немедленно, если сообщение уже существует в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1790">The method returns immediately if a message already exists in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1791"><xref:System.Messaging.MessageQueue.Peek%2A> Метод считывает, но не удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1791">The <xref:System.Messaging.MessageQueue.Peek%2A> method reads, but does not remove, a message from the queue.</span></span> <span data-ttu-id="51fc7-1792"><xref:System.Messaging.MessageQueue.Receive%2A> Метод, с другой стороны, читает и удаляет сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1792">The <xref:System.Messaging.MessageQueue.Receive%2A> method, on the other hand, both reads and removes a message from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1793">Метод <xref:System.Messaging.MessageQueue.Peek%2A> используется, если текущий поток можно заблокировать на время, пока ожидается поступление сообщения в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1793">Use <xref:System.Messaging.MessageQueue.Peek%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1794">Поток заблокирован в течение указанного периода времени или на неопределенное время, если вы указываете <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1794">The thread is blocked up to the specified period of time, or indefinitely if you indicated <xref:System.Messaging.MessageQueue.InfiniteTimeout>.</span></span> <span data-ttu-id="51fc7-1795">Если работа приложения должна продолжаться без ожидания, используйте асинхронный метод <xref:System.Messaging.MessageQueue.BeginPeek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1795">If you need the application processing to continue without waiting, use the asynchronous <xref:System.Messaging.MessageQueue.BeginPeek%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-1796">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1796">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1797">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1797">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1798">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1798">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1799">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1799">Local computer</span></span>|<span data-ttu-id="51fc7-1800">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1800">Yes</span></span>|  
|<span data-ttu-id="51fc7-1801">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1801">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1802">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1802">Yes</span></span>|  
|<span data-ttu-id="51fc7-1803">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1803">Remote computer</span></span>|<span data-ttu-id="51fc7-1804">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1804">No</span></span>|  
|<span data-ttu-id="51fc7-1805">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1805">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1806">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1806">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="51fc7-1807">Для параметра <paramref name="action" /> было задано значение, отличное от <see langword="PeekAction.Current" /> или <see langword="PeekAction.Next" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1807">A value other than <see langword="PeekAction.Current" /> or <see langword="PeekAction.Next" /> was specified for the <paramref name="action" /> parameter.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1808">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1808">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1809">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1809">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="51fc7-1810">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1810">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1811">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1811">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-1812">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1812">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.PeekAction" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-1813">Считывает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1813">Peeks a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-1814">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1814">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="51fc7-1815">Считывает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1815">Peeks the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1816">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1816">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1817">Метод ищет в очереди, на который указывает <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1817">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-1818">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1818">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-1819"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1819">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-1820">Два других метода позволяют просматривать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1820">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="51fc7-1821"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1821">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-1822">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1822">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1823">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1823">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1824">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1824">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1825">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1825">Local computer</span></span>|<span data-ttu-id="51fc7-1826">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1826">Yes</span></span>|  
|<span data-ttu-id="51fc7-1827">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1827">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1828">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1828">Yes</span></span>|  
|<span data-ttu-id="51fc7-1829">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1829">Remote computer</span></span>|<span data-ttu-id="51fc7-1830">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1830">No</span></span>|  
|<span data-ttu-id="51fc7-1831">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1831">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1832">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1832">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1833">В следующем примере кода отправляет и получает сообщение, содержащее заказ в и из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1833">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="51fc7-1834">Он специально запрашивается положительное подтверждение, когда исходное сообщение достигает или извлечено из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1834">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1835">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1835">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1836">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1836">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1837">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1837">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-1838">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1838">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-1839">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1839">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="51fc7-1840">Считывает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1840">Peeks the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1841">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1841">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1842">Метод ищет в очереди, на который указывает <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1842">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-1843">Если сообщение не найдено, соответствующий `correlationID` параметра, а новое сообщение прибывает в очереди в течение времени, заданного свойством `timeout` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1843">If no message is found that matches the `correlationID` parameter, and no new message arrives in the queue within the period specified by the `timeout` parameter, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-1844">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1844">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-1845">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1845">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1846">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, если он соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1846">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-1847">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1847">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-1848">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1848">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-1849"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1849">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-1850">Два других метода позволяют просматривать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1850">Two other methods allow you to peek messages in a queue.</span></span> <span data-ttu-id="51fc7-1851"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1851">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-1852">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1852">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1853">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1853">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1854">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1854">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1855">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1855">Local computer</span></span>|<span data-ttu-id="51fc7-1856">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1856">Yes</span></span>|  
|<span data-ttu-id="51fc7-1857">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1857">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1858">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1858">Yes</span></span>|  
|<span data-ttu-id="51fc7-1859">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1859">Remote computer</span></span>|<span data-ttu-id="51fc7-1860">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1860">No</span></span>|  
|<span data-ttu-id="51fc7-1861">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1861">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1862">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1862">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1863">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1863">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#5](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#5)]
 [!code-csharp[MessageQueue2#5](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1864">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1864">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1865">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1865">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1866">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1866">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1867">Сообщений до истечения тайм-аута не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1867">A message did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-1868">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-1868">-or-</span></span>  
  
 <span data-ttu-id="51fc7-1869">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1869">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.CorrelationId" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-1870">Возвращает копию сообщения с указанным идентификатором сообщения, не удаляя это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1870">Returns a copy of the message that has the specified message identifier without removing the message from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-1871">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1871">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <summary><span data-ttu-id="51fc7-1872">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1872">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1873">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1873">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1874">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, не удаляя его из очереди сообщения с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1874">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="51fc7-1875">Идентификатор сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1875">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="51fc7-1876">Эта перегрузка вызывает исключение, если в настоящий момент очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1876">This overload throws an exception if the queue does not currently contain the message.</span></span>  
  
 <span data-ttu-id="51fc7-1877">Два дополнительных метода позволяют просматривать сообщения из очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1877">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-1878"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1878">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1879">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1879">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1880">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1880">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1881">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1881">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1882">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1882">Local computer</span></span>|<span data-ttu-id="51fc7-1883">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1883">Yes</span></span>|  
|<span data-ttu-id="51fc7-1884">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1884">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1885">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1885">Yes</span></span>|  
|<span data-ttu-id="51fc7-1886">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1886">Remote computer</span></span>|<span data-ttu-id="51fc7-1887">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1887">No</span></span>|  
|<span data-ttu-id="51fc7-1888">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1888">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1889">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1889">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1890">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1890">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#6](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#6)]
 [!code-csharp[MessageQueue2#6](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#6)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1891">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1891">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1892">Нет сообщения с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1892">No message with the specified <paramref name="id" /> exists.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1893">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <Member MemberName="PeekById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekById(System::String ^ id, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-1894">Свойство <see cref="P:System.Messaging.Message.Id" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1894">The <see cref="P:System.Messaging.Message.Id" /> of the message to peek.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-1895">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1895">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="51fc7-1896">Считывает сообщение, идентификатор которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1896">Peeks the message whose message identifier matches the <paramref name="id" /> parameter.</span></span> <span data-ttu-id="51fc7-1897">Ожидает, пока сообщение не появится в очереди, или не возникнет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1897">Waits until the message appears in the queue or a time-out occurs.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1898">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1898">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1899">Используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> для чтения, не удаляя его из очереди сообщения с известным идентификатором сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1899">Use <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> to read, without removing from the queue, a message that has a known message identifier.</span></span> <span data-ttu-id="51fc7-1900">Идентификатор сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1900">The identifier of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="51fc7-1901">Эта перегрузка создает исключение, если в настоящий момент очереди нет сообщений, а новое сообщение не поступило до истечения времени ожидания.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1901">This overload throws an exception if the queue does not currently contain the message and a new message does not arrive before the time-out occurs.</span></span>  
  
 <span data-ttu-id="51fc7-1902">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1902">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-1903">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1903">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-1904">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, если он соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1904">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="51fc7-1905">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1905">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-1906">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1906">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-1907">Два дополнительных метода позволяют просматривать сообщения из очереди: <xref:System.Messaging.MessageQueue.Peek%2A> и <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1907">Two additional methods allow you to peek messages in a queue: <xref:System.Messaging.MessageQueue.Peek%2A> and <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-1908"><xref:System.Messaging.MessageQueue.Peek%2A> Метод возвращает первое сообщение в очереди. <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> возвращает подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1908">The <xref:System.Messaging.MessageQueue.Peek%2A> method returns the first message in the queue; <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> returns an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1909">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1909">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1910">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1910">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1911">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1911">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1912">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1912">Local computer</span></span>|<span data-ttu-id="51fc7-1913">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1913">Yes</span></span>|  
|<span data-ttu-id="51fc7-1914">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1914">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1915">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1915">Yes</span></span>|  
|<span data-ttu-id="51fc7-1916">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1916">Remote computer</span></span>|<span data-ttu-id="51fc7-1917">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1917">No</span></span>|  
|<span data-ttu-id="51fc7-1918">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1918">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1919">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1919">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1920">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1920">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.PeekById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#7](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#7)]
 [!code-csharp[MessageQueue2#7](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-1921">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1921">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-1922">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1922">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1923">Сообщение с заданным параметром <paramref name="id" /> не существует в очереди и не поступило до истечения периода времени, установленного параметром <paramref name="timeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1923">The message with the specified <paramref name="id" /> does not exist in the queue and did not arrive before the period specified by the <paramref name="timeout" /> parameter expired.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1924">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1924">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="P:System.Messaging.Message.Id" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
      </Docs>
    </Member>
    <MemberGroup MemberName="PeekByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-1925">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1925">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-1926">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1926">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="51fc7-1927">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1927">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="51fc7-1928">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1928">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at.</span></span></param>
        <summary><span data-ttu-id="51fc7-1929">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1929">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-1930">Считывает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1930">Peeks at the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1931">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1931">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1932">Используйте этот метод для чтения сообщения с известным кодом просмотра, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1932">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="51fc7-1933">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1933">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1934"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди которой находится сообщение, таким образом, не более одного сообщения в очереди, которое соответствует данной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1934">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-1935">Для чтения сообщения с указанным кодом просмотра и удалите его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1935">To read a message with a specified lookup identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-1936">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1936">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1937">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1937">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1938">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1938">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1939">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1939">Local computer</span></span>|<span data-ttu-id="51fc7-1940">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1940">Yes</span></span>|  
|<span data-ttu-id="51fc7-1941">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1941">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1942">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1942">Yes</span></span>|  
|<span data-ttu-id="51fc7-1943">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1943">Remote computer</span></span>|<span data-ttu-id="51fc7-1944">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1944">No</span></span>|  
|<span data-ttu-id="51fc7-1945">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1945">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1946">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1946">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-1947">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1947">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1948">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1948">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1949">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1949">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message PeekByLookupId (System.Messaging.MessageLookupAction action, long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message PeekByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.PeekByLookupId(System.Messaging.MessageLookupAction,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function PeekByLookupId (action As MessageLookupAction, lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ PeekByLookupId(System::Messaging::MessageLookupAction action, long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="51fc7-1950">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1950">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="51fc7-1951">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="51fc7-1951">Specify one of the following:</span></span>  
  
 <span data-ttu-id="51fc7-1952"><see langword="MessageLookupAction.Current" />: считывает сообщение, заданное параметром <c>lookupId</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1952"><see langword="MessageLookupAction.Current" />: Peeks at the message specified by <c>lookupId</c>.</span></span>  
  
 <span data-ttu-id="51fc7-1953"><see langword="MessageLookupAction.Next" />: считывает сообщение, следующее за сообщением, заданным параметром <c>lookupId</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1953"><see langword="MessageLookupAction.Next" />: Peeks at the message following the message specified by <c>lookupId</c>.</span></span>  
  
 <span data-ttu-id="51fc7-1954"><see langword="MessageLookupAction.Previous" />: считывает сообщение, предшествующее сообщению, заданному параметром <c>lookupId</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1954"><see langword="MessageLookupAction.Previous" />: Peeks at the message preceding the message specified by <c>lookupId</c>.</span></span>  
  
 <span data-ttu-id="51fc7-1955"><see langword="MessageLookupAction.First" />: считывает первое сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1955"><see langword="MessageLookupAction.First" />: Peeks at the first message in the queue.</span></span> <span data-ttu-id="51fc7-1956">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1956">The <c>lookupId</c> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="51fc7-1957"><see langword="MessageLookupAction.Last" />: считывает последнее сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1957"><see langword="MessageLookupAction.Last" />: Peeks at the last message in the queue.</span></span> <span data-ttu-id="51fc7-1958">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1958">The <c>lookupId</c> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="51fc7-1959">Свойство <see cref="P:System.Messaging.Message.LookupId" /> считываемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1959">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to peek at, or 0.</span></span> <span data-ttu-id="51fc7-1960">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1960">0 is used when accessing the first or last message in the queue.</span></span></param>
        <summary><span data-ttu-id="51fc7-1961">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1961">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-1962">Считывает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1962">Peeks at a specific message from the queue.</span></span> <span data-ttu-id="51fc7-1963">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1963">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-1964">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1964">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1965">Используйте этот метод для чтения сообщения с известным кодом просмотра, не удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1965">Use this method to read a message with a known lookup identifier without removing it from the queue.</span></span> <span data-ttu-id="51fc7-1966">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1966">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1967"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди которой находится сообщение, таким образом, не более одного сообщения в очереди, которое соответствует данной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1967">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-1968">Для чтения сообщения с указанным идентификатором и удалите его из очереди, используйте <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1968">To read a message with a specified identifier and remove it from the queue, use the <xref:System.Messaging.MessageQueue.ReceiveByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-1969">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1969">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1970">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1970">Workgroup mode</span></span>|<span data-ttu-id="51fc7-1971">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-1971">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-1972">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1972">Local computer</span></span>|<span data-ttu-id="51fc7-1973">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1973">Yes</span></span>|  
|<span data-ttu-id="51fc7-1974">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1974">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-1975">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1975">Yes</span></span>|  
|<span data-ttu-id="51fc7-1976">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-1976">Remote computer</span></span>|<span data-ttu-id="51fc7-1977">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-1977">No</span></span>|  
|<span data-ttu-id="51fc7-1978">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-1978">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-1979">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-1979">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-1980">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1980">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-1981">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1981">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-1982">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1982">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-1983">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1983">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.ReceiveByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="PeekCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.PeekCompletedEventHandler PeekCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.PeekCompletedEventHandler PeekCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.PeekCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event PeekCompleted As PeekCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::PeekCompletedEventHandler ^ PeekCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_PeekCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.PeekCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-1984">Происходит, когда сообщение читается без удаления из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1984">Occurs when a message is read without being removed from the queue.</span></span> <span data-ttu-id="51fc7-1985">Это результат асинхронной операции — <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1985">This is a result of the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginPeek" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> используется при асинхронной обработке, чтобы вызвать <xref:System.Messaging.MessageQueue.PeekCompleted> событие, если сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1986"><xref:System.Messaging.MessageQueue.BeginPeek%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.PeekCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> используется для завершения операции, запущенной с помощью вызова <xref:System.Messaging.MessageQueue.BeginPeek%2A> и просмотра сообщения при <xref:System.Messaging.MessageQueue.PeekCompleted> события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1987"><xref:System.Messaging.MessageQueue.EndPeek%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginPeek%2A> and peek the message when the <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="51fc7-1988">При создании делегата <xref:System.Messaging.PeekCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1988">When you create a <xref:System.Messaging.PeekCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="51fc7-1989">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1989">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="51fc7-1990">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1990">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="51fc7-1991">Дополнительные сведения о делегатах обработчиков событий см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="51fc7-1991">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-1992">В следующем примере кода создается обработчик событий с именем `MyPeekCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.PeekCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginPeek%2A> Чтобы инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-1992">The following code example creates an event handler named `MyPeekCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.PeekCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> to initiate an asynchronous peek operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="51fc7-1993">При <xref:System.Messaging.MessageQueue.PeekCompleted> события, в примере считывает сообщение и выводит его текст на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1993">When a <xref:System.Messaging.MessageQueue.PeekCompleted> event is raised, the example peeks the message and writes its body to the screen.</span></span> <span data-ttu-id="51fc7-1994">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginPeek%2A> еще раз, чтобы инициировать новую асинхронную операцию</span><span class="sxs-lookup"><span data-stu-id="51fc7-1994">The example then calls <xref:System.Messaging.MessageQueue.BeginPeek%2A> again to initiate a new asynchronous peek operation</span></span>  
  
 [!code-cpp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CPP/mqbeginpeek_noparms.cpp#1)]
 [!code-csharp[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/CS/mqbeginpeek_noparms.cs#1)]
 [!code-vb[MessageQueue.BeginPeek_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.BeginPeek_noparms/VB/mqbeginpeek_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Purge">
      <MemberSignature Language="C#" Value="public void Purge ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Purge() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Purge" />
      <MemberSignature Language="VB.NET" Value="Public Sub Purge ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Purge();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-1995">Удаляет все сообщения, содержащиеся в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1995">Deletes all the messages contained in the queue.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-1996">Очистка очереди вызывает сервер Message Queuing устанавливает флаг изменения очереди, который влияет на <xref:System.Messaging.MessageQueue.LastModifyTime%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1996">Purging the queue causes Message Queuing to set the queue modification flag, which affects the <xref:System.Messaging.MessageQueue.LastModifyTime%2A> property.</span></span> <span data-ttu-id="51fc7-1997">Удаленные из очереди сообщения утрачиваются. они не отправляются в очередь недоставленных сообщений или очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1997">Messages that are purged from the queue are lost; they are not sent to the dead-letter queue or the journal queue.</span></span>  
  
 <span data-ttu-id="51fc7-1998">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-1998">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-1999">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-1999">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2000">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2000">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2001">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2001">Local computer</span></span>|<span data-ttu-id="51fc7-2002">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2002">Yes</span></span>|  
|<span data-ttu-id="51fc7-2003">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2003">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2004">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2004">Yes</span></span>|  
|<span data-ttu-id="51fc7-2005">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2005">Remote computer</span></span>|<span data-ttu-id="51fc7-2006">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2006">No</span></span>|  
|<span data-ttu-id="51fc7-2007">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2007">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2008">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2008">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2009">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Purge%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2009">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Purge%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#29](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#29)]
 [!code-csharp[MessageQueue2#29](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#29)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2010">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2010">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Close" />
        <altmember cref="M:System.Messaging.MessageQueue.Refresh" />
      </Docs>
    </Member>
    <Member MemberName="QueueName">
      <MemberSignature Language="C#" Value="public string QueueName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string QueueName" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.QueueName" />
      <MemberSignature Language="VB.NET" Value="Public Property QueueName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ QueueName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_QueueName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-2011">Получает или задает понятное имя, определяющее очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2011">Gets or sets the friendly name that identifies the queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-2012">Имя, определяющее очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2012">The name that identifies the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-2013">Значение <see langword="null" /> недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2013">The value cannot be <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2014">Можно объединять <xref:System.Messaging.MessageQueue.QueueName%2A> с <xref:System.Messaging.MessageQueue.MachineName%2A> Создание понятное <xref:System.Messaging.MessageQueue.Path%2A> имя для очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2014">You can combine the <xref:System.Messaging.MessageQueue.QueueName%2A> with the <xref:System.Messaging.MessageQueue.MachineName%2A> to create a friendly <xref:System.Messaging.MessageQueue.Path%2A> name for the queue.</span></span> <span data-ttu-id="51fc7-2015">Синтаксис понятное имя разновидность <xref:System.Messaging.MessageQueue.Path%2A> свойство зависит от типа очереди, как показано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2015">The syntax for the friendly name variation of the <xref:System.Messaging.MessageQueue.Path%2A> property depends on the type of queue, as shown in the following table.</span></span>  
  
|<span data-ttu-id="51fc7-2016">Тип очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-2016">Queue type</span></span>|<span data-ttu-id="51fc7-2017">Синтаксис</span><span class="sxs-lookup"><span data-stu-id="51fc7-2017">Syntax</span></span>|  
|----------------|------------|  
|<span data-ttu-id="51fc7-2018">Общая очередь</span><span class="sxs-lookup"><span data-stu-id="51fc7-2018">Public queue</span></span>|`MachineName`\\`QueueName`|  
|<span data-ttu-id="51fc7-2019">Частной очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-2019">Private queue</span></span>|`MachineName`\\`Private$`\\`QueueName`|  
|<span data-ttu-id="51fc7-2020">Очередь журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-2020">Journal queue</span></span>|`MachineName`\\`QueueName`\\`Journal$`|  
  
 <span data-ttu-id="51fc7-2021">Используйте «.» для представления локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2021">Use "." to represent the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-2022">Изменение <xref:System.Messaging.MessageQueue.QueueName%2A> свойства влияет на <xref:System.Messaging.MessageQueue.Path%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2022">Changing the <xref:System.Messaging.MessageQueue.QueueName%2A> property affects the <xref:System.Messaging.MessageQueue.Path%2A> property.</span></span> <span data-ttu-id="51fc7-2023">Если задать <xref:System.Messaging.MessageQueue.QueueName%2A> без параметра <xref:System.Messaging.MessageQueue.MachineName%2A> свойства <xref:System.Messaging.MessageQueue.Path%2A> свойство становится.\\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2023">If you set the <xref:System.Messaging.MessageQueue.QueueName%2A> without setting the <xref:System.Messaging.MessageQueue.MachineName%2A> property, the <xref:System.Messaging.MessageQueue.Path%2A> property becomes .\\`QueueName`.</span></span> <span data-ttu-id="51fc7-2024">В противном случае <xref:System.Messaging.MessageQueue.Path%2A> становится `MachineName` \\ `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2024">Otherwise, the <xref:System.Messaging.MessageQueue.Path%2A> becomes `MachineName`\\`QueueName`.</span></span>  
  
 <span data-ttu-id="51fc7-2025">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2025">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2026">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2026">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2027">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2027">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2028">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2028">Local computer</span></span>|<span data-ttu-id="51fc7-2029">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2029">Yes</span></span>|  
|<span data-ttu-id="51fc7-2030">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2030">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2031">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2031">Yes</span></span>|  
|<span data-ttu-id="51fc7-2032">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2032">Remote computer</span></span>|<span data-ttu-id="51fc7-2033">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2033">Yes</span></span>|  
|<span data-ttu-id="51fc7-2034">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2034">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2035">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2035">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2036">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.QueueName%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2036">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.QueueName%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2037">Значение имени очереди — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2037">The queue name is <see langword="null" />.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="P:System.Messaging.MessageQueue.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="ReadHandle">
      <MemberSignature Language="C#" Value="public IntPtr ReadHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int ReadHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.ReadHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ReadHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr ReadHandle { IntPtr get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReadHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-2038">Получает собственный дескриптор, предназначенный для чтения сообщений из очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2038">Gets the native handle used to read messages from the message queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-2039">Дескриптор собственного объекта очереди, который используется для считывания и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2039">A handle to the native queue object that you use for peeking and receiving messages from the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2040"><xref:System.Messaging.MessageQueue.ReadHandle%2A> Предоставляет собственный дескриптор Windows для объекта очереди сообщений, который используется для просмотра и получения сообщений из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2040">The <xref:System.Messaging.MessageQueue.ReadHandle%2A> provides a native Windows handle to the message queue object that is used for peeking and receiving messages from the queue.</span></span> <span data-ttu-id="51fc7-2041">Если изменить путь к очереди, дескриптор закрыт и открыт повторно с новым значением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2041">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="51fc7-2042">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2042">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2043">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2043">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2044">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2044">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2045">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2045">Local computer</span></span>|<span data-ttu-id="51fc7-2046">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2046">Yes</span></span>|  
|<span data-ttu-id="51fc7-2047">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2047">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2048">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2048">Yes</span></span>|  
|<span data-ttu-id="51fc7-2049">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2049">Remote computer</span></span>|<span data-ttu-id="51fc7-2050">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2050">No</span></span>|  
|<span data-ttu-id="51fc7-2051">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2051">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2052">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2052">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2053">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2053">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanRead" />
        <altmember cref="P:System.Messaging.MessageQueue.WriteHandle" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Receive">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <threadsafe><span data-ttu-id="51fc7-2054">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2054">The method is not thread safe.</span></span></threadsafe>
        <summary><span data-ttu-id="51fc7-2055">Получает первое сообщение в очереди, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2055">Receives the first message in the queue, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive () As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-2056">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2056">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-2057">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2057">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2058">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2058">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2059">Используйте эту перегрузку для получения сообщения из очереди, или подождать, пока в очереди имеются сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2059">Use this overload to receive a message from a queue, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2060"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2060">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2061">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2061">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="51fc7-2062">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2062">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2063"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2063">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2064">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2064">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2065">Поскольку в этой перегрузке <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать в течение неограниченного времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2065">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="51fc7-2066">Если работа приложения должна продолжать выполнение без ожидания для сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2066">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2067">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2067">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2068">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2068">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2069">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2069">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2070">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2070">Local computer</span></span>|<span data-ttu-id="51fc7-2071">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2071">Yes</span></span>|  
|<span data-ttu-id="51fc7-2072">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2072">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2073">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2073">Yes</span></span>|  
|<span data-ttu-id="51fc7-2074">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2074">Remote computer</span></span>|<span data-ttu-id="51fc7-2075">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2075">No</span></span>|  
|<span data-ttu-id="51fc7-2076">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2076">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2077">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2077">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2078">В следующем примере кода получает сообщение из очереди и выводит сведения о сообщении на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2078">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_noparms#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CPP/mqreceive_noparms.cpp#1)]
 [!code-csharp[MessageQueue.Receive_noparms#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_noparms/CS/mqreceive_noparms.cs#1)]
 [!code-vb[MessageQueue.Receive_noparms#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_noparms/VB/mqreceive_noparms.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2079">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2079">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="transaction"><span data-ttu-id="51fc7-2080">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2080">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2081">Получает первое доступное в транзакционной очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2081">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-2082">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2082">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2083">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2083">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2084">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` параметра или подождите, пока в очереди имеются сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2084">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2085"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2085">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2086">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2086">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2087">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2087">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2088">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2088">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2089">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2089">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2090"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2090">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2091">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2091">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2092">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует для отката при вызове <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2092">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2093">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2093">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2094">Поскольку в этой перегрузке <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать в течение неограниченного времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2094">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="51fc7-2095">Если работа приложения должна продолжать выполнение без ожидания для сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2095">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2096">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2096">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2097">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2097">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2098">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2098">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2099">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2099">Local computer</span></span>|<span data-ttu-id="51fc7-2100">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2100">Yes</span></span>|  
|<span data-ttu-id="51fc7-2101">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2101">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2102">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2102">Yes</span></span>|  
|<span data-ttu-id="51fc7-2103">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2103">Remote computer</span></span>|<span data-ttu-id="51fc7-2104">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2104">No</span></span>|  
|<span data-ttu-id="51fc7-2105">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2105">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2106">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2106">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2107">В следующем примере кода осуществляется подключение к транзакционной очереди на локальном компьютере и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2107">The following code example connects to a transactional queue on the local computer and sends a message to the queue.</span></span> <span data-ttu-id="51fc7-2108">Затем он получает сообщение, содержащее заказ.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2108">It then receives the message that contains an order.</span></span> <span data-ttu-id="51fc7-2109">Если встретится нетранзакционная очередь, вызовет исключение и производится откат транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2109">If it encounters a non-transactional queue, it will throw and exception and rollback the transaction.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_transaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CPP/mqreceive_transaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_transaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_transaction/CS/mqreceive_transaction.cs#1)]
 [!code-vb[MessageQueue.Receive_transaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_transaction/VB/mqreceive_transaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2110">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2110">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="51fc7-2111">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2111">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2112">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2112">The queue is non-transactional.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2113">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2113">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="transactionType"><span data-ttu-id="51fc7-2114">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2114">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2115">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2115">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-2116">Этот вызов является синхронным и он блокирует текущий поток выполнения, пока сообщение не станет доступным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2116">This call is synchronous, and blocks the current thread of execution until a message is available.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2117">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2117">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2118">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` параметра или подождите, пока в очереди имеются сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2118">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, or wait until there are messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2119">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2119">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2120">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2120">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2121">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2121">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2122"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2122">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2123">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2123">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2124">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2124">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2125">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2125">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2126">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2126">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2127"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2127">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2128">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2128">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2129">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует для отката при вызове <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2129">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2130">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2130">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2131">Поскольку в этой перегрузке <xref:System.Messaging.MessageQueue.Receive%2A> метод задает неограниченное время ожидания, приложение может ожидать в течение неограниченного времени.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2131">Because this overload of the <xref:System.Messaging.MessageQueue.Receive%2A> method specifies an infinite time-out, the application might wait indefinitely.</span></span> <span data-ttu-id="51fc7-2132">Если работа приложения должна продолжать выполнение без ожидания для сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2132">If the application processing should continue without waiting for the message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2133">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2133">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2134">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2134">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2135">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2135">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2136">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2136">Local computer</span></span>|<span data-ttu-id="51fc7-2137">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2137">Yes</span></span>|  
|<span data-ttu-id="51fc7-2138">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2138">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2139">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2139">Yes</span></span>|  
|<span data-ttu-id="51fc7-2140">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2140">Remote computer</span></span>|<span data-ttu-id="51fc7-2141">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2141">No</span></span>|  
|<span data-ttu-id="51fc7-2142">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2142">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2143">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2143">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2144">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2144">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Receive%28System.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#9](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#9)]
 [!code-csharp[MessageQueue2#9](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2145">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2145">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2146">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2146">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2147">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2147">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2148">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2148">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="51fc7-2149">Получает первое сообщение, доступное в очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2149">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2150">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2150">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2151">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2151">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2152"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаление его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2152">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, removing it from the queue.</span></span> <span data-ttu-id="51fc7-2153">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди, или новые сообщения с более высоким приоритетом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2153">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue, or new, higher priority messages.</span></span>  
  
 <span data-ttu-id="51fc7-2154">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2154">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2155"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2155">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2156">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2156">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2157">Поток будет заблокирован за указанный период времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2157">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2158">Если работа приложения должна продолжить работу без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2158">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2159">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2159">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2160">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2160">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2161">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2161">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2162">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2162">Local computer</span></span>|<span data-ttu-id="51fc7-2163">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2163">Yes</span></span>|  
|<span data-ttu-id="51fc7-2164">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2164">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2165">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2165">Yes</span></span>|  
|<span data-ttu-id="51fc7-2166">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2166">Remote computer</span></span>|<span data-ttu-id="51fc7-2167">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2167">No</span></span>|  
|<span data-ttu-id="51fc7-2168">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2168">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2169">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2169">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2170">В следующем примере кода получает сообщение из очереди и выводит сведения о сообщении на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2170">The following code example receives a message from a queue and outputs information about that message to the screen.</span></span> <span data-ttu-id="51fc7-2171">В примере приостанавливается выполнение до пяти секунд, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2171">The example pauses execution for up to five seconds while waiting for a message to arrive in the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_timeout#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CPP/mqreceive_timeout.cpp#1)]
 [!code-csharp[MessageQueue.Receive_timeout#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_timeout/CS/mqreceive_timeout.cs#1)]
 [!code-vb[MessageQueue.Receive_timeout#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_timeout/VB/mqreceive_timeout.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2172">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2172">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2173">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2173">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2174">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2174">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2175">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2175">An error occurred when accessing a Message Queuing method</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2176">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2176">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2177">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2177">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-2178">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2178">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <summary><span data-ttu-id="51fc7-2179">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2179">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="51fc7-2180">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2180">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2181">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2181">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2182">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2182">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2183">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2183">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2184">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2184">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2185">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2185">An error occurred when accessing a Message Queuing method</span></span>  
  
 <span data-ttu-id="51fc7-2186">Используйте эту перегрузку для получения сообщений и их возврата в течение указанного срока, если в очереди нет сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2186">Use this overload to receive a message and return in a specified period of time if there are no messages in the queue.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2187">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2187">The method is not thread safe.</span></span></threadsafe>
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2188">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2188">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2189">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2189">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2190">Получает первое сообщение, доступное в транзакционной очереди, на которую ссылается объект <see cref="T:System.Messaging.MessageQueue" />, и ожидает, пока в очереди не появится сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2190">Receives the first message available in the transactional queue referenced by the <see cref="T:System.Messaging.MessageQueue" /> and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2191">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2191">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2192">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2192">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2193"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2193">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2194">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2194">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2195">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2195">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2196">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2196">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2197">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2197">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2198"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2198">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2199">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2199">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2200">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует для отката при вызове <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2200">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2201">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2201">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2202">Поток будет заблокирован за указанный период времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2202">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2203">Если работа приложения должна продолжить работу без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2203">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2204">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2204">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2205">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2205">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2206">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2206">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2207">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2207">Local computer</span></span>|<span data-ttu-id="51fc7-2208">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2208">Yes</span></span>|  
|<span data-ttu-id="51fc7-2209">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2209">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2210">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2210">Yes</span></span>|  
|<span data-ttu-id="51fc7-2211">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2211">Remote computer</span></span>|<span data-ttu-id="51fc7-2212">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2212">No</span></span>|  
|<span data-ttu-id="51fc7-2213">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2213">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2214">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2214">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2215">В следующем примере кода показано использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2215">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CPP/mqreceive_timeouttransaction.cpp#1)]
 [!code-csharp[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/CS/mqreceive_timeouttransaction.cs#1)]
 [!code-vb[MessageQueue.Receive_TimeoutTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Receive_TimeoutTransaction/VB/mqreceive_timeouttransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2216">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2216">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2217">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2217">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2218">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2218">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2219">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2219">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2220">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2220">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2221">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2221">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2222">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2222">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function Receive (timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2223">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2223">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2224">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2224">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2225">Получает первое доступное в очереди сообщение, на которое ссылается объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2225">Receives the first message available in the queue referenced by the <see cref="T:System.Messaging.MessageQueue" />.</span></span> <span data-ttu-id="51fc7-2226">Данный вызов является синхронным, и он ожидает, пока в очереди не появится сообщение, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2226">This call is synchronous, and waits until either a message is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2227">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на первое доступное в очереди сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2227">A <see cref="T:System.Messaging.Message" /> that references the first message available in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2228">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2228">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2229">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2229">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2230">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2230">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2231">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2231">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2232"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2232">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2233">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращает сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2233">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> will return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2234">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2234">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2235">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2235">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2236">Для чтения первого сообщения в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2236">To read the first message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2237"><xref:System.Messaging.MessageQueue.Peek%2A> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2237">The <xref:System.Messaging.MessageQueue.Peek%2A> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2238">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2238">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2239">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, отсутствует для отката при вызове <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2239">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there would be nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2240">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2240">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2241">Поток будет заблокирован за указанный период времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2241">The thread will be blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2242">Если работа приложения должна продолжить работу без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2242">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2243">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2243">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2244">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2244">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2245">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2245">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2246">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2246">Local computer</span></span>|<span data-ttu-id="51fc7-2247">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2247">Yes</span></span>|  
|<span data-ttu-id="51fc7-2248">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2248">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2249">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2249">Yes</span></span>|  
|<span data-ttu-id="51fc7-2250">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2250">Remote computer</span></span>|<span data-ttu-id="51fc7-2251">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2251">No</span></span>|  
|<span data-ttu-id="51fc7-2252">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2252">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2253">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2253">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2254">В следующем примере кода показано использование этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2254">The following code example demonstrates the use of this method.</span></span>  
  
 [!code-cpp[MessageQueue2#8](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#8)]
 [!code-csharp[MessageQueue2#8](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2255">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2255">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2256">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2256">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2257">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2257">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2258">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2258">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2259">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2259">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2260">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2260">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2261">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2261">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-2262">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2262">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2263">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2263">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2264">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2264">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="51fc7-2265">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2265">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2266">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2266">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2267">Используйте этот перегруженный метод для получения сообщения из транзакционной очереди с помощью контекста внутренней транзакции, определенного `transaction` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2267">Use this overload to receive a message from a transactional queue using the internal transaction context defined by the `transaction` parameter, and return within a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2268"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2268">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2269">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2269">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2270">Так как этот метод вызывается в транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2270">Because this method is called on a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2271">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2271">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2272">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2272">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2273">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2273">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2274">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, не требуется откатить путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2274">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2275">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2275">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2276">Поток заблокирован за указанный период времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2276">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2277">Если работа приложения должна продолжить работу без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2277">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2278">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2278">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2279">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2279">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2280">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2280">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2281">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2281">Local computer</span></span>|<span data-ttu-id="51fc7-2282">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2282">Yes</span></span>|  
|<span data-ttu-id="51fc7-2283">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2283">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2284">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2284">Yes</span></span>|  
|<span data-ttu-id="51fc7-2285">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2285">Remote computer</span></span>|<span data-ttu-id="51fc7-2286">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2286">No</span></span>|  
|<span data-ttu-id="51fc7-2287">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2287">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2288">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2288">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2289">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2289">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-2290">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2290">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2291">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2291">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2292">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2292">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="51fc7-2293">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2293">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2294">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2294">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2295">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2295">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2296">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2296">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2297">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2297">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2298">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2298">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2299">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2299">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Receive">
      <MemberSignature Language="C#" Value="public System.Messaging.Message Receive (TimeSpan timeout, System.Messaging.Cursor cursor, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message Receive(valuetype System.TimeSpan timeout, class System.Messaging.Cursor cursor, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Receive(System.TimeSpan,System.Messaging.Cursor,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ Receive(TimeSpan timeout, System::Messaging::Cursor ^ cursor, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="cursor" Type="System.Messaging.Cursor" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="timeout"><span data-ttu-id="51fc7-2300">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2300">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="cursor"><span data-ttu-id="51fc7-2301">Объект <see cref="T:System.Messaging.Cursor" />, который сохраняет определенное положение в очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2301">A <see cref="T:System.Messaging.Cursor" /> that maintains a specific position in the message queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2302">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2302">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values that describes the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2303">Получает текущее сообщение в очереди, используя заданный курсор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2303">Receives the current message in the queue, using a specified cursor.</span></span> <span data-ttu-id="51fc7-2304">Если доступных сообщений нет, этот метод ожидает, пока не станет доступным сообщение или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2304">If no message is available, this method waits until either a message is available, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2305">Объект <see cref="T:System.Messaging.Message" />, ссылающийся на сообщение в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2305">A <see cref="T:System.Messaging.Message" /> that references a message in the queue.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2306">Используйте эту перегрузку для получения сообщения из очереди с помощью контекста транзакции, определенного `transactionType` и возврата в указанный период времени, если нет сообщений в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2306">Use this overload to receive a message from a queue using a transaction context defined by the `transactionType` parameter, and return in a specified period of time if there are no messages in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2307">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2307">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2308">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2308">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2309">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2309">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2310"><xref:System.Messaging.MessageQueue.Receive%2A> Метод позволяет осуществлять синхронное чтение сообщения, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2310">The <xref:System.Messaging.MessageQueue.Receive%2A> method allows for the synchronous reading of a message, thereby removing it from the queue.</span></span> <span data-ttu-id="51fc7-2311">Последующие вызовы <xref:System.Messaging.MessageQueue.Receive%2A> возвращают сообщения, которые расположены в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2311">Subsequent calls to <xref:System.Messaging.MessageQueue.Receive%2A> return the messages that follow in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2312">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение возвращается в очередь, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2312">If this method is called to receive a message from a transactional queue, the message that is received is returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2313">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2313">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2314">Чтобы прочитать сообщение в очереди, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.Peek%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2314">To read a message in a queue without removing it from the queue, use the <xref:System.Messaging.MessageQueue.Peek%2A> method.</span></span> <span data-ttu-id="51fc7-2315">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.Peek%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2315">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.Peek%2A>.</span></span> <span data-ttu-id="51fc7-2316">Поскольку <xref:System.Messaging.MessageQueue.Peek%2A> не удаляет сообщения из очереди, не требуется откатить путем вызова <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2316">Because <xref:System.Messaging.MessageQueue.Peek%2A> does not remove any messages in the queue, there is nothing to roll back by a call to <xref:System.Messaging.MessageQueueTransaction.Abort%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2317">Использовать вызов <xref:System.Messaging.MessageQueue.Receive%2A> Если текущий поток можно заблокировать, пока ожидается поступление в очередь сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2317">Use a call to <xref:System.Messaging.MessageQueue.Receive%2A> when it is acceptable for the current thread to be blocked while it waits for a message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2318">Поток заблокирован за указанный период времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2318">The thread is blocked for the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2319">Если работа приложения должна продолжить работу без ожидания сообщения, рассмотрите возможность использования асинхронного метода <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2319">If the application processing should continue without waiting for a message, consider using the asynchronous method, <xref:System.Messaging.MessageQueue.BeginReceive%2A>.</span></span>  
  
 <span data-ttu-id="51fc7-2320">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2320">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2321">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2321">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2322">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2322">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2323">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2323">Local computer</span></span>|<span data-ttu-id="51fc7-2324">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2324">Yes</span></span>|  
|<span data-ttu-id="51fc7-2325">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2325">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2326">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2326">Yes</span></span>|  
|<span data-ttu-id="51fc7-2327">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2327">Remote computer</span></span>|<span data-ttu-id="51fc7-2328">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2328">No</span></span>|  
|<span data-ttu-id="51fc7-2329">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2329">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2330">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2330">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2331">Параметр <paramref name="cursor" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2331">The <paramref name="cursor" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2332">Значение, заданное для параметра <paramref name="timeout" />, недопустимо.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2332">The value specified for the <paramref name="timeout" /> parameter is not valid.</span></span> <span data-ttu-id="51fc7-2333">Возможно, значение параметра <paramref name="timeout" /> меньше, чем <see cref="F:System.TimeSpan.Zero" />, или больше, чем <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2333">Possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2334">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2334">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2335">До истечения тайм-аута в очередь сообщений не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2335">A message did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2336">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2336">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2337">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2337">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <threadsafe><span data-ttu-id="51fc7-2338">Метод не является потокобезопасным.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2338">The method is not thread safe.</span></span></threadsafe>
        <altmember cref="T:System.Messaging.Cursor" />
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByCorrelationId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-2339">Получает сообщение, которое соответствует заданному идентификатору корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2339">Receives a message that matches a given correlation identifier.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2340">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2340">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="51fc7-2341">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2341">Receives the message that matches the given correlation identifier (from a non-transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2342">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2342">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2343">Метод ищет в нетранзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2343">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2344">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2344">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="51fc7-2345">В противном случае сообщение удаляется из очереди и возвращается в приложение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2345">Otherwise, the message is removed from the queue and returned to the application.</span></span>  
  
 <span data-ttu-id="51fc7-2346"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2346">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2347">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2347">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2348"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод получает сообщение, указав его идентификатор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2348">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method retrieves a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2349">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2349">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2350"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2350">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2351">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2351">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2352">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2352">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2353">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2353">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2354">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2354">Local computer</span></span>|<span data-ttu-id="51fc7-2355">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2355">Yes</span></span>|  
|<span data-ttu-id="51fc7-2356">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2356">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2357">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2357">Yes</span></span>|  
|<span data-ttu-id="51fc7-2358">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2358">Remote computer</span></span>|<span data-ttu-id="51fc7-2359">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2359">No</span></span>|  
|<span data-ttu-id="51fc7-2360">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2360">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2361">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2361">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2362">В следующем примере кода отправляет и получает сообщение, содержащее заказ в и из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2362">The following code example sends and receives a message that contains an order to and from a queue.</span></span> <span data-ttu-id="51fc7-2363">Он специально запрашивается положительное подтверждение, когда исходное сообщение достигает или извлечено из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2363">It specifically requests a positive acknowledgment when the original message reaches or is retrieved from the queue.</span></span>  
  
 [!code-cpp[Message.Acknowledgment#1](~/samples/snippets/cpp/VS_Snippets_Remoting/Message.Acknowledgment/CPP/message_acknowledgment.cpp#1)]
 [!code-csharp[Message.Acknowledgment#1](~/samples/snippets/csharp/VS_Snippets_Remoting/Message.Acknowledgment/CS/message_acknowledgment.cs#1)]
 [!code-vb[Message.Acknowledgment#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/Message.Acknowledgment/VB/message_acknowledgment.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2364">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2364">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2365">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2365">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2366">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2366">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2367">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2367">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2368">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2368">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2369">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2369">Receives the message that matches the given correlation identifier (from a transactional queue) and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2370">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2370">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2371">Метод ищет в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2371">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2372">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2372">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="51fc7-2373">В противном случае сообщение удаляется из очереди и возвращается в приложение с помощью контекста внутренней транзакции, определенного `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2373">Otherwise, the message is removed from the queue and returned to the application using the internal transaction context defined by the `transaction` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2374">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2374">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2375">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2375">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2376"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2376">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2377">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2377">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2378"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2378">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2379">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2379">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2380"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2380">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2381">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2381">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2382">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2382">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2383">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2383">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2384">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2384">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2385">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2385">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2386">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2386">Local computer</span></span>|<span data-ttu-id="51fc7-2387">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2387">Yes</span></span>|  
|<span data-ttu-id="51fc7-2388">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2388">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2389">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2389">Yes</span></span>|  
|<span data-ttu-id="51fc7-2390">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2390">Remote computer</span></span>|<span data-ttu-id="51fc7-2391">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2391">No</span></span>|  
|<span data-ttu-id="51fc7-2392">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2392">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2393">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2393">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2394">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2394">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#14](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#14)]
 [!code-csharp[MessageQueue2#14](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2395">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2395">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-2396">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2396">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2397">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2397">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2398">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2398">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2399">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2399">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2400">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2400">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2401">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2401">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2402">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2402">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2403">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2403">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2404">Получает сообщение, которое соответствует заданному идентификатору корреляции, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором корреляции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2404">Receives the message that matches the given correlation identifier and immediately raises an exception if no message with the specified correlation identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2405">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2405">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2406">Метод ищет в очереди, на который указывает <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2406">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2407">Если сообщение не найдено, соответствующий `correlationID` параметра, возникает исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2407">If no message is found that matches the `correlationID` parameter, an exception is thrown.</span></span> <span data-ttu-id="51fc7-2408">В противном случае сообщение удаляется из очереди и возвращается приложению, используя контекст транзакции, определяемый параметром `transactionType` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2408">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2409">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2409">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2410">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2410">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2411">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2411">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2412">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2412">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2413">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2413">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2414"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2414">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2415">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2415">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2416"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2416">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2417">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2417">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2418"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2418">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2419">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2419">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2420">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2420">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2421">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2421">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2422">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2422">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2423">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2423">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2424">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2424">Local computer</span></span>|<span data-ttu-id="51fc7-2425">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2425">Yes</span></span>|  
|<span data-ttu-id="51fc7-2426">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2426">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2427">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2427">Yes</span></span>|  
|<span data-ttu-id="51fc7-2428">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2428">Remote computer</span></span>|<span data-ttu-id="51fc7-2429">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2429">No</span></span>|  
|<span data-ttu-id="51fc7-2430">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2430">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2431">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2431">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2432">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2432">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#11](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#11)]
 [!code-csharp[MessageQueue2#11](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#11)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2433">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2433">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2434">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2434">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2435">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2435">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2436">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2436">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2437">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2437">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2438">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2438">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="51fc7-2439">Получает сообщение, которое соответствует заданному идентификатору корреляции (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2439">Receives the message that matches the given correlation identifier (from a non-transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2440">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2440">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2441">Метод ищет в нетранзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2441">This method looks in the non-transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2442">Этот метод возвращает немедленно, если сообщение с кодом корреляции, указанным `correlationId` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2442">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue.</span></span> <span data-ttu-id="51fc7-2443">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2443">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2444">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2444">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2445">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2445">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2446">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2446">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2447">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, если он соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2447">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2448">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2448">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2449">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2449">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2450"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2450">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2451">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2451">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2452"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2452">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2453">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2453">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2454"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2454">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2455">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2455">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2456">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2456">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2457">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2457">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2458">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2458">Local computer</span></span>|<span data-ttu-id="51fc7-2459">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2459">Yes</span></span>|  
|<span data-ttu-id="51fc7-2460">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2460">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2461">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2461">Yes</span></span>|  
|<span data-ttu-id="51fc7-2462">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2462">Remote computer</span></span>|<span data-ttu-id="51fc7-2463">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2463">No</span></span>|  
|<span data-ttu-id="51fc7-2464">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2464">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2465">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2465">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2466">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2466">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#10](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#10)]
 [!code-csharp[MessageQueue2#10](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#10)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2467">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2467">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2468">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2468">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2469">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2469">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2470">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2470">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2471">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2471">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2472">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2472">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2473">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2473">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2474">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2474">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2475">Получает сообщение, которое соответствует заданному идентификатору корреляции (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2475">Receives the message that matches the given correlation identifier (from a transactional queue) and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2476">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2476">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2477">Метод ищет в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2477">This method looks in the transactional queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2478">Этот метод возвращает немедленно, если сообщение с кодом корреляции, указанным `correlationId` параметр находится в очереди, с помощью контекста внутренней транзакции, определенного `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2478">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-2479">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2479">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2480">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2480">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2481">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2481">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2482">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2482">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2483">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, если он соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2483">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2484">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2484">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2485">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2485">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2486">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2486">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2487">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2487">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2488"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2488">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2489">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2489">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2490"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2490">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2491">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2491">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2492"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2492">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2493">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2493">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2494">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2494">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2495">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2495">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2496">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2496">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2497">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2497">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2498">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2498">Local computer</span></span>|<span data-ttu-id="51fc7-2499">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2499">Yes</span></span>|  
|<span data-ttu-id="51fc7-2500">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2500">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2501">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2501">Yes</span></span>|  
|<span data-ttu-id="51fc7-2502">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2502">Remote computer</span></span>|<span data-ttu-id="51fc7-2503">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2503">No</span></span>|  
|<span data-ttu-id="51fc7-2504">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2504">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2505">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2505">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2506">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2506">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#13](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#13)]
 [!code-csharp[MessageQueue2#13](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2507">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2507">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-2508">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2508">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2509">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2509">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2510">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2510">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2511">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2511">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2512">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2512">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2513">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2513">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2514">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2514">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2515">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2515">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByCorrelationId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByCorrelationId (string correlationId, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByCorrelationId(string correlationId, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByCorrelationId(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByCorrelationId (correlationId As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByCorrelationId(System::String ^ correlationId, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="correlationId" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="correlationId"><span data-ttu-id="51fc7-2516">Свойство <see cref="P:System.Messaging.Message.CorrelationId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2516">The <see cref="P:System.Messaging.Message.CorrelationId" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2517">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2517">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2518">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2518">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2519">Получает сообщение, которое соответствует заданному идентификатору корреляции и ожидает, пока в очереди не появится сообщение с указанным идентификатором корреляции или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2519">Receives the message that matches the given correlation identifier and waits until either a message with the specified correlation identifier is available in the queue, or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2520">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.CorrelationId" /> которого соответствует переданному в объект параметру <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2520">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.CorrelationId" /> matches the <paramref name="correlationId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2521">Метод ищет в очереди, на который указывает <xref:System.Messaging.MessageQueue> сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует указанному `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2521">This method looks in the queue referenced by the <xref:System.Messaging.MessageQueue> for a message whose <xref:System.Messaging.Message.CorrelationId%2A> matches the specified `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2522">Этот метод возвращает немедленно, если сообщение с кодом корреляции, указанным `correlationId` параметр находится в очереди, используя контекст транзакции, определяемый параметром `transactionType` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2522">This method returns immediately if the message with the correlation identifier specified by the `correlationId` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="51fc7-2523">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2523">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2524">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2524">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2525">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2525">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2526">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2526">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2527">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.CorrelationId%2A> нового сообщения, если он соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2527">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.CorrelationId%2A> of the new message to see if it matches the `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2528">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2528">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2529">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.CorrelationId%2A> соответствует `correlationId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2529">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.CorrelationId%2A> matches the `correlationId` parameter.</span></span> <span data-ttu-id="51fc7-2530">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2530">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2531">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2531">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2532">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2532">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2533">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2533">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2534">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2534">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2535"><xref:System.Messaging.Message.CorrelationId%2A> Свойство используется для привязки сообщения, отправленного в очередь на связанные сообщения ответа, отчет или подтверждение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2535">The <xref:System.Messaging.Message.CorrelationId%2A> property is used to tie a message sent to the queue to associated response, report, or acknowledgment messages.</span></span>  
  
 <span data-ttu-id="51fc7-2536">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2536">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2537"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> метод используется для извлечения сообщения путем указания его уникального идентификатора.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2537">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> method is used to retrieve a message by specifying its unique identifier.</span></span>  
  
 <span data-ttu-id="51fc7-2538">Для чтения сообщения с указанным кодом корреляции, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2538">To read a message with a specified correlation identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2539"><xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2539">The <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2540">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2540">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2541">Поскольку <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2541">Because <xref:System.Messaging.MessageQueue.PeekByCorrelationId%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2542">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2542">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2543">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2543">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2544">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2544">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2545">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2545">Local computer</span></span>|<span data-ttu-id="51fc7-2546">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2546">Yes</span></span>|  
|<span data-ttu-id="51fc7-2547">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2547">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2548">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2548">Yes</span></span>|  
|<span data-ttu-id="51fc7-2549">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2549">Remote computer</span></span>|<span data-ttu-id="51fc7-2550">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2550">No</span></span>|  
|<span data-ttu-id="51fc7-2551">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2551">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2552">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2552">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2553">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2553">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#12](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#12)]
 [!code-csharp[MessageQueue2#12](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#12)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2554">Параметр <paramref name="correlationId" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2554">The <paramref name="correlationId" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2555">Не удалось найти сообщение с указанным параметром <paramref name="correlationId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2555">The message with the specified <paramref name="correlationId" /> could not be found.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2556">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2556">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2557">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2557">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2558">Сообщение с заданным параметром <paramref name="correlationId" /> не существует в очереди и не поступило до истечения тайм-аута.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2558">The message with the specified <paramref name="correlationId" /> does not exist in the queue and did not arrive before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2559">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2559">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2560">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2560">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveById">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-2561">Получает сообщение, которое соответствует заданному идентификатору, удаляя его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2561">Receives the message that matches the given identifier, removing it from the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2562">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2562">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="51fc7-2563">Получает из нетранзакционной очереди сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2563">Receives the message that matches the given identifier from a non-transactional queue and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2564">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2564">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2565">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2565">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="51fc7-2566">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2566">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2567"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2567">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2568">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2568">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2569"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2569">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2570">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2570">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2571"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2571">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2572">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2572">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2573">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2573">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2574">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2574">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2575">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2575">Local computer</span></span>|<span data-ttu-id="51fc7-2576">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2576">Yes</span></span>|  
|<span data-ttu-id="51fc7-2577">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2577">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2578">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2578">Yes</span></span>|  
|<span data-ttu-id="51fc7-2579">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2579">Remote computer</span></span>|<span data-ttu-id="51fc7-2580">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2580">No</span></span>|  
|<span data-ttu-id="51fc7-2581">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2581">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2582">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2582">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2583">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2583">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#16](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#16)]
 [!code-csharp[MessageQueue2#16](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#16)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2584">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2584">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2585">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2585">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2586">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2586">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2587">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2587">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2588">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2588">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2589">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2589">Receives the message that matches the given identifier (from a transactional queue) and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2590">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2590">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2591">Используйте этот метод для чтения сообщения с известным идентификатором и удалите его из очереди, с помощью контекста внутренней транзакции, определенного `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2591">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-2592">Этот метод немедленно создает исключение, если сообщение не находится в очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-2592">This method throws an exception immediately if the message is not in the queue</span></span>  
  
 <span data-ttu-id="51fc7-2593"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2593">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2594">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2594">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2595">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2595">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2596">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2596">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2597"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2597">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2598">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2598">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2599"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2599">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2600">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2600">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2601">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2601">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2602">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2602">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2603">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2603">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2604">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2604">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2605">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2605">Local computer</span></span>|<span data-ttu-id="51fc7-2606">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2606">Yes</span></span>|  
|<span data-ttu-id="51fc7-2607">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2607">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2608">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2608">Yes</span></span>|  
|<span data-ttu-id="51fc7-2609">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2609">Remote computer</span></span>|<span data-ttu-id="51fc7-2610">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2610">No</span></span>|  
|<span data-ttu-id="51fc7-2611">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2611">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2612">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2612">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2613">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2613">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#17](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#17)]
 [!code-csharp[MessageQueue2#17](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2614">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2614">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-2615">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2615">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2616">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2616">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2617">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2617">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2618">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2618">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2619">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2619">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2620">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2620">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2621">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2621">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2622">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2622">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2623">Получает сообщение, которое соответствует заданному идентификатору, и сразу инициирует исключение, если в настоящий момент в очереди нет сообщения с указанным идентификатором.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2623">Receives the message that matches the given identifier and immediately raises an exception if no message with the specified identifier currently exists in the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2624">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2624">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2625">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2625">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="51fc7-2626">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2626">This method throws an exception immediately if the message is not in the queue.</span></span> <span data-ttu-id="51fc7-2627">В противном случае сообщение удаляется из очереди и возвращается приложению, используя контекст транзакции, определяемый параметром `transactionType` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2627">Otherwise, the message is removed from the queue and returned to the application using a transaction context defined by the `transactionType` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2628">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2628">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2629">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2629">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2630">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2630">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2631"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2631">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="51fc7-2632">Если сообщение с указанным идентификатором в очереди, не связанную с этим <xref:System.Messaging.MessageQueue> экземпляра, сообщение не будет найден.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2632">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="51fc7-2633">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2633">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2634">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2634">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2635">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2635">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2636"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2636">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2637">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2637">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2638"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2638">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2639">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2639">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2640">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2640">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2641">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2641">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2642">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2642">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2643">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2643">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2644">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2644">Local computer</span></span>|<span data-ttu-id="51fc7-2645">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2645">Yes</span></span>|  
|<span data-ttu-id="51fc7-2646">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2646">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2647">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2647">Yes</span></span>|  
|<span data-ttu-id="51fc7-2648">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2648">Remote computer</span></span>|<span data-ttu-id="51fc7-2649">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2649">No</span></span>|  
|<span data-ttu-id="51fc7-2650">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2650">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2651">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2651">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2652">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2652">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#15](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#15)]
 [!code-csharp[MessageQueue2#15](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#15)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2653">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2653">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2654">Не удалось найти сообщение с указанным параметром <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2654">The message with the specified <paramref name="id" /> could not be found.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2655">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2655">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2656">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2656">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2657">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2657">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2658">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2658">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <summary><span data-ttu-id="51fc7-2659">Получает сообщение, которое соответствует заданному идентификатору (из нетранзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2659">Receives the message that matches the given identifier (from a non-transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2660">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2660">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2661">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2661">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="51fc7-2662">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным параметром `id` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2662">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="51fc7-2663">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2663">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2664">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2664">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2665">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2665">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2666">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2666">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2667">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, если он соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2667">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="51fc7-2668">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2668">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2669">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2669">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2670"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2670">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2671">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> Если текущий поток можно заблокировать, пока новые сообщения продолжают поступать в очереди в течение времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2671">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2672">Поток будет заблокирован для по крайней мере заданного периода времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения продолжают поступать в очереди в течение времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2672">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2673">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2673">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2674"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2674">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2675">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2675">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2676"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2676">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2677">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2677">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2678">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2678">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2679">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2679">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2680">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2680">Local computer</span></span>|<span data-ttu-id="51fc7-2681">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2681">Yes</span></span>|  
|<span data-ttu-id="51fc7-2682">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2682">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2683">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2683">Yes</span></span>|  
|<span data-ttu-id="51fc7-2684">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2684">Remote computer</span></span>|<span data-ttu-id="51fc7-2685">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2685">No</span></span>|  
|<span data-ttu-id="51fc7-2686">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2686">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2687">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2687">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2688">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2688">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#20](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#20)]
 [!code-csharp[MessageQueue2#20](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2689">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2689">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2690">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2690">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2691">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2691">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2692">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2692">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2693">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2693">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2694">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2694">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2695">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2695">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2696">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2696">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2697">Получает сообщение, которое соответствует заданному идентификатору (из транзакционной очереди), и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2697">Receives the message that matches the given identifier (from a transactional queue) and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2698">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2698">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2699">Используйте этот метод для чтения сообщения с известным идентификатором и удалите его из очереди, с помощью контекста внутренней транзакции, определенного `transaction` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2699">Use this method to read a message with a known identifier and remove it from the queue, using the internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-2700">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным параметром `id` параметр находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2700">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue.</span></span> <span data-ttu-id="51fc7-2701">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2701">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2702">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2702">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2703">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2703">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2704">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2704">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2705">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, если он соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2705">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="51fc7-2706">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2706">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2707">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2707">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2708"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2708">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2709">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> Если текущий поток можно заблокировать, пока новые сообщения продолжают поступать в очереди в течение времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2709">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2710">Поток будет заблокирован для по крайней мере заданного периода времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения по-прежнему поступление в очередь до истечения времени ожидания, определяемое `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2710">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the timeout period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2711">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2711">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2712">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2712">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2713">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2713">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2714"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2714">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2715">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2715">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2716"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2716">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message, unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2717">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2717">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2718">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2718">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2719">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2719">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2720">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2720">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2721">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2721">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2722">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2722">Local computer</span></span>|<span data-ttu-id="51fc7-2723">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2723">Yes</span></span>|  
|<span data-ttu-id="51fc7-2724">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2724">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2725">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2725">Yes</span></span>|  
|<span data-ttu-id="51fc7-2726">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2726">Remote computer</span></span>|<span data-ttu-id="51fc7-2727">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2727">No</span></span>|  
|<span data-ttu-id="51fc7-2728">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2728">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2729">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2729">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2730">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2730">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#18](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#18)]
 [!code-csharp[MessageQueue2#18](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2731">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2731">The <paramref name="id" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-2732">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2732">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2733">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2733">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2734">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2734">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2735">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2735">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2736">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2736">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2737">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2737">The queue is non-transactional.</span></span>  
  
 <span data-ttu-id="51fc7-2738">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2738">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2739">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2739">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveById">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveById (string id, TimeSpan timeout, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveById(string id, valuetype System.TimeSpan timeout, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveById(System.String,System.TimeSpan,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveById (id As String, timeout As TimeSpan, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveById(System::String ^ id, TimeSpan timeout, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="id" Type="System.String" />
        <Parameter Name="timeout" Type="System.TimeSpan" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="id"><span data-ttu-id="51fc7-2740">Свойство <see cref="P:System.Messaging.Message.Id" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2740">The <see cref="P:System.Messaging.Message.Id" /> of the message to receive.</span></span></param>
        <param name="timeout"><span data-ttu-id="51fc7-2741">Структура <see cref="T:System.TimeSpan" />, показывающая время ожидания нового сообщения для проверки.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2741">A <see cref="T:System.TimeSpan" /> that indicates the time to wait until a new message is available for inspection.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2742">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2742">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2743">Получает сообщение, которое соответствует заданному идентификатору, и ожидает, пока в очереди не появится сообщение с указанным идентификатором, или пока не истечет тайм-аут.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2743">Receives the message that matches the given identifier and waits until either a message with the specified identifier is available in the queue or the time-out expires.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2744">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.Id" /> которого соответствует переданному в объект параметру <paramref name="id" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2744">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.Id" /> property matches the <paramref name="id" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2745">Используйте этот метод для чтения сообщения с известным идентификатором и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2745">Use this method to read a message with a known identifier and remove it from the queue.</span></span> <span data-ttu-id="51fc7-2746">Этот метод возвращает немедленно, если сообщение с идентификатором, указанным `id` параметр находится в очереди, используя контекст транзакции, определяемый параметром `transactionType` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2746">This method returns immediately if the message with the identifier specified by the `id` parameter is in the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="51fc7-2747">В противном случае метод ожидает в течение заданного периода времени поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2747">Otherwise, the method waits the given period of time for a new message to arrive.</span></span> <span data-ttu-id="51fc7-2748">Если новое сообщение не пришло до истечения времени ожидания, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2748">If a new message does not arrive before the time-out expires, an exception is thrown.</span></span>  
  
 <span data-ttu-id="51fc7-2749">`timeout` Не указывает общее время выполнения для этого метода.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2749">The `timeout` parameter does not specify the total running time for this method.</span></span> <span data-ttu-id="51fc7-2750">Вместо этого он задает время ожидания для нового сообщения прибывают в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2750">Rather, it specifies the time to wait for a new message to arrive in the queue.</span></span> <span data-ttu-id="51fc7-2751">Каждый раз при поступлении сообщения, этот метод проверяет <xref:System.Messaging.Message.Id%2A> нового сообщения, если он соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2751">Each time a new message arrives, this method examines the <xref:System.Messaging.Message.Id%2A> of the new message to see if it matches the `id` parameter.</span></span> <span data-ttu-id="51fc7-2752">В противном случае этот метод запускает ожидания через и ожидает поступления нового сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2752">If not, this method starts the time-out period over and waits for another new message to arrive.</span></span> <span data-ttu-id="51fc7-2753">Таким образом, если новые сообщения по-прежнему поступления до истечения времени ожидания, возможна данный метод может продолжать выполняться неопределенно долго, до истечения времени ожидания без новых сообщений, поступающих или до прибытия сообщения которого <xref:System.Messaging.Message.Id%2A> соответствует `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2753">Therefore, if new messages continue to arrive within the time-out period, it is possible for this method to continue running indefinitely, either until the time-out period expires without any new messages arriving, or until a message arrives whose <xref:System.Messaging.Message.Id%2A> matches the `id` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2754">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2754">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2755">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2755">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2756">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2756">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2757"><xref:System.Messaging.Message.Id%2A> Свойство сообщения является уникальным во всей организации очереди сообщений, таким образом, не более одного сообщения в очереди, которое соответствует данной `id` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2757">The <xref:System.Messaging.Message.Id%2A> property of a message is unique across the Message Queuing enterprise, so there will be at most one message in the queue that matches the given `id` parameter.</span></span> <span data-ttu-id="51fc7-2758">Если сообщение с указанным идентификатором в очереди, не связанную с этим <xref:System.Messaging.MessageQueue> экземпляра, сообщение не будет найден.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2758">If the message with the specified identifier is in a queue other than the one associated with this <xref:System.Messaging.MessageQueue> instance, the message will not be found.</span></span>  
  
 <span data-ttu-id="51fc7-2759">Используйте эту перегрузку <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> Если текущий поток можно заблокировать, пока новые сообщения продолжают поступать в очереди в течение времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2759">Use this overload of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%29> when it is acceptable for the current thread to be blocked as long as new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span> <span data-ttu-id="51fc7-2760">Поток будет заблокирован для по крайней мере заданного периода времени или неопределенно долго, если задано значение <xref:System.Messaging.MessageQueue.InfiniteTimeout> для `timeout` параметра, или если новые сообщения продолжают поступать в очереди в течение времени ожидания, заданного по `timeout` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2760">The thread will be blocked for at least the given period of time, or indefinitely if you specified the value <xref:System.Messaging.MessageQueue.InfiniteTimeout> for the `timeout` parameter, or if new messages continue to arrive in the queue within the time-out period specified by the `timeout` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2761">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2761">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2762">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2762">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2763">Два других метода позволяют получать сообщения из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2763">Two other methods allow you to receive messages from a queue.</span></span> <span data-ttu-id="51fc7-2764"><xref:System.Messaging.MessageQueue.Receive%2A> Метод возвращает первое сообщение в очереди и <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> метод используется для получения подтверждения, отчета или сформированные ответного сообщения, который был создан в результате сообщение, отправленное в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2764">The <xref:System.Messaging.MessageQueue.Receive%2A> method returns the first message in the queue, and the <xref:System.Messaging.MessageQueue.ReceiveByCorrelationId%28System.String%29> method is used to retrieve an acknowledgment, report, or application-generated response message that was created as a result of a message sent to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2765">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2765">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method.</span></span> <span data-ttu-id="51fc7-2766"><xref:System.Messaging.MessageQueue.PeekById%28System.String%29> Метод всегда возвращает первое сообщение в очереди, поэтому последующие вызовы метода возвращается то же сообщение, если сообщение с более высоким приоритетом не поступит в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2766">The <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> method always returns the first message in the queue, so subsequent calls to the method return the same message unless a higher priority message arrives in the queue.</span></span> <span data-ttu-id="51fc7-2767">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2767">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekById%28System.String%29>.</span></span> <span data-ttu-id="51fc7-2768">Поскольку <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> не удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2768">Because <xref:System.Messaging.MessageQueue.PeekById%28System.String%29> does not remove any messages in the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2769">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2769">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2770">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2770">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2771">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2771">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2772">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2772">Local computer</span></span>|<span data-ttu-id="51fc7-2773">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2773">Yes</span></span>|  
|<span data-ttu-id="51fc7-2774">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2774">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2775">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2775">Yes</span></span>|  
|<span data-ttu-id="51fc7-2776">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2776">Remote computer</span></span>|<span data-ttu-id="51fc7-2777">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2777">No</span></span>|  
|<span data-ttu-id="51fc7-2778">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2778">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2779">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2779">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2780">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2780">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ReceiveById%28System.String%2CSystem.TimeSpan%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#19](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#19)]
 [!code-csharp[MessageQueue2#19](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2781">Параметр <paramref name="id" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2781">The <paramref name="id" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-2782">Для параметра <paramref name="timeout" /> задано недопустимое значение; возможно, значение параметра <paramref name="timeout" /> меньше <see cref="F:System.TimeSpan.Zero" /> или больше <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2782">The value specified for the <paramref name="timeout" /> parameter is not valid, possibly <paramref name="timeout" /> is less than <see cref="F:System.TimeSpan.Zero" /> or greater than <see cref="F:System.Messaging.MessageQueue.InfiniteTimeout" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2783">Сообщение с указанным значением параметра <paramref name="id" /> до истечения тайм-аута в очередь не поступало.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2783">A message with the specified <paramref name="id" /> did not arrive in the queue before the time-out expired.</span></span>  
  
 <span data-ttu-id="51fc7-2784">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2784">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2785">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2785">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2786">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2786">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ReceiveByLookupId">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-2787">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2787">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-2788">Получает конкретное сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2788">Receives a specific message from the queue.</span></span> <span data-ttu-id="51fc7-2789">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2789">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (long lookupId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(int64 lookupId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (lookupId As Long) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(long lookupId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="lookupId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="lookupId"><span data-ttu-id="51fc7-2790">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2790">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive.</span></span></param>
        <summary><span data-ttu-id="51fc7-2791">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2791">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-2792">Получает сообщение, соответствующее заданному идентификатору просмотра, из нетранзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2792">Receives the message that matches the given lookup identifier from a non-transactional queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2793">Объект <see cref="T:System.Messaging.Message" />, свойство <see cref="P:System.Messaging.Message.LookupId" /> которого соответствует переданному в объект параметру <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2793">The <see cref="T:System.Messaging.Message" /> whose <see cref="P:System.Messaging.Message.LookupId" /> property matches the <paramref name="lookupId" /> parameter passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2794">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаления его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2794">Use this method to read a message with a known lookup identifier and remove it from the queue.</span></span> <span data-ttu-id="51fc7-2795">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2795">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2796"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди которой находится сообщение, таким образом, не более одного сообщения в очереди, которое соответствует данной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2796">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2797">Для чтения сообщения с указанным кодом просмотра, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2797">To read a message with a specified lookup identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span>  
  
 <span data-ttu-id="51fc7-2798">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2798">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2799">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2799">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2800">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2800">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2801">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2801">Local computer</span></span>|<span data-ttu-id="51fc7-2802">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2802">Yes</span></span>|  
|<span data-ttu-id="51fc7-2803">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2803">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2804">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2804">Yes</span></span>|  
|<span data-ttu-id="51fc7-2805">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2805">Remote computer</span></span>|<span data-ttu-id="51fc7-2806">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2806">No</span></span>|  
|<span data-ttu-id="51fc7-2807">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2807">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2808">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2808">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-2809">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2809">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2810">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2810">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2811">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2811">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transaction As MessageQueueTransaction) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="51fc7-2812">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2812">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="51fc7-2813">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="51fc7-2813">Specify one of the following:</span></span>  
  
 <span data-ttu-id="51fc7-2814"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2814"><see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2815"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2815"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2816"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2816"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2817"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2817"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="51fc7-2818">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2818">The <c>lookupId</c> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="51fc7-2819"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2819"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="51fc7-2820">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2820">The <c>lookupId</c> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="51fc7-2821">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2821">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="51fc7-2822">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2822">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2823">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2823">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2824">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2824">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-2825">Получает конкретное сообщение из транзакционной очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2825">Receives a specific message from a transactional queue.</span></span> <span data-ttu-id="51fc7-2826">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2826">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2827">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="lookupId" /> и <paramref name="action" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2827">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="lookupId" /> and <paramref name="action" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2828">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаления его из очереди, используя контекст транзакции, определяемый параметром `transaction` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2828">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-2829">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2829">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2830"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди которой находится сообщение, таким образом, не более одного сообщения в очереди, которое соответствует данной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2830">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2831">Поскольку этот метод вызывается в транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2831">Because this method is called on a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2832">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2832">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2833">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2833">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="51fc7-2834">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2834">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="51fc7-2835">Поскольку <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2835">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2836">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2836">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2837">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2837">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2838">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2838">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2839">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2839">Local computer</span></span>|<span data-ttu-id="51fc7-2840">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2840">Yes</span></span>|  
|<span data-ttu-id="51fc7-2841">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2841">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2842">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2842">Yes</span></span>|  
|<span data-ttu-id="51fc7-2843">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2843">Remote computer</span></span>|<span data-ttu-id="51fc7-2844">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2844">No</span></span>|  
|<span data-ttu-id="51fc7-2845">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2845">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2846">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2846">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-2847">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2847">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2848">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2848">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2849">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2849">An error occurred when accessing a Message Queuing method.</span></span>  
  
 <span data-ttu-id="51fc7-2850">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2850">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2851">Очередь является нетранзакционной.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2851">The queue is non-transactional.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2852">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2852">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveByLookupId">
      <MemberSignature Language="C#" Value="public System.Messaging.Message ReceiveByLookupId (System.Messaging.MessageLookupAction action, long lookupId, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Messaging.Message ReceiveByLookupId(valuetype System.Messaging.MessageLookupAction action, int64 lookupId, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ReceiveByLookupId(System.Messaging.MessageLookupAction,System.Int64,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReceiveByLookupId (action As MessageLookupAction, lookupId As Long, transactionType As MessageQueueTransactionType) As Message" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Messaging::Message ^ ReceiveByLookupId(System::Messaging::MessageLookupAction action, long lookupId, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Messaging.Message</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Messaging.MessageLookupAction" />
        <Parameter Name="lookupId" Type="System.Int64" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="51fc7-2853">Одно из значений <see cref="T:System.Messaging.MessageLookupAction" />, задающее порядок чтения сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2853">One of the <see cref="T:System.Messaging.MessageLookupAction" /> values, specifying how the message is read in the queue.</span></span> <span data-ttu-id="51fc7-2854">Укажите одно из следующих значений:</span><span class="sxs-lookup"><span data-stu-id="51fc7-2854">Specify one of the following:</span></span>  
  
 <span data-ttu-id="51fc7-2855"><see langword="MessageLookupAction.Current" />: получает сообщение, заданное в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2855"><see langword="MessageLookupAction.Current" />: Receives the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2856"><see langword="MessageLookupAction.Next" />: получает сообщение, следующее за сообщением, заданным в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2856"><see langword="MessageLookupAction.Next" />: Receives the message following the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2857"><see langword="MessageLookupAction.Previous" />: получает сообщение, предшествующее сообщению, заданному в параметре <c>lookupId</c>, и удаляет это сообщение из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2857"><see langword="MessageLookupAction.Previous" />: Receives the message preceding the message specified by <c>lookupId</c> and removes it from the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2858"><see langword="MessageLookupAction.First" />: получает первое сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2858"><see langword="MessageLookupAction.First" />: Receives the first message in the queue and removes it from the queue.</span></span> <span data-ttu-id="51fc7-2859">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2859">The <c>lookupId</c> parameter must be set to 0.</span></span>  
  
 <span data-ttu-id="51fc7-2860"><see langword="MessageLookupAction.Last" />: получает последнее сообщение в очереди и удаляет его из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2860"><see langword="MessageLookupAction.Last" />: Receives the last message in the queue and removes it from the queue.</span></span> <span data-ttu-id="51fc7-2861">Параметр <c>lookupId</c> должен быть установлен равным 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2861">The <c>lookupId</c> parameter must be set to 0.</span></span></param>
        <param name="lookupId"><span data-ttu-id="51fc7-2862">Свойство <see cref="P:System.Messaging.Message.LookupId" /> получаемого сообщения или значение 0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2862">The <see cref="P:System.Messaging.Message.LookupId" /> of the message to receive, or 0.</span></span> <span data-ttu-id="51fc7-2863">Значение, равное 0, используется при доступе к первому или последнему сообщению в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2863">0 is used when accessing the first or last message in the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-2864">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2864">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-2865">Представлено в MSMQ 3.0.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2865">Introduced in MSMQ 3.0.</span></span> <span data-ttu-id="51fc7-2866">Получает из очереди определенное сообщение, используя заданный контекст транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2866">Receives a specific message from the queue, using the specified transaction context.</span></span> <span data-ttu-id="51fc7-2867">Сообщение может быть задано кодом просмотра либо его положением относительно начала или конца очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2867">The message can be specified by a lookup identifier or by its position at the front or end of the queue.</span></span></summary>
        <returns><span data-ttu-id="51fc7-2868">Объект <see cref="T:System.Messaging.Message" />, задаваемый передаваемыми параметрами <paramref name="action" /> и <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2868">The <see cref="T:System.Messaging.Message" /> specified by the <paramref name="action" /> and <paramref name="lookupId" /> parameters passed in.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2869">Используйте этот метод для чтения сообщения с известным кодом просмотра и удаления его из очереди, используя контекст транзакции, определяемый параметром `transactionType` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2869">Use this method to read a message with a known lookup identifier and remove it from the queue, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="51fc7-2870">Этот метод вызывает исключение немедленно, если сообщение не находится в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2870">This method throws an exception immediately if the message is not in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2871"><xref:System.Messaging.Message.LookupId%2A> Свойство сообщения является уникальным для очереди которой находится сообщение, таким образом, не более одного сообщения в очереди, которое соответствует данной `lookupId` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2871">The <xref:System.Messaging.Message.LookupId%2A> property of a message is unique to the queue where the message resides, so there will be at most one message in the queue that matches the given `lookupId` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2872">Для чтения сообщения с указанным идентификатором, не удаляя его из очереди, используйте <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2872">To read a message with a specified identifier without removing it from the queue, use the <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> method.</span></span> <span data-ttu-id="51fc7-2873">Отсутствует контекст транзакции, связанный с сообщение, возвращенное вызовом <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2873">There is no transaction context associated with a message returned by a call to <xref:System.Messaging.MessageQueue.PeekByLookupId%2A>.</span></span> <span data-ttu-id="51fc7-2874">Поскольку <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> удаляет сообщения из очереди, существует необходимость откатывается, если транзакция прервана.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2874">Because <xref:System.Messaging.MessageQueue.PeekByLookupId%2A> does not remove any messages from the queue, there would be nothing to roll back if the transaction were aborted.</span></span>  
  
 <span data-ttu-id="51fc7-2875">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для получения сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2875">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to receive the message.</span></span> <span data-ttu-id="51fc7-2876">Укажите `Single` Если вы хотите получить сообщение в виде единой внутренней транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2876">Specify `Single` if you want to receive the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-2877">Можно указать `None` Если вы хотите получать сообщения из транзакционной очереди вне контекста транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2877">You can specify `None` if you want to receive a message from a transactional queue outside of a transaction context.</span></span>  
  
 <span data-ttu-id="51fc7-2878">Если этот метод вызывается для получения сообщения из транзакционной очереди, полученное сообщение будет возвращено очереди, если транзакция прерывается.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2878">If this method is called to receive a message from a transactional queue, the message that is received would be returned to the queue if the transaction is aborted.</span></span> <span data-ttu-id="51fc7-2879">Сообщение не удаляется окончательно из очереди до фиксации транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2879">The message is not permanently removed from the queue until the transaction is committed.</span></span>  
  
 <span data-ttu-id="51fc7-2880">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2880">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2881">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2881">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2882">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2882">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2883">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2883">Local computer</span></span>|<span data-ttu-id="51fc7-2884">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2884">Yes</span></span>|  
|<span data-ttu-id="51fc7-2885">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2885">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2886">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2886">Yes</span></span>|  
|<span data-ttu-id="51fc7-2887">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2887">Remote computer</span></span>|<span data-ttu-id="51fc7-2888">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2888">No</span></span>|  
|<span data-ttu-id="51fc7-2889">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2889">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2890">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2890">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException"><span data-ttu-id="51fc7-2891">Приложение MSMQ 3.0 не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2891">MSMQ 3.0 is not installed.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="51fc7-2892">Не удалось найти сообщение с указанным параметром <paramref name="lookupId" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2892">The message with the specified <paramref name="lookupId" /> could not be found.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2893">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2893">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-2894">Параметр <paramref name="action" /> не является одним из членов <see cref="T:System.Messaging.MessageLookupAction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2894">The <paramref name="action" /> parameter is not one of the <see cref="T:System.Messaging.MessageLookupAction" /> members.</span></span>  
  
 <span data-ttu-id="51fc7-2895">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2895">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2896">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2896">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <altmember cref="P:System.Messaging.Message.LookupId" />
        <altmember cref="M:System.Messaging.MessageQueue.PeekByLookupId" />
      </Docs>
    </Member>
    <Member MemberName="ReceiveCompleted">
      <MemberSignature Language="C#" Value="public event System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Messaging.ReceiveCompletedEventHandler ReceiveCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event ReceiveCompleted As ReceiveCompletedEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Messaging::ReceiveCompletedEventHandler ^ ReceiveCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_ReceiveCompleted")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Messaging.ReceiveCompletedEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-2897">Происходит, если сообщение было удалено из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2897">Occurs when a message has been removed from the queue.</span></span> <span data-ttu-id="51fc7-2898">Это событие инициируется асинхронной операцией, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2898">This event is raised by the asynchronous operation, <see cref="M:System.Messaging.MessageQueue.BeginReceive" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> используется при асинхронной обработке, чтобы вызвать <xref:System.Messaging.MessageQueue.ReceiveCompleted> событие, если сообщение не станет доступным в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2899"><xref:System.Messaging.MessageQueue.BeginReceive%2A> is used in asynchronous processing to raise the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event when a message is available in the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> используется для завершения операции, запущенной с помощью вызова <xref:System.Messaging.MessageQueue.BeginReceive%2A> и просмотра сообщения при <xref:System.Messaging.MessageQueue.ReceiveCompleted> события.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2900"><xref:System.Messaging.MessageQueue.EndReceive%28System.IAsyncResult%29> is used to complete the operation initiated by a call to <xref:System.Messaging.MessageQueue.BeginReceive%2A> and peek the message when the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised.</span></span>  
  
 <span data-ttu-id="51fc7-2901">При создании делегата <xref:System.Messaging.ReceiveCompletedEventHandler> необходимо указать метод, обрабатывающий событие.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2901">When you create a <xref:System.Messaging.ReceiveCompletedEventHandler> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="51fc7-2902">Чтобы связать событие с обработчиком событий, нужно добавить в событие экземпляр делегата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2902">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="51fc7-2903">Обработчик событий вызывается всякий раз, когда происходит событие, если делегат не удален.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2903">The event handler is called whenever the event occurs, unless you remove the delegate.</span></span> <span data-ttu-id="51fc7-2904">Дополнительные сведения о делегатах обработчиков событий см. в разделе [обработка и вызов событий](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="51fc7-2904">For more information about event handler delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2905">В следующем примере кода создается обработчик событий с именем `MyReceiveCompleted`, присоединяется к <xref:System.Messaging.MessageQueue.ReceiveCompleted> делегата обработчика событий и вызовов <xref:System.Messaging.MessageQueue.BeginReceive%2A> Чтобы инициировать асинхронную операцию в очереди, расположенный по пути «. \myQueue».</span><span class="sxs-lookup"><span data-stu-id="51fc7-2905">The following code example creates an event handler named `MyReceiveCompleted`, attaches it to the <xref:System.Messaging.MessageQueue.ReceiveCompleted> event handler delegate, and calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> to initiate an asynchronous receive operation on the queue that is located at the path ".\myQueue".</span></span> <span data-ttu-id="51fc7-2906">При <xref:System.Messaging.MessageQueue.ReceiveCompleted> события, в примере получает сообщение и выводит его текст на экране.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2906">When a <xref:System.Messaging.MessageQueue.ReceiveCompleted> event is raised, the example receives the message and writes its body to the screen.</span></span> <span data-ttu-id="51fc7-2907">Затем в примере вызывается <xref:System.Messaging.MessageQueue.BeginReceive%2A> еще раз, чтобы начать новую асинхронную операцию получения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2907">The example then calls <xref:System.Messaging.MessageQueue.BeginReceive%2A> again to initiate a new asynchronous receive operation.</span></span>  
  
 [!code-cpp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CPP/mqreceivecompletedeventhandler.cpp#1)]
 [!code-csharp[MessageQueue.ReceiveCompleted#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/CS/mqreceivecompletedeventhandler.cs#1)]
 [!code-vb[MessageQueue.ReceiveCompleted#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.ReceiveCompleted/VB/mqreceivecompletedeventhandler.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="T:System.TimeSpan" />
        <altmember cref="T:System.AsyncCallback" />
        <altmember cref="T:System.IAsyncResult" />
      </Docs>
    </Member>
    <Member MemberName="Refresh">
      <MemberSignature Language="C#" Value="public void Refresh ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Refresh() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Refresh" />
      <MemberSignature Language="VB.NET" Value="Public Sub Refresh ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Refresh();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-2908">Обновляет свойства, представленные объектом <see cref="T:System.Messaging.MessageQueue" /> для отражения текущего состояния ресурса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2908">Refreshes the properties presented by the <see cref="T:System.Messaging.MessageQueue" /> to reflect the current state of the resource.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> синхронизирует свойства <xref:System.Messaging.MessageQueue> с его связанный ресурс очереди сообщений сервера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2909"><xref:System.Messaging.MessageQueue.Refresh%2A> synchronizes the properties of a <xref:System.Messaging.MessageQueue> with its associated Message Queuing server resource.</span></span> <span data-ttu-id="51fc7-2910">Если любые свойства, такие как <xref:System.Messaging.MessageQueue.Label%2A> или <xref:System.Messaging.MessageQueue.Category%2A>, был изменен на сервере со времени <xref:System.Messaging.MessageQueue> был создан <xref:System.Messaging.MessageQueue.Refresh%2A> обновления <xref:System.Messaging.MessageQueue> новыми данными.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2910">If any property, such as <xref:System.Messaging.MessageQueue.Label%2A> or <xref:System.Messaging.MessageQueue.Category%2A>, has changed on the server since the time the <xref:System.Messaging.MessageQueue> was created, <xref:System.Messaging.MessageQueue.Refresh%2A> updates the <xref:System.Messaging.MessageQueue> with the new information.</span></span>  
  
 <span data-ttu-id="51fc7-2911">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2911">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2912">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2912">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2913">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2913">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2914">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2914">Local computer</span></span>|<span data-ttu-id="51fc7-2915">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2915">Yes</span></span>|  
|<span data-ttu-id="51fc7-2916">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2916">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2917">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2917">Yes</span></span>|  
|<span data-ttu-id="51fc7-2918">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2918">Remote computer</span></span>|<span data-ttu-id="51fc7-2919">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2919">No</span></span>|  
|<span data-ttu-id="51fc7-2920">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2920">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2921">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2921">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2922">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2922">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Refresh%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#28](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#28)]
 [!code-csharp[MessageQueue2#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Messaging.MessageQueue.GetPublicQueues" />
      </Docs>
    </Member>
    <Member MemberName="ResetPermissions">
      <MemberSignature Language="C#" Value="public void ResetPermissions ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ResetPermissions() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.ResetPermissions" />
      <MemberSignature Language="VB.NET" Value="Public Sub ResetPermissions ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ResetPermissions();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="51fc7-2923">Присваивает списку разрешений значения по умолчанию операционной системы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2923">Resets the permission list to the operating system's default values.</span></span> <span data-ttu-id="51fc7-2924">Удаляет все разрешения очередей, добавленные в список по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2924">Removes any queue permissions you have appended to the default list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2925">При вызове <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, возвращают список разрешений на значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2925">When you call <xref:System.Messaging.MessageQueue.ResetPermissions%2A>, you return the permission list to its default values.</span></span> <span data-ttu-id="51fc7-2926">Как правило, это предоставляет создатель очереди все разрешения и предоставляет группе всем пользователям следующие права:</span><span class="sxs-lookup"><span data-stu-id="51fc7-2926">Generally, this grants the queue creator all permissions, and gives the group Everyone the following rights:</span></span>  
  
-   <span data-ttu-id="51fc7-2927">Получение свойств очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2927">Get the properties of the queue.</span></span>  
  
-   <span data-ttu-id="51fc7-2928">Получение разрешения очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2928">Get queue permissions.</span></span>  
  
-   <span data-ttu-id="51fc7-2929">Запись в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2929">Write to the queue.</span></span>  
  
 <span data-ttu-id="51fc7-2930">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2930">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2931">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2931">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2932">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2932">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2933">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2933">Local computer</span></span>|<span data-ttu-id="51fc7-2934">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2934">Yes</span></span>|  
|<span data-ttu-id="51fc7-2935">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2935">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2936">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2936">Yes</span></span>|  
|<span data-ttu-id="51fc7-2937">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2937">Remote computer</span></span>|<span data-ttu-id="51fc7-2938">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2938">No</span></span>|  
|<span data-ttu-id="51fc7-2939">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2939">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2940">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2940">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2941">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2941">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.ResetPermissions%2A>.</span></span>  
  
 [!code-cpp[MessageQueue2#27](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#27)]
 [!code-csharp[MessageQueue2#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2942">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2942">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Send">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-2943">Отправляет объект в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2943">Sends an object to a queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-2944">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2944">The object to send to the queue.</span></span></param>
        <summary><span data-ttu-id="51fc7-2945">Отправляет объект в нетранзакционную очередь, на которую ссылается этот класс <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2945">Sends an object to non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2946">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2946">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-2947">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2947">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="51fc7-2948">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2948">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="51fc7-2949">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2949">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="51fc7-2950">Сообщение, быть частью транзакции, которая содержит другие сообщения, используйте перегрузку, которая использует <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> как параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2950">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="51fc7-2951">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2951">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-2952"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2952">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-2953">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2953">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-2954">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2954">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-2955">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2955">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2956">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2956">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2957">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2957">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2958">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2958">Local computer</span></span>|<span data-ttu-id="51fc7-2959">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2959">Yes</span></span>|  
|<span data-ttu-id="51fc7-2960">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2960">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2961">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2961">Yes</span></span>|  
|<span data-ttu-id="51fc7-2962">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2962">Remote computer</span></span>|<span data-ttu-id="51fc7-2963">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2963">No</span></span>|  
|<span data-ttu-id="51fc7-2964">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2964">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2965">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2965">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2966">В следующем примере кода подключается к очереди сообщений и отправляет сообщение в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2966">The following code example connects to a message queue and sends a message to the queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_obj#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_obj/CPP/mqsend_generic.cpp#1)]
 [!code-csharp[MessageQueue.Send_obj#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_obj/CS/mqsend_generic.cs#1)]
 [!code-vb[MessageQueue.Send_obj#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_obj/VB/mqsend_generic.vb#1)]  
  
 <span data-ttu-id="51fc7-2967">В следующем примере кода отправляет определяемые приложением `Order` класса в очередь, а затем принимается сообщение из этой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2967">The following code example sends an application-defined `Order` class to a queue and then receives a message from that queue.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2968">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2968">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-2969">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-2969">-or-</span></span>  
  
 <span data-ttu-id="51fc7-2970">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2970">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Path" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-2971">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2971">The object to send to the queue.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-2972">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2972">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-2973">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2973">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-2974">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста внутренней транзакции, определенного параметром `transaction` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2974">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-2975">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2975">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="51fc7-2976">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2976">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="51fc7-2977">Если эта перегрузка используется для отправки сообщения в нетранзакционную очередь, сообщения могут быть отправлены в очередь недоставленных сообщений без создания исключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2977">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="51fc7-2978">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2978">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-2979"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2979">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-2980">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2980">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-2981">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2981">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-2982"><xref:System.Messaging.MessageQueueTransaction> Потоковый подразделения знать, поэтому если состояние апартамента — `STA`, транзакции нельзя использовать в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2982"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="51fc7-2983">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2983">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="51fc7-2984">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2984">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="51fc7-2985">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2985">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="51fc7-2986">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2986">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-2987">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-2987">Workgroup mode</span></span>|<span data-ttu-id="51fc7-2988">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-2988">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-2989">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2989">Local computer</span></span>|<span data-ttu-id="51fc7-2990">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2990">Yes</span></span>|  
|<span data-ttu-id="51fc7-2991">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2991">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-2992">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2992">Yes</span></span>|  
|<span data-ttu-id="51fc7-2993">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-2993">Remote computer</span></span>|<span data-ttu-id="51fc7-2994">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-2994">No</span></span>|  
|<span data-ttu-id="51fc7-2995">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-2995">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-2996">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-2996">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-2997">В следующем примере кода отправляет в транзакционную очередь строку и затем получает сообщение из этой очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2997">The following code example sends a string to a transactional queue and then receives a message from that queue.</span></span>  
  
 [!code-cpp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CPP/mqsend_objtransaction.cpp#1)]
 [!code-csharp[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/CS/mqsend_objtransaction.cs#1)]
 [!code-vb[MessageQueue.Send_ObjectTransaction#1](~/samples/snippets/visualbasic/VS_Snippets_Remoting/MessageQueue.Send_ObjectTransaction/VB/mqsend_objtransaction.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-2998">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2998">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-2999">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-2999">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-3000">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3000">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3001">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3001">The Message Queuing application indicated an incorrect transaction use.</span></span>  
  
 <span data-ttu-id="51fc7-3002">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3002">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3003">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3003">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-3004">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3004">The object to send to the queue.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-3005">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3005">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-3006">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3006">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3007">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3007">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="51fc7-3008">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3008">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="51fc7-3009">Укажите `Single` Если вы хотите отправить сообщение как одна внутренняя транзакция.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3009">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-3010">Можно указать `None` Если вы хотите отправить транзактное сообщение в нетранзакционный поток.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3010">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="51fc7-3011">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3011">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="51fc7-3012">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3012">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="51fc7-3013">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3013">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-3014"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3014">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-3015">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3015">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-3016">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3016">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-3017">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3017">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3018">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3018">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3019">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3019">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3020">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3020">Local computer</span></span>|<span data-ttu-id="51fc7-3021">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3021">Yes</span></span>|  
|<span data-ttu-id="51fc7-3022">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3022">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3023">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3023">Yes</span></span>|  
|<span data-ttu-id="51fc7-3024">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3024">Remote computer</span></span>|<span data-ttu-id="51fc7-3025">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3025">No</span></span>|  
|<span data-ttu-id="51fc7-3026">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3026">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3027">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3027">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3028">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3028">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#2](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#2)]
 [!code-csharp[MessageQueue2#2](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-3029">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3029">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3030">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3030">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-3031">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3031">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3032">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3032">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-3033">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3033">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="51fc7-3034">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3034">The label of the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-3035">Отправляет объект в нетранзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3035">Sends an object to the non-transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3036">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3036">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>.</span></span> <span data-ttu-id="51fc7-3037">С помощью этой перегрузки можно указать строку метки, которая обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3037">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="51fc7-3038">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message>, структура, объект данных или любой другой управляемый объект.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3038">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="51fc7-3039">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3039">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="51fc7-3040">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3040">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="51fc7-3041">Если эта перегрузка используется для отправки сообщения в транзакционную очередь, сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3041">If you use this overload to send a message to a transactional queue, the message will be sent to the dead-letter queue.</span></span> <span data-ttu-id="51fc7-3042">Сообщение, быть частью транзакции, которая содержит другие сообщения, используйте перегрузку, которая использует <xref:System.Messaging.MessageQueueTransaction> или <xref:System.Messaging.MessageQueueTransactionType> как параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3042">If you want the message to be part of a transaction that contains other messages, use an overload that takes a <xref:System.Messaging.MessageQueueTransaction> or <xref:System.Messaging.MessageQueueTransactionType> as a parameter.</span></span>  
  
 <span data-ttu-id="51fc7-3043"><xref:System.Messaging.MessageQueue.Path%2A> Для данного <xref:System.Messaging.MessageQueue> экземпляр должен быть указан перед отправкой сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3043">The <xref:System.Messaging.MessageQueue.Path%2A> property for this <xref:System.Messaging.MessageQueue> instance must be specified before you send the message.</span></span> <span data-ttu-id="51fc7-3044">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3044">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-3045"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3045">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-3046">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3046">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-3047">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3047">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-3048">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3048">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3049">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3049">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3050">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3050">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3051">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3051">Local computer</span></span>|<span data-ttu-id="51fc7-3052">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3052">Yes</span></span>|  
|<span data-ttu-id="51fc7-3053">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3053">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3054">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3054">Yes</span></span>|  
|<span data-ttu-id="51fc7-3055">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3055">Remote computer</span></span>|<span data-ttu-id="51fc7-3056">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3056">No</span></span>|  
|<span data-ttu-id="51fc7-3057">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3057">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3058">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3058">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3059">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3059">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#1](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#1)]
 [!code-csharp[MessageQueue2#1](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-3060">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3060">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3061">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3061">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-3062">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3062">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3063">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3063">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransaction transaction);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, class System.Messaging.MessageQueueTransaction transaction) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransaction)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transaction As MessageQueueTransaction)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransaction ^ transaction);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transaction" Type="System.Messaging.MessageQueueTransaction" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-3064">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3064">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="51fc7-3065">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3065">The label of the message.</span></span></param>
        <param name="transaction"><span data-ttu-id="51fc7-3066">Объект <see cref="T:System.Messaging.MessageQueueTransaction" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3066">The <see cref="T:System.Messaging.MessageQueueTransaction" /> object.</span></span></param>
        <summary><span data-ttu-id="51fc7-3067">Отправляет объект в транзакционную очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3067">Sends an object to the transactional queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3068">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в транзакционную очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста внутренней транзакции, определенного параметром `transaction` параметр.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3068">Use this overload to send a message that contains the `obj` parameter to the transactional queue referenced by the <xref:System.Messaging.MessageQueue>, using an internal transaction context defined by the `transaction` parameter.</span></span> <span data-ttu-id="51fc7-3069">С помощью этой перегрузки можно указать строку метки, которая обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3069">With this overload, you can specify the string label that identifies the message.</span></span> <span data-ttu-id="51fc7-3070">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message>, структура, объект данных или любой другой управляемый объект.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3070">The object you send to the queue can be a <xref:System.Messaging.Message>, a structure, a data object, or any managed object.</span></span> <span data-ttu-id="51fc7-3071">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3071">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span>  
  
 <span data-ttu-id="51fc7-3072">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3072">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="51fc7-3073">Если эта перегрузка используется для отправки сообщения в нетранзакционную очередь, сообщения могут быть отправлены в очередь недоставленных сообщений без создания исключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3073">If you use this overload to send a message to a non-transactional queue, the message might be sent to the dead-letter queue without throwing an exception.</span></span>  
  
 <span data-ttu-id="51fc7-3074">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3074">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-3075"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3075">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-3076">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3076">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-3077">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство</span><span class="sxs-lookup"><span data-stu-id="51fc7-3077">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property</span></span>  
  
 <span data-ttu-id="51fc7-3078"><xref:System.Messaging.MessageQueueTransaction> Потоковый подразделения знать, поэтому если состояние апартамента — `STA`, транзакции нельзя использовать в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3078"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="51fc7-3079">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3079">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="51fc7-3080">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3080">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="51fc7-3081">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3081">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="51fc7-3082">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3082">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3083">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3083">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3084">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3084">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3085">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3085">Local computer</span></span>|<span data-ttu-id="51fc7-3086">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3086">Yes</span></span>|  
|<span data-ttu-id="51fc7-3087">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3087">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3088">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3088">Yes</span></span>|  
|<span data-ttu-id="51fc7-3089">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3089">Remote computer</span></span>|<span data-ttu-id="51fc7-3090">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3090">No</span></span>|  
|<span data-ttu-id="51fc7-3091">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3091">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3092">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3092">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3093">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3093">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransaction%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#4](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#4)]
 [!code-csharp[MessageQueue2#4](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-3094">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3094">The <paramref name="label" /> parameter is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="51fc7-3095">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3095">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3096">Параметр <paramref name="transaction" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3096">The <paramref name="transaction" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3097">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3097">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-3098">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3098">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3099">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3099">The Message Queuing application indicated an incorrect transaction usage.</span></span>  
  
 <span data-ttu-id="51fc7-3100">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3100">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3101">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3101">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="T:System.Messaging.MessageQueueTransaction" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <Member MemberName="Send">
      <MemberSignature Language="C#" Value="public void Send (object obj, string label, System.Messaging.MessageQueueTransactionType transactionType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Send(object obj, string label, valuetype System.Messaging.MessageQueueTransactionType transactionType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.Send(System.Object,System.String,System.Messaging.MessageQueueTransactionType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub Send (obj As Object, label As String, transactionType As MessageQueueTransactionType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Send(System::Object ^ obj, System::String ^ label, System::Messaging::MessageQueueTransactionType transactionType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="obj" Type="System.Object" />
        <Parameter Name="label" Type="System.String" />
        <Parameter Name="transactionType" Type="System.Messaging.MessageQueueTransactionType" />
      </Parameters>
      <Docs>
        <param name="obj"><span data-ttu-id="51fc7-3102">Объект, отправляемый в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3102">The object to send to the queue.</span></span></param>
        <param name="label"><span data-ttu-id="51fc7-3103">Метка сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3103">The label of the message.</span></span></param>
        <param name="transactionType"><span data-ttu-id="51fc7-3104">Одно из значений <see cref="T:System.Messaging.MessageQueueTransactionType" />, описывающее тип контекста транзакции, связываемого с сообщением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3104">One of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> values, describing the type of transaction context to associate with the message.</span></span></param>
        <summary><span data-ttu-id="51fc7-3105">Отправляет объект в очередь, на которую ссылается этот объект <see cref="T:System.Messaging.MessageQueue" />, и задает метку сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3105">Sends an object to the queue referenced by this <see cref="T:System.Messaging.MessageQueue" /> and specifies a label for the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3106">Используйте эту перегрузку, чтобы отправить сообщение, содержащее `obj` параметр в очередь, ссылается <xref:System.Messaging.MessageQueue>, с помощью контекста транзакции, определенного `transactionType` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3106">Use this overload to send a message that contains the `obj` parameter to the queue referenced by the <xref:System.Messaging.MessageQueue>, using a transaction context defined by the `transactionType` parameter.</span></span> <span data-ttu-id="51fc7-3107">Укажите `Automatic` для `transactionType` параметра, если он уже существует внешний контекст транзакции, присоединенного к потоку, который вы хотите использовать для отправки сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3107">Specify `Automatic` for the `transactionType` parameter if there is already an external transaction context attached to the thread that you want to use to send the message.</span></span> <span data-ttu-id="51fc7-3108">Укажите `Single` Если вы хотите отправить сообщение как одна внутренняя транзакция.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3108">Specify `Single` if you want to send the message as a single internal transaction.</span></span> <span data-ttu-id="51fc7-3109">Можно указать `None` Если вы хотите отправить транзактное сообщение в нетранзакционный поток.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3109">You can specify `None` if you want to send a transactional message to a non-transactional thread.</span></span>  
  
 <span data-ttu-id="51fc7-3110">Может быть объектом, который отправляется в очередь <xref:System.Messaging.Message> или любого управляемого объекта.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3110">The object you send to the queue can be a <xref:System.Messaging.Message> or any managed object.</span></span> <span data-ttu-id="51fc7-3111">При отправке любой объект, отличный от <xref:System.Messaging.Message>, он сериализуется и вставляется в текст сообщения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3111">If you send any object other than a <xref:System.Messaging.Message>, the object is serialized and inserted into the body of the message.</span></span> <span data-ttu-id="51fc7-3112">С помощью этой перегрузки можно указать строку метки, которая обозначает сообщение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3112">With this overload, you can specify the string label that identifies the message.</span></span>  
  
 <span data-ttu-id="51fc7-3113">Метка сообщения отличается от метки очереди сообщений, но оба зависят от приложения и не имеют внутреннего смысла для Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3113">The message label is distinct from the message queue label, but both are application-dependent and have no inherit meaning to Message Queuing.</span></span>  
  
 <span data-ttu-id="51fc7-3114">Если вы не установите <xref:System.Messaging.MessageQueue.Formatter%2A> свойство перед вызовом <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, модуль форматирования по умолчанию <xref:System.Messaging.XmlMessageFormatter>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3114">If you do not set the <xref:System.Messaging.MessageQueue.Formatter%2A> property before calling <xref:System.Messaging.MessageQueue.Send%28System.Object%29>, the formatter defaults to the <xref:System.Messaging.XmlMessageFormatter>.</span></span>  
  
 <span data-ttu-id="51fc7-3115"><xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> Свойство применяется к любой объект, отличный от <xref:System.Messaging.Message>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3115">The <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> property applies to any object other than a <xref:System.Messaging.Message>.</span></span> <span data-ttu-id="51fc7-3116">Если указать, например, метки или приоритета с помощью <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> член, эти значения применяются для любого сообщения, содержащего объект, который не относится к типу <xref:System.Messaging.Message> когда приложение отправляет его в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3116">If you specify, for example, a label or a priority using the <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A> member, these values apply to any message that contains an object that is not of type <xref:System.Messaging.Message> when your application sends it to the queue.</span></span> <span data-ttu-id="51fc7-3117">При отправке <xref:System.Messaging.Message>, задать значения свойств для <xref:System.Messaging.Message> имеют приоритет над <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>и сообщение <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> имеет приоритет над очереди <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3117">When sending a <xref:System.Messaging.Message>, the property values set for the <xref:System.Messaging.Message> take precedence over <xref:System.Messaging.MessageQueue.DefaultPropertiesToSend%2A>, and the message's <xref:System.Messaging.Message.Formatter%2A?displayProperty=nameWithType> property takes precedence over the queue's <xref:System.Messaging.MessageQueue.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="51fc7-3118">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3118">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3119">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3119">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3120">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3120">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3121">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3121">Local computer</span></span>|<span data-ttu-id="51fc7-3122">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3122">Yes</span></span>|  
|<span data-ttu-id="51fc7-3123">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3123">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3124">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3124">Yes</span></span>|  
|<span data-ttu-id="51fc7-3125">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3125">Remote computer</span></span>|<span data-ttu-id="51fc7-3126">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3126">No</span></span>|  
|<span data-ttu-id="51fc7-3127">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3127">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3128">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3128">Yes</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3129">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3129">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.Send%28System.Object%2CSystem.String%2CSystem.Messaging.MessageQueueTransactionType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#3](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#3)]
 [!code-csharp[MessageQueue2#3](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="51fc7-3130">Параметр <paramref name="label" /> имеет значение <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3130">The <paramref name="label" /> parameter is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueTransaction"><span data-ttu-id="51fc7-3131">Приложение Message Queuing указало на неверное использование транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3131">The Message Queuing application indicated an incorrect transaction usage.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException"><span data-ttu-id="51fc7-3132">Параметр <paramref name="transactionType" /> не является одним из членов <see cref="T:System.Messaging.MessageQueueTransactionType" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3132">The <paramref name="transactionType" /> parameter is not one of the <see cref="T:System.Messaging.MessageQueueTransactionType" /> members.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3133">Свойство <see cref="P:System.Messaging.MessageQueue.Path" /> не установлено.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3133">The <see cref="P:System.Messaging.MessageQueue.Path" /> property has not been set.</span></span>  
  
 <span data-ttu-id="51fc7-3134">- или -</span><span class="sxs-lookup"><span data-stu-id="51fc7-3134">-or-</span></span>  
  
 <span data-ttu-id="51fc7-3135">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3135">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="T:System.Messaging.MessageQueueTransactionType" />
        <altmember cref="P:System.Messaging.MessageQueue.DefaultPropertiesToSend" />
        <altmember cref="T:System.Messaging.Message" />
        <altmember cref="P:System.Messaging.MessageQueue.Transactional" />
        <altmember cref="P:System.Messaging.MessageQueue.Label" />
        <altmember cref="M:System.Messaging.MessageQueue.Peek" />
        <altmember cref="M:System.Messaging.MessageQueue.Receive" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginPeek" />
        <altmember cref="M:System.Messaging.MessageQueue.BeginReceive" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SetPermissions">
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="51fc7-3136">Добавляет разрешения в текущий набор.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3136">Adds permissions to the current set.</span></span> <span data-ttu-id="51fc7-3137">Это позволяет контролировать, кто имеет права доступа к свойствам очереди и сообщениям в очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3137">This controls who has access rights to queue properties and messages in the queue.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.AccessControlList dacl);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.AccessControlList dacl) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.AccessControlList)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (dacl As AccessControlList)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::AccessControlList ^ dacl);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="dacl" Type="System.Messaging.AccessControlList" />
      </Parameters>
      <Docs>
        <param name="dacl"><span data-ttu-id="51fc7-3138">Объект <see cref="T:System.Messaging.AccessControlList" />, содержащий не менее одного элемента управления доступом, в которых указаны доверенные лица и предоставляемые разрешения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3138">A <see cref="T:System.Messaging.AccessControlList" /> that contains one or more access control entries that specify the trustees and the permissions to grant.</span></span></param>
        <summary><span data-ttu-id="51fc7-3139">Назначает права доступа к очереди на основе содержимого списка управления доступом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3139">Assigns access rights to the queue based on the contents of an access control list.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3140">Используйте этот перегруженный метод для предоставления, запрета или отмены прав с помощью коллекции элементов управления доступом для указания доверенного лица и сведения о разрешениях.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3140">Use this overload to grant, deny, or revoke rights by using a collection of access control entries to specify trustee and permissions information.</span></span> <span data-ttu-id="51fc7-3141">Это используется, например, для предоставления разрешений нескольким пользователям одновременно.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3141">This is used, for example, to grant permissions to multiple users at the same time.</span></span>  
  
 <span data-ttu-id="51fc7-3142">Доверенное лицо, указывается при создании `ace` параметр может иметь отдельного пользователя, компьютера или группы пользователей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3142">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="51fc7-3143">Если доверенное лицо — это человек, используйте формат `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3143">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="51fc7-3144">Можно указать «.» для для указания локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3144">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-3145">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3145">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="51fc7-3146">По умолчанию создатель общей или частной очереди имеет полный доступ и группы домена, все имеют разрешение на получение свойств очередей и получить разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3146">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="51fc7-3147">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3147">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="51fc7-3148">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3148">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="51fc7-3149">Отказано в доступе <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3149">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="51fc7-3150">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потока явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3150">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="51fc7-3151">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3151">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="51fc7-3152">При построении `dacl` добавить параметр, <xref:System.Messaging.AccessControlEntry> экземпляров для вашего <xref:System.Messaging.AccessControlList> коллекции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3152">When you construct the `dacl` parameter, you add <xref:System.Messaging.AccessControlEntry> instances to your <xref:System.Messaging.AccessControlList> collection.</span></span> <span data-ttu-id="51fc7-3153">При создании каждой записи управления доступом, можно указать универсальный и стандартные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3153">When you construct each access control entry, you can specify generic or standard access rights.</span></span> <span data-ttu-id="51fc7-3154">Права в очередь, могут быть любым сочетанием следующих:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3154">The rights to a queue can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="51fc7-3155">Удаление</span><span class="sxs-lookup"><span data-stu-id="51fc7-3155">Delete</span></span>  
  
-   <span data-ttu-id="51fc7-3156">Чтение параметров безопасности</span><span class="sxs-lookup"><span data-stu-id="51fc7-3156">Read Security</span></span>  
  
-   <span data-ttu-id="51fc7-3157">Записи безопасности</span><span class="sxs-lookup"><span data-stu-id="51fc7-3157">Write Security</span></span>  
  
-   <span data-ttu-id="51fc7-3158">Синхронизация</span><span class="sxs-lookup"><span data-stu-id="51fc7-3158">Synchronize</span></span>  
  
-   <span data-ttu-id="51fc7-3159">Изменение владельца</span><span class="sxs-lookup"><span data-stu-id="51fc7-3159">Modify Owner</span></span>  
  
-   <span data-ttu-id="51fc7-3160">Чтение</span><span class="sxs-lookup"><span data-stu-id="51fc7-3160">Read</span></span>  
  
-   <span data-ttu-id="51fc7-3161">Write</span><span class="sxs-lookup"><span data-stu-id="51fc7-3161">Write</span></span>  
  
-   <span data-ttu-id="51fc7-3162">Выполнение</span><span class="sxs-lookup"><span data-stu-id="51fc7-3162">Execute</span></span>  
  
-   <span data-ttu-id="51fc7-3163">Обязательно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3163">Required</span></span>  
  
-   <span data-ttu-id="51fc7-3164">Все</span><span class="sxs-lookup"><span data-stu-id="51fc7-3164">All</span></span>  
  
-   <span data-ttu-id="51fc7-3165">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3165">None</span></span>  
  
 <span data-ttu-id="51fc7-3166">Эти права представляют собой набор битовых флагов, которые можно комбинировать с помощью побитового оператора OR.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3166">These rights are a set of bit flags that you can combine using the OR bitwise operator.</span></span>  
  
-   <span data-ttu-id="51fc7-3167">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="51fc7-3167">Full Control</span></span>  
  
-   <span data-ttu-id="51fc7-3168">Удаление сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3168">Delete Message</span></span>  
  
-   <span data-ttu-id="51fc7-3169">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="51fc7-3169">Receive Message</span></span>  
  
-   <span data-ttu-id="51fc7-3170">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3170">Peek Message</span></span>  
  
-   <span data-ttu-id="51fc7-3171">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-3171">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="51fc7-3172">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3172">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3173">Задать свойства очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3173">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3174">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3174">Get Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3175">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3175">Set Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3176">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3176">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="51fc7-3177">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3177">Write Message</span></span>  
  
 <span data-ttu-id="51fc7-3178">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3178">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3179">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3179">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3180">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3180">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3181">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3181">Local computer</span></span>|<span data-ttu-id="51fc7-3182">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3182">Yes</span></span>|  
|<span data-ttu-id="51fc7-3183">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3183">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3184">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3184">Yes</span></span>|  
|<span data-ttu-id="51fc7-3185">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3185">Remote computer</span></span>|<span data-ttu-id="51fc7-3186">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3186">No</span></span>|  
|<span data-ttu-id="51fc7-3187">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3187">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3188">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3188">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3189">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3189">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.AccessControlList%29>.</span></span>      
  
 [!code-cpp[MessageQueue2#26](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#26)]
 [!code-csharp[MessageQueue2#26](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#26)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3190">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3190">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.AccessControlList" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (System.Messaging.MessageQueueAccessControlEntry ace);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(class System.Messaging.MessageQueueAccessControlEntry ace) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.Messaging.MessageQueueAccessControlEntry)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (ace As MessageQueueAccessControlEntry)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::Messaging::MessageQueueAccessControlEntry ^ ace);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ace" Type="System.Messaging.MessageQueueAccessControlEntry" />
      </Parameters>
      <Docs>
        <param name="ace"><span data-ttu-id="51fc7-3191">Объект <see cref="T:System.Messaging.MessageQueueAccessControlEntry" />, который указывает пользователя, тип доступа и тип разрешения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3191">A <see cref="T:System.Messaging.MessageQueueAccessControlEntry" /> that specifies a user, an access type, and a permission type.</span></span></param>
        <summary><span data-ttu-id="51fc7-3192">Назначает права доступа к очереди на основе содержимого элемента управления доступом.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3192">Assigns access rights to the queue based on the contents of an access control entry.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3193">Используйте эту перегрузку для предоставления, запрета или отмены прав с помощью записи управления доступом для указания доверенного лица и сведения о разрешениях.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3193">Use this overload to grant, deny, or revoke rights by using an access control entry to specify trustee and rights information.</span></span>  
  
 <span data-ttu-id="51fc7-3194">Доверенное лицо, указывается при создании `ace` параметр может иметь отдельного пользователя, компьютера или группы пользователей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3194">The trustee you specify when you construct the `ace` parameter can be an individual user, a group of users, or a computer.</span></span> <span data-ttu-id="51fc7-3195">Если доверенное лицо — это человек, используйте формат `DOMAIN` \\ `user`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3195">If the trustee is an individual, use the format `DOMAIN`\\`user`.</span></span> <span data-ttu-id="51fc7-3196">Можно указать «.» для для указания локального компьютера.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3196">You can specify "." for the trustee to indicate the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-3197">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3197">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="51fc7-3198">По умолчанию создатель общей или частной очереди имеет полный доступ и группы домена, все имеют разрешение на получение свойств очередей и получить разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3198">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="51fc7-3199">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3199">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="51fc7-3200">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3200">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="51fc7-3201">Отказано в доступе <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3201">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="51fc7-3202">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потока явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3202">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="51fc7-3203">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3203">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="51fc7-3204">Права в очередь, которая задается в `rights` при построении вашей <xref:System.Messaging.MessageQueueAccessControlEntry>, может быть любым сочетанием следующих:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3204">The rights to a queue, which you specify in the `rights` parameter when you construct your <xref:System.Messaging.MessageQueueAccessControlEntry>, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="51fc7-3205">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="51fc7-3205">Full Control</span></span>  
  
-   <span data-ttu-id="51fc7-3206">Удаление сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3206">Delete Message</span></span>  
  
-   <span data-ttu-id="51fc7-3207">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="51fc7-3207">Receive Message</span></span>  
  
-   <span data-ttu-id="51fc7-3208">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3208">Peek Message</span></span>  
  
-   <span data-ttu-id="51fc7-3209">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-3209">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="51fc7-3210">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3210">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3211">Задать свойства очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3211">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3212">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3212">Get Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3213">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3213">Set Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3214">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3214">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="51fc7-3215">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3215">Write Message</span></span>  
  
 <span data-ttu-id="51fc7-3216">`rights` Задать в конструкторе для параметра `ace` параметр является флагом <xref:System.Messaging.MessageQueueAccessRights> перечисления.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3216">The `rights` parameter you specify in the constructor for the `ace` parameter is a flag of the <xref:System.Messaging.MessageQueueAccessRights> enumeration.</span></span> <span data-ttu-id="51fc7-3217">Он представляет набор битовых флагов, которые можно комбинировать с помощью побитового оператора OR при построении `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3217">It represents a set of bit flags that you can combine using the bitwise operator OR when you build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-3218">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3218">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3219">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3219">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3220">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3220">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3221">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3221">Local computer</span></span>|<span data-ttu-id="51fc7-3222">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3222">Yes</span></span>|  
|<span data-ttu-id="51fc7-3223">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3223">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3224">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3224">Yes</span></span>|  
|<span data-ttu-id="51fc7-3225">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3225">Remote computer</span></span>|<span data-ttu-id="51fc7-3226">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3226">No</span></span>|  
|<span data-ttu-id="51fc7-3227">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3227">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3228">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3228">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3229">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3229">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.Messaging.MessageQueueAccessControlEntry%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#24](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#24)]
 [!code-csharp[MessageQueue2#24](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#24)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3230">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3230">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.MessageQueueAccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="51fc7-3231">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3231">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="51fc7-3232">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который указывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <c>user</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3232">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span></span></param>
        <summary><span data-ttu-id="51fc7-3233">Предоставляет компьютеру, группе или пользователю указанные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3233">Gives a computer, group, or user the specified access rights.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3234">Используйте эту перегрузку для предоставления указанных прав отдельным пользователям.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3234">Use this overload to grant specified rights to an individual user.</span></span> <span data-ttu-id="51fc7-3235">Пользователь может быть любое действительное доверенное лицо, включая отдельных пользователей, групп пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3235">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="51fc7-3236">Если пользователь — это человек, используйте формат `DOMAIN` \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3236">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="51fc7-3237">Можно указать «.» для `user` параметр, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3237">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-3238">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3238">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="51fc7-3239">По умолчанию создатель общей или частной очереди имеет полный доступ и группы домена, все имеют разрешение на получение свойств очередей и получить разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3239">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="51fc7-3240">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3240">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="51fc7-3241">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3241">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="51fc7-3242">Отказано в доступе <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3242">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="51fc7-3243">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потока явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3243">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="51fc7-3244">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3244">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="51fc7-3245">Права очереди, указанные в `rights` параметр, может быть любым сочетанием следующих:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3245">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="51fc7-3246">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="51fc7-3246">Full Control</span></span>  
  
-   <span data-ttu-id="51fc7-3247">Удаление сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3247">Delete Message</span></span>  
  
-   <span data-ttu-id="51fc7-3248">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="51fc7-3248">Receive Message</span></span>  
  
-   <span data-ttu-id="51fc7-3249">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3249">Peek Message</span></span>  
  
-   <span data-ttu-id="51fc7-3250">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-3250">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="51fc7-3251">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3251">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3252">Задать свойства очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3252">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3253">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3253">Get Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3254">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3254">Set Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3255">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3255">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="51fc7-3256">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3256">Write Message</span></span>  
  
 <span data-ttu-id="51fc7-3257"><xref:System.Messaging.MessageQueueAccessRights> Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью оператора побитового или для создания `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3257">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-3258">Эта перегрузка может предоставлять разрешения только; не удается отменить или запретить их.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3258">With this overload, you can only grant permissions; you cannot revoke or deny them.</span></span> <span data-ttu-id="51fc7-3259">Необходимо использовать другую перегрузку метода для явного предоставления иного <xref:System.Messaging.AccessControlEntryType> отличный от `Allow`.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3259">You must use a different overload to explicitly grant any <xref:System.Messaging.AccessControlEntryType> other than `Allow`.</span></span>  
  
 <span data-ttu-id="51fc7-3260">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3260">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3261">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3261">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3262">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3262">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3263">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3263">Local computer</span></span>|<span data-ttu-id="51fc7-3264">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3264">Yes</span></span>|  
|<span data-ttu-id="51fc7-3265">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3265">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3266">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3266">Yes</span></span>|  
|<span data-ttu-id="51fc7-3267">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3267">Remote computer</span></span>|<span data-ttu-id="51fc7-3268">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3268">No</span></span>|  
|<span data-ttu-id="51fc7-3269">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3269">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3270">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3270">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3271">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3271">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#23](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#23)]
 [!code-csharp[MessageQueue2#23](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#23)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="51fc7-3272">Значение параметра <paramref name="user" /> — <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3272">The <paramref name="user" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3273">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3273">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
      </Docs>
    </Member>
    <Member MemberName="SetPermissions">
      <MemberSignature Language="C#" Value="public void SetPermissions (string user, System.Messaging.MessageQueueAccessRights rights, System.Messaging.AccessControlEntryType entryType);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void SetPermissions(string user, valuetype System.Messaging.MessageQueueAccessRights rights, valuetype System.Messaging.AccessControlEntryType entryType) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Messaging.MessageQueue.SetPermissions(System.String,System.Messaging.MessageQueueAccessRights,System.Messaging.AccessControlEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetPermissions (user As String, rights As MessageQueueAccessRights, entryType As AccessControlEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetPermissions(System::String ^ user, System::Messaging::MessageQueueAccessRights rights, System::Messaging::AccessControlEntryType entryType);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="user" Type="System.String" />
        <Parameter Name="rights" Type="System.Messaging.MessageQueueAccessRights" />
        <Parameter Name="entryType" Type="System.Messaging.AccessControlEntryType" />
      </Parameters>
      <Docs>
        <param name="user"><span data-ttu-id="51fc7-3274">Отдельный пользователь, группа или компьютер, которые получают дополнительные права на работу с очередью.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3274">The individual, group, or computer that gets additional rights to the queue.</span></span></param>
        <param name="rights"><span data-ttu-id="51fc7-3275">Объект <see cref="T:System.Messaging.MessageQueueAccessRights" />, который указывает набор прав на работу с очередью, которые назначаются службой очереди сообщений параметру <c>user</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3275">A <see cref="T:System.Messaging.MessageQueueAccessRights" /> that indicates the set of rights to the queue that Message Queuing assigns to the <c>user</c> passed in.</span></span></param>
        <param name="entryType"><span data-ttu-id="51fc7-3276">Объект <see cref="T:System.Messaging.AccessControlEntryType" />, который указывает, нужно ли предоставить разрешения, отказать в предоставлении разрешений или отозвать разрешения, заданные в параметре <c>rights</c>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3276">A <see cref="T:System.Messaging.AccessControlEntryType" /> that specifies whether to grant, deny, or revoke the permissions specified by the <c>rights</c> parameter.</span></span></param>
        <summary><span data-ttu-id="51fc7-3277">Предоставляет компьютеру, группе или пользователю указанные права доступа указанного типа управления доступом (разрешить, отказать, отозвать или задать).</span><span class="sxs-lookup"><span data-stu-id="51fc7-3277">Gives a computer, group, or user the specified access rights, with the specified access control type (allow, deny, revoke, or set).</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3278">Используйте эту перегрузку для предоставления, запрета или отмены указанные права для отдельного пользователя.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3278">Use this overload to grant, deny, or revoke specified rights for an individual user.</span></span> <span data-ttu-id="51fc7-3279">Пользователь может быть любое действительное доверенное лицо, включая отдельных пользователей, групп пользователей или компьютер.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3279">The user can be any valid trustee, which includes individual users, groups of users, or a computer.</span></span> <span data-ttu-id="51fc7-3280">Если пользователь — это человек, используйте формат `DOMAIN` \\ `user` для `user` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3280">If the user is an individual, use the format `DOMAIN`\\`user` for the `user` parameter.</span></span> <span data-ttu-id="51fc7-3281">Можно указать «.» для `user` параметр, чтобы указать локальный компьютер.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3281">You can specify "." for the `user` parameter to indicate the local computer.</span></span>  
  
 <span data-ttu-id="51fc7-3282">Разрешения, назначенные с помощью <xref:System.Messaging.MessageQueue.SetPermissions%2A> добавить права в существующий список.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3282">The permissions you assign through <xref:System.Messaging.MessageQueue.SetPermissions%2A> add rights to the existing list.</span></span> <span data-ttu-id="51fc7-3283">По умолчанию создатель общей или частной очереди имеет полный доступ и группы домена, все имеют разрешение на получение свойств очередей и получить разрешения записи в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3283">By default, the creator of a public or private queue has full control, and the domain group Everyone has permission to get queue properties, get permissions, and write to the queue.</span></span> <span data-ttu-id="51fc7-3284">При вызове <xref:System.Messaging.MessageQueue.SetPermissions%2A>, разрешения пользователей и добавляется в конец существующего списка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3284">When you call <xref:System.Messaging.MessageQueue.SetPermissions%2A>, the user and permissions information is appended to the bottom of the existing list.</span></span>  
  
 <span data-ttu-id="51fc7-3285">Система проверяет каждую <xref:System.Messaging.AccessControlEntry> в последовательности, пока не произойдет одно из следующих событий:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3285">The system examines each <xref:System.Messaging.AccessControlEntry> in sequence until one of the following events occurs:</span></span>  
  
-   <span data-ttu-id="51fc7-3286">Отказано в доступе <xref:System.Messaging.AccessControlEntry> явным образом запрещает любое из запрошенных прав доступа к одному из доверенных лиц, указанных в маркере доступа потока.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3286">An access-denied <xref:System.Messaging.AccessControlEntry> explicitly denies any of the requested access rights to one of the trustees listed in the thread's access token.</span></span>  
  
-   <span data-ttu-id="51fc7-3287">Один или несколько разрешения доступа <xref:System.Messaging.AccessControlEntry> элементы для доверенных лиц, перечисленных в маркере доступа потока явно предоставлять все запрошенные права доступа.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3287">One or more access-allowed <xref:System.Messaging.AccessControlEntry> items for trustees listed in the thread's access token explicitly grant all the requested access rights.</span></span>  
  
-   <span data-ttu-id="51fc7-3288">Все <xref:System.Messaging.AccessControlEntry> элементы были проверены и имеется хотя бы одного запрашиваемого права доступа имеет явного разрешения, в доступе будет отказано.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3288">All <xref:System.Messaging.AccessControlEntry> items have been checked and there is still at least one requested access right that has not been explicitly allowed, in which case, access is implicitly denied.</span></span>  
  
 <span data-ttu-id="51fc7-3289">Права очереди, указанные в `rights` параметр, может быть любым сочетанием следующих:</span><span class="sxs-lookup"><span data-stu-id="51fc7-3289">The rights to a queue, specified in the `rights` parameter, can be any combination of the following:</span></span>  
  
-   <span data-ttu-id="51fc7-3290">Полный доступ</span><span class="sxs-lookup"><span data-stu-id="51fc7-3290">Full Control</span></span>  
  
-   <span data-ttu-id="51fc7-3291">Удаление сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3291">Delete Message</span></span>  
  
-   <span data-ttu-id="51fc7-3292">Сообщение об ошибке</span><span class="sxs-lookup"><span data-stu-id="51fc7-3292">Receive Message</span></span>  
  
-   <span data-ttu-id="51fc7-3293">Просмотр сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3293">Peek Message</span></span>  
  
-   <span data-ttu-id="51fc7-3294">Получение сообщения журнала</span><span class="sxs-lookup"><span data-stu-id="51fc7-3294">Receive Journal Message</span></span>  
  
-   <span data-ttu-id="51fc7-3295">Получение свойств очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3295">Get Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3296">Задать свойства очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3296">Set Queue Properties</span></span>  
  
-   <span data-ttu-id="51fc7-3297">Получение разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3297">Get Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3298">Установка разрешений</span><span class="sxs-lookup"><span data-stu-id="51fc7-3298">Set Permissions</span></span>  
  
-   <span data-ttu-id="51fc7-3299">Стать владельцем очереди</span><span class="sxs-lookup"><span data-stu-id="51fc7-3299">Take Queue Ownership</span></span>  
  
-   <span data-ttu-id="51fc7-3300">Запись сообщения</span><span class="sxs-lookup"><span data-stu-id="51fc7-3300">Write Message</span></span>  
  
 <span data-ttu-id="51fc7-3301"><xref:System.Messaging.MessageQueueAccessRights> Перечисление представляет набор битовых флагов, которые можно комбинировать с помощью оператора побитового или для создания `rights` параметра.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3301">The <xref:System.Messaging.MessageQueueAccessRights> enumeration represents a set of bit flags that you can combine using the bitwise operator OR to build the `rights` parameter.</span></span>  
  
 <span data-ttu-id="51fc7-3302">Следующая таблица показывает, доступен ли этот метод в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3302">The following table shows whether this method is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3303">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3303">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3304">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3304">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3305">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3305">Local computer</span></span>|<span data-ttu-id="51fc7-3306">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3306">Yes</span></span>|  
|<span data-ttu-id="51fc7-3307">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3307">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3308">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3308">Yes</span></span>|  
|<span data-ttu-id="51fc7-3309">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3309">Remote computer</span></span>|<span data-ttu-id="51fc7-3310">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3310">No</span></span>|  
|<span data-ttu-id="51fc7-3311">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3311">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3312">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3312">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3313">В следующем коде показано использование функции <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3313">The following code example demonstrates the use of <xref:System.Messaging.MessageQueue.SetPermissions%28System.String%2CSystem.Messaging.MessageQueueAccessRights%2CSystem.Messaging.AccessControlEntryType%29>.</span></span>  
  
 [!code-cpp[MessageQueue2#25](~/samples/snippets/cpp/VS_Snippets_Remoting/MessageQueue2/cpp/class1.cpp#25)]
 [!code-csharp[MessageQueue2#25](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue2/CS/class1.cs#25)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3314">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3314">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueue.ResetPermissions" />
        <altmember cref="T:System.Messaging.Trustee" />
        <altmember cref="T:System.Messaging.MessageQueueAccessRights" />
        <altmember cref="T:System.Messaging.AccessControlEntry" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_SynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-3315">Получает или задает объект, который используется для маршалинга вызовов обработчика событий, возникающих в результате наступления события <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или события <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3315">Gets or sets the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span></summary>
        <value><span data-ttu-id="51fc7-3316">Объект <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, представляющий объект, который выполняет маршалинг вызова обработчика событий, причиной которого стало событие <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> или <see cref="E:System.Messaging.MessageQueue.PeekCompleted" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3316">A <see cref="T:System.ComponentModel.ISynchronizeInvoke" />, which represents the object that marshals the event-handler call resulting from a <see cref="E:System.Messaging.MessageQueue.ReceiveCompleted" /> or <see cref="E:System.Messaging.MessageQueue.PeekCompleted" /> event.</span></span> <span data-ttu-id="51fc7-3317">Значение по умолчанию: <see langword="null" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3317">The default is <see langword="null" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3318">Объект <xref:System.Messaging.MessageQueue.ReceiveCompleted> или <xref:System.Messaging.MessageQueue.PeekCompleted> причиной событий <xref:System.Messaging.MessageQueue.BeginReceive%2A> или <xref:System.Messaging.MessageQueue.BeginPeek%2A> , соответственно, запрос для определенного потока.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3318">A <xref:System.Messaging.MessageQueue.ReceiveCompleted> or <xref:System.Messaging.MessageQueue.PeekCompleted> event results from a <xref:System.Messaging.MessageQueue.BeginReceive%2A> or <xref:System.Messaging.MessageQueue.BeginPeek%2A> request, respectively, to a specific thread.</span></span> <span data-ttu-id="51fc7-3319">Как правило <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> задается при его связанный компонент помещается внутри элемента управления или формы, так как эти компоненты привязаны к определенному потоку.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3319">Typically, the <xref:System.Messaging.MessageQueue.SynchronizingObject%2A> is set when its related component is placed inside a control or a form, because those components are bound to a specific thread.</span></span>  
  
 <span data-ttu-id="51fc7-3320">Как правило синхронизирующий объект маршалирует вызов метода в один поток.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3320">Typically, the synchronizing object marshals a method call into a single thread.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="E:System.Messaging.MessageQueue.PeekCompleted" />
        <altmember cref="E:System.Messaging.MessageQueue.ReceiveCompleted" />
      </Docs>
    </Member>
    <Member MemberName="Transactional">
      <MemberSignature Language="C#" Value="public bool Transactional { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool Transactional" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.Transactional" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Transactional As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool Transactional { bool get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_Transactional")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-3321">Получает значение, указывающее, принимает ли очередь только транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3321">Gets a value that indicates whether the queue accepts only transactions.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-3322">Значение <see langword="true" />, если очередь принимает только сообщения, отправляемые как часть транзакции; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3322"><see langword="true" /> if the queue accepts only messages sent as part of a transaction; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3323">Обмен транзакционными сообщениями относится к объединению нескольких связанных сообщений в одну транзакцию.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3323">Transactional messaging refers to the coupling of several related messages into a single transaction.</span></span> <span data-ttu-id="51fc7-3324">Отправка сообщений как части транзакции гарантирует, что сообщения доставляются по порядку, только один раз и будут успешно извлечены из очереди назначения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3324">Sending messages as part of a transaction ensures that the messages are delivered in order, delivered only once, and successfully retrieved from their destination queue.</span></span>  
  
 <span data-ttu-id="51fc7-3325">Если очередь является транзакционной, он принимает только сообщения, отправляемые как часть транзакции.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3325">If a queue is transactional, it accepts only messages that are sent as part of a transaction.</span></span> <span data-ttu-id="51fc7-3326">Однако нетранзакционное сообщение можно передавать и получать из локальной очереди транзакций без явного использования транзакций <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, и <xref:System.Messaging.MessageQueueTransaction.Abort%2A> синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3326">However, a non-transactional message can be sent or received from a local transaction queue without explicitly using transactional <xref:System.Messaging.MessageQueueTransaction.Begin%2A>, <xref:System.Messaging.MessageQueueTransaction.Commit%2A>, and <xref:System.Messaging.MessageQueueTransaction.Abort%2A> syntax.</span></span> <span data-ttu-id="51fc7-3327">Если нетранзакционное сообщение отправляется в транзакционную очередь, этот компонент создаст транзакцию одного сообщения для него, за исключением того, в случае обращение к очереди на удаленном компьютере с помощью непосредственного имени формата.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3327">If a non-transactional message is sent to a transactional queue, this component creates a single-message transaction for it, except in the case of referencing a queue on a remote computer using a direct format name.</span></span> <span data-ttu-id="51fc7-3328">В этом случае если вы не укажете контекста транзакции при отправке сообщения, он не будет создан автоматически и это сообщение будет отправлено в очередь недоставленных сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3328">In this situation, if you do not specify a transaction context when sending a message, one is not created for you and the message will be sent to the dead-letter queue.</span></span>  
  
 <span data-ttu-id="51fc7-3329">Если нетранзакционное сообщение отправляется в транзакционную очередь, не появится возможность откатить сообщение при возникновении исключения.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3329">If you send a non-transactional message to a transactional queue, you will not be able to roll back the message in the event of an exception.</span></span>  
  
 <span data-ttu-id="51fc7-3330"><xref:System.Messaging.MessageQueueTransaction> Потоковый подразделения знать, поэтому если состояние апартамента — `STA`, транзакции нельзя использовать в нескольких потоках.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3330"><xref:System.Messaging.MessageQueueTransaction> is threading apartment aware, so if your apartment state is `STA`, you cannot use the transaction in multiple threads.</span></span> <span data-ttu-id="51fc7-3331">Visual Basic устанавливает состояние основного потока в `STA`, поэтому необходимо применить <xref:System.MTAThreadAttribute> в `Main` подпрограммы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3331">Visual Basic sets the state of the main thread to `STA`, so you must apply the <xref:System.MTAThreadAttribute> in the `Main` subroutine.</span></span> <span data-ttu-id="51fc7-3332">В противном случае при отправке транзакционного сообщения с помощью другого потока создастся исключение <xref:System.Messaging.MessageQueueException>.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3332">Otherwise, sending a transactional message using another thread throws a <xref:System.Messaging.MessageQueueException> exception.</span></span> <span data-ttu-id="51fc7-3333">Можно применить <xref:System.MTAThreadAttribute> , используя следующий фрагмент.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3333">You apply the <xref:System.MTAThreadAttribute> by using the following fragment.</span></span>  
  
```vb  
<System.MTAThreadAttribute>  
 public sub Main()  
```  
  
 <span data-ttu-id="51fc7-3334">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3334">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3335">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3335">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3336">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3336">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3337">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3337">Local computer</span></span>|<span data-ttu-id="51fc7-3338">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3338">Yes</span></span>|  
|<span data-ttu-id="51fc7-3339">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3339">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3340">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3340">Yes</span></span>|  
|<span data-ttu-id="51fc7-3341">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3341">Remote computer</span></span>|<span data-ttu-id="51fc7-3342">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3342">No</span></span>|  
|<span data-ttu-id="51fc7-3343">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3343">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3344">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3344">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3345">В следующем примере кода отображает значение очередью сообщений <xref:System.Messaging.MessageQueue.Transactional%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3345">The following code example displays the value of a message queue's <xref:System.Messaging.MessageQueue.Transactional%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#27](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#27)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3346">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3346">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Begin" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Commit" />
        <altmember cref="M:System.Messaging.MessageQueueTransaction.Abort" />
        <altmember cref="P:System.Messaging.Message.TransactionId" />
        <altmember cref="P:System.Messaging.Message.IsFirstInTransaction" />
        <altmember cref="P:System.Messaging.Message.IsLastInTransaction" />
      </Docs>
    </Member>
    <Member MemberName="UseJournalQueue">
      <MemberSignature Language="C#" Value="public bool UseJournalQueue { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool UseJournalQueue" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.UseJournalQueue" />
      <MemberSignature Language="VB.NET" Value="Public Property UseJournalQueue As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool UseJournalQueue { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-3347">Получает или задает значение, указывающее, должны ли полученные сообщения копироваться в очередь журнала.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3347">Gets or sets a value that indicates whether received messages are copied to the journal queue.</span></span></summary>
        <value>
          <span data-ttu-id="51fc7-3348">Значение <see langword="true" />, если сообщения, полученные из очереди, копируются в очередь журнала; в противном случае — значение <see langword="false" />.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3348"><see langword="true" /> if messages received from the queue are copied to its journal queue; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3349">Когда приложения Message Queuing создает новую очередь приложения, автоматически создает связанную очередь журнала в том же расположении.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3349">When the Message Queuing application creates a new application queue, it automatically creates an associated journal queue in the same location.</span></span> <span data-ttu-id="51fc7-3350">Очередь журнала используется для отслеживания сообщений, удаленных из очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3350">The journal queue is used to track the messages removed from a queue.</span></span> <span data-ttu-id="51fc7-3351">Задание этого свойства изменяет очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3351">Setting this property modifies the Message Queuing queue.</span></span> <span data-ttu-id="51fc7-3352">Таким образом, любые другие <xref:System.Messaging.MessageQueue> экземпляры являются повлияло изменение.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3352">Therefore, any other <xref:System.Messaging.MessageQueue> instances are affected by the change.</span></span>  
  
 <span data-ttu-id="51fc7-3353">Очередь журнала не отслеживает сообщений, удаленных из очереди, так как время получения истечения, а также отслеживать сообщения, удаленные из очереди с помощью службы каталогов очереди сообщений (банка данных или Active Directory).</span><span class="sxs-lookup"><span data-stu-id="51fc7-3353">The journal queue does not track messages removed from the queue because their time-to-be-received timer expired, nor does it track messages purged from the queue by using a Message Queuing directory service (Information Store or Active Directory).</span></span>  
  
 <span data-ttu-id="51fc7-3354">Приложения не могут отправлять сообщения в очереди журнала; они ограничены доступ только для чтения этих очередей.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3354">Applications cannot send messages to journal queues; they are limited to read-only access of these queues.</span></span> <span data-ttu-id="51fc7-3355">Кроме того очереди сообщений никогда не удаляет сообщения из очередей журнала.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3355">Furthermore, Message Queuing never removes messages from journal queues.</span></span> <span data-ttu-id="51fc7-3356">Приложения, использующего очереди необходимо снять эти сообщения, получив их или очистка очереди.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3356">The application using the queue must clear these messages either by receiving them or by purging the queue.</span></span>  
  
 <span data-ttu-id="51fc7-3357">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3357">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3358">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3358">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3359">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3359">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3360">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3360">Local computer</span></span>|<span data-ttu-id="51fc7-3361">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3361">Yes</span></span>|  
|<span data-ttu-id="51fc7-3362">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3362">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3363">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3363">Yes</span></span>|  
|<span data-ttu-id="51fc7-3364">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3364">Remote computer</span></span>|<span data-ttu-id="51fc7-3365">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3365">No</span></span>|  
|<span data-ttu-id="51fc7-3366">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3366">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3367">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3367">No</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="51fc7-3368">В следующем примере кода возвращает и задает значение очередью сообщений <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3368">The following code example gets and sets the value of a message queue's <xref:System.Messaging.MessageQueue.UseJournalQueue%2A> property.</span></span>  
  
 [!code-csharp[MessageQueue#28](~/samples/snippets/csharp/VS_Snippets_Remoting/MessageQueue/CS/class1.cs#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3369">При обращении к методу службы очереди сообщений возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3369">An error occurred when accessing a Message Queuing method.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.MaximumJournalSize" />
      </Docs>
    </Member>
    <Member MemberName="WriteHandle">
      <MemberSignature Language="C#" Value="public IntPtr WriteHandle { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance native int WriteHandle" />
      <MemberSignature Language="DocId" Value="P:System.Messaging.MessageQueue.WriteHandle" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property WriteHandle As IntPtr" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property IntPtr WriteHandle { IntPtr get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Messaging</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Messaging.MessagingDescription("MQ_WriteHandle")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.IntPtr</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="51fc7-3370">Получает собственный дескриптор, который используется для отправки сообщений в очередь сообщений.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3370">Gets the native handle used to send messages to the message queue.</span></span></summary>
        <value><span data-ttu-id="51fc7-3371">Дескриптор собственного объекта очереди, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3371">A handle to the native queue object that you use for sending messages to the queue.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="51fc7-3372"><xref:System.Messaging.MessageQueue.WriteHandle%2A> Предоставляет собственный дескриптор Windows для объекта очереди сообщений, который используется для отправки сообщений в очередь.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3372">The <xref:System.Messaging.MessageQueue.WriteHandle%2A> provides a native Windows handle to the message queue object that is used for sending messages to the queue.</span></span> <span data-ttu-id="51fc7-3373">Если изменить путь к очереди, дескриптор закрыт и открыт повторно с новым значением.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3373">If you change the path of the queue, the handle is closed and reopened with a new value.</span></span>  
  
 <span data-ttu-id="51fc7-3374">В следующей таблице показаны ли это свойство доступно в различных режимах рабочей группы.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3374">The following table shows whether this property is available in various Workgroup modes.</span></span>  
  
|<span data-ttu-id="51fc7-3375">Режиме рабочей группы</span><span class="sxs-lookup"><span data-stu-id="51fc7-3375">Workgroup mode</span></span>|<span data-ttu-id="51fc7-3376">Доступно</span><span class="sxs-lookup"><span data-stu-id="51fc7-3376">Available</span></span>|  
|--------------------|---------------|  
|<span data-ttu-id="51fc7-3377">Локальный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3377">Local computer</span></span>|<span data-ttu-id="51fc7-3378">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3378">Yes</span></span>|  
|<span data-ttu-id="51fc7-3379">Локальный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3379">Local computer and direct format name</span></span>|<span data-ttu-id="51fc7-3380">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3380">Yes</span></span>|  
|<span data-ttu-id="51fc7-3381">Удаленный компьютер</span><span class="sxs-lookup"><span data-stu-id="51fc7-3381">Remote computer</span></span>|<span data-ttu-id="51fc7-3382">Нет</span><span class="sxs-lookup"><span data-stu-id="51fc7-3382">No</span></span>|  
|<span data-ttu-id="51fc7-3383">Удаленный компьютер и прямое имя формата</span><span class="sxs-lookup"><span data-stu-id="51fc7-3383">Remote computer and direct format name</span></span>|<span data-ttu-id="51fc7-3384">Да</span><span class="sxs-lookup"><span data-stu-id="51fc7-3384">Yes</span></span>|  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Messaging.MessageQueueException"><span data-ttu-id="51fc7-3385">Очередь сообщений недоступна для записи.</span><span class="sxs-lookup"><span data-stu-id="51fc7-3385">The message queue is not available for writing.</span></span></exception>
        <altmember cref="P:System.Messaging.MessageQueue.CanWrite" />
        <altmember cref="P:System.Messaging.MessageQueue.ReadHandle" />
      </Docs>
    </Member>
  </Members>
</Type>